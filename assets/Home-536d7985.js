import{d as R,o as f,c as g,F as N,r as U,a as D,b as F,e as b,t as Z,u as x,_ as A,f as z,g as se,h as P,i as y,w as S,j as oe,k as $,l as K,v as ne,n as H,m as ae,p as J,q as pe,s as me,x as _e,y as E,z as re,A as ve,B as ee,E as ge,C as be,D as ye,G as Se}from"./index-f4d864bf.js";const xe="/editor-demo/assets/title-9b4c7ab1.jpg",we={rotate:"",opacity:1},le=[{id:0,component:"v-text",label:"文字",propValue:"文字",icon:"Edit",animations:[],events:{},style:{top:0,left:0,width:200,height:33,fontSize:14,fontWeight:500,lineHeight:"",letterSpacing:0,textAlign:"",color:""}},{id:0,component:"v-button",label:"按钮",propValue:"按钮",icon:"Crop",animations:[],events:{},style:{top:0,left:0,width:100,height:34,borderWidth:"",borderColor:"",borderRadius:"",fontSize:14,fontWeight:500,lineHeight:"",letterSpacing:0,textAlign:"",color:"",backgroundColor:""}},{id:0,component:"v-picture",label:"图片",icon:"PictureRounded",propValue:Ce(xe),animations:[],events:{},style:{top:0,left:0,width:300,height:200,borderRadius:""}}];le.forEach(t=>{t.style={...t.style,...we}});function Ce(t){return new URL(t,import.meta.url).href}const Me={class:"component-list"},Le=["data-index"],De=R({__name:"ComponentList",setup(t){const e=a=>{a.dataTransfer.setData("index",a.target.dataset.index)};return(a,l)=>(f(),g("div",Me,[(f(!0),g(N,null,U(x(le),(o,p)=>(f(),g("div",{key:p,class:"item",draggable:"true",onDragstart:l[0]||(l[0]=c=>e(c)),"data-index":p},[(f(),D(F(o.icon),{class:"icon"})),b("span",null,Z(o.label),1)],40,Le))),128))]))}});const Pe=A(De,[["__scopeId","data-v-c47933ae"]]),ke={class:"attr-list"},Ie=R({__name:"AttrList",setup(t){const e=$.editorStore,a=z({excludes:["Picture"],options:[{label:"左对齐",value:"left"},{label:"居中",value:"center"},{label:"右对齐",value:"right"}],map:{left:"x 坐标",top:"y 坐标",height:"高",width:"宽",color:"颜色",backgroundColor:"背景色",borderWidth:"边框宽度",borderColor:"边框颜色",borderRadius:"边框半径",fontSize:"字体大小",fontWeight:"字体粗细",lineHeight:"行高",letterSpacing:"字间距",textAlign:"对齐方式",opacity:"透明度"}}),l=se(()=>e.editorState.curComponent?Object.keys(e.editorState.curComponent.style):[]),o=se(()=>e.editorState.curComponent);return(p,c)=>{const r=P("el-color-picker"),u=P("el-option"),m=P("el-select"),v=P("el-input"),n=P("el-form-item"),d=P("el-form");return f(),g("div",ke,[y(d,null,{default:S(()=>[(f(!0),g(N,null,U(l.value.filter(i=>i!="rotate"),(i,s)=>(f(),D(n,{key:s,label:a.map[i]},{default:S(()=>[i=="borderColor"?(f(),D(r,{key:0,modelValue:o.value.style[i],"onUpdate:modelValue":h=>o.value.style[i]=h},null,8,["modelValue","onUpdate:modelValue"])):i=="color"?(f(),D(r,{key:1,modelValue:o.value.style[i],"onUpdate:modelValue":h=>o.value.style[i]=h},null,8,["modelValue","onUpdate:modelValue"])):i=="backgroundColor"?(f(),D(r,{key:2,modelValue:o.value.style[i],"onUpdate:modelValue":h=>o.value.style[i]=h},null,8,["modelValue","onUpdate:modelValue"])):i=="textAlign"?(f(),D(m,{key:3,modelValue:o.value.style[i],"onUpdate:modelValue":h=>o.value.style[i]=h},{default:S(()=>[(f(!0),g(N,null,U(a.options,h=>(f(),D(u,{key:h.value,label:h.label,value:h.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):(f(),D(v,{key:4,type:"number",modelValue:o.value.style[i],"onUpdate:modelValue":h=>o.value.style[i]=h},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["label"]))),128)),o.value&&o.value.propValue&&!a.excludes.includes(o.value.component)?(f(),D(n,{key:0,label:"内容"},{default:S(()=>[y(v,{type:"textarea",modelValue:o.value.propValue,"onUpdate:modelValue":c[0]||(c[0]=i=>o.value.propValue=i)},null,8,["modelValue"])]),_:1})):oe("",!0)]),_:1})])}}});const Ve=A(Ie,[["__scopeId","data-v-fb23c8da"]]),Oe=R({__name:"ContextMenu",setup(t){const e=$.editorStore;z({copyData:null});const a=()=>{e.copy()},l=()=>{e.paste(!0)},o=()=>{e.cut()},p=()=>{e.deleteComponent(),e.recordSnapshot()},c=()=>{e.upComponent(),e.recordSnapshot()},r=()=>{e.downComponent(),e.recordSnapshot()},u=()=>{e.topComponent(),e.recordSnapshot()},m=()=>{e.bottomComponent(),e.recordSnapshot()};return(v,n)=>K((f(),g("div",{class:"contextmenu",style:H({top:x(e).editorState.menuTop+"px",left:x(e).editorState.menuLeft+"px"})},[b("ul",null,[x(e).editorState.curComponent?(f(),g(N,{key:0},[b("li",{onClick:a},"复制"),b("li",{onClick:l},"粘贴"),b("li",{onClick:o},"剪切"),b("li",{onClick:p},"删除"),b("li",{onClick:u},"置顶"),b("li",{onClick:m},"置底"),b("li",{onClick:c},"上移"),b("li",{onClick:r},"下移")],64)):(f(),g("li",{key:1,onClick:l},"粘贴"))])],4)),[[ne,x(e).editorState.menuShow]])}});const Ne=A(Oe,[["__scopeId","data-v-f5a7b493"]]);function Re(t){return{all:t=t||new Map,on:function(e,a){var l=t.get(e);l?l.push(a):t.set(e,[a])},off:function(e,a){var l=t.get(e);l&&(a?l.splice(l.indexOf(a)>>>0,1):t.set(e,[]))},emit:function(e,a){var l=t.get(e);l&&l.slice().map(function(o){o(a)}),(l=t.get("*"))&&l.slice().map(function(o){o(e,a)})}}}const X=Re();function Y(t){return t*Math.PI/180}function V(t,e,a){return{x:(t.x-e.x)*Math.cos(Y(a))-(t.y-e.y)*Math.sin(Y(a))+e.x,y:(t.x-e.x)*Math.sin(Y(a))+(t.y-e.y)*Math.cos(Y(a))+e.y}}function G(t,e){return{x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}}function ce(t){return Math.abs(Math.sin(Y(t)))}function ue(t){return Math.abs(Math.cos(Y(t)))}const Ae={class:"mark-line"},Ue=R({__name:"MarkLine",setup(t){const e=$.editorStore,a=new Map,l=(n,d)=>{n&&a.set(d,n)},o=z({lines:["xt","xc","xb","yl","yc","yr"],diff:3,lineStatus:{xt:!1,xc:!1,xb:!1,yl:!1,yc:!1,yr:!1}});ae(()=>{X.on("move",n=>{r(n.isDownward,n.isRightward)}),X.on("unMove",()=>{c()})});const p=n=>{if(n={...n},n.rotate!=0){const d=n.width*ue(n.rotate)+n.height*ce(n.rotate),i=(n.width-d)/2;n.left+=i,n.right=n.left+d;const s=n.height*ue(n.rotate)+n.width*ce(n.rotate),h=(s-n.height)/2;n.top-=h,n.bottom=n.top+s,n.width=d,n.height=s}else n.bottom=n.top+n.height,n.right=n.left+n.width;return n},c=()=>{Object.keys(o.lineStatus).forEach(n=>{o.lineStatus[n]=!1})},r=(n,d)=>{const i=e.editorState.componentData,s=p(e.editorState.curComponent.style),h=s.width/2,_=s.height/2;c(),i.forEach(C=>{if(C==e.editorState.curComponent)return;const M=p(C.style),{top:w,left:L,bottom:k,right:I}=M,O=M.width/2,B=M.height/2,j={top:[{isNearly:v(s.top,w),lineNode:a.get("xt"),line:"xt",dragShift:w,lineShift:w},{isNearly:v(s.bottom,w),lineNode:a.get("xt"),line:"xt",dragShift:w-s.height,lineShift:w},{isNearly:v(s.top+_,w+B),lineNode:a.get("xc"),line:"xc",dragShift:w+B-_,lineShift:w+B},{isNearly:v(s.top,k),lineNode:a.get("xb"),line:"xb",dragShift:k,lineShift:k},{isNearly:v(s.bottom,k),lineNode:a.get("xb"),line:"xb",dragShift:k-s.height,lineShift:k}],left:[{isNearly:v(s.left,L),lineNode:a.get("yl"),line:"yl",dragShift:L,lineShift:L},{isNearly:v(s.right,L),lineNode:a.get("yl"),line:"yl",dragShift:L-s.width,lineShift:L},{isNearly:v(s.left+h,L+O),lineNode:a.get("yc"),line:"yc",dragShift:L+O-h,lineShift:L+O},{isNearly:v(s.left,I),lineNode:a.get("yr"),line:"yr",dragShift:I,lineShift:I},{isNearly:v(s.right,I),lineNode:a.get("yr"),line:"yr",dragShift:I-s.width,lineShift:I}]},W=[],{rotate:Q}=e.editorState.curComponent.style;Object.keys(j).forEach(q=>{j[q].forEach(T=>{T.isNearly&&(e.setShapePosStyle({key:q,value:Q!=0?u(q,T,s):T.dragShift}),T.lineNode.style[q]=`${T.lineShift}px`,W.push(T.line))})}),W.length&&m(W,n,d)})},u=(n,d,i)=>{const{width:s,height:h}=e.editorState.curComponent.style;return n=="top"?Math.round(d.dragShift-(h-i.height)/2):Math.round(d.dragShift-(s-i.width)/2)},m=(n,d,i)=>{i?n.includes("yr")?o.lineStatus.yr=!0:n.includes("yc")?o.lineStatus.yc=!0:n.includes("yl")&&(o.lineStatus.yl=!0):n.includes("yl")?o.lineStatus.yl=!0:n.includes("yc")?o.lineStatus.yc=!0:n.includes("yr")&&(o.lineStatus.yr=!0),d?n.includes("xb")?o.lineStatus.xb=!0:n.includes("xc")?o.lineStatus.xc=!0:n.includes("xt")&&(o.lineStatus.xt=!0):n.includes("xt")?o.lineStatus.xt=!0:n.includes("xc")?o.lineStatus.xc=!0:n.includes("xb")&&(o.lineStatus.xb=!0)},v=(n,d)=>Math.abs(n-d)<=o.diff;return(n,d)=>(f(),g("div",Ae,[(f(!0),g(N,null,U(o.lines,i=>K((f(),g("div",{key:i,class:J(["line",i.includes("x")?"xline":"yline"]),ref_for:!0,ref:s=>l(s,i)},null,2)),[[ne,o.lineStatus[i]||!1]])),128))]))}});const Ee=A(Ue,[["__scopeId","data-v-fc77015a"]]);async function he(t,e=[]){if(t){const a=l=>new Promise(o=>{t.classList.add("animate__animated","animate__"+l.value);const p=()=>{t.removeEventListener("animationend",p),t.removeEventListener("animationcancel",p),t.classList.remove("animate__animated","animate__"+l.value),o()};t.addEventListener("animationend",p),t.addEventListener("animationcancel",p)});for(let l=0,o=e.length;l<o;l++)await a(e[l])}else console.log("runAnimation el为空")}const $e={lt:Be,t:He,rt:Xe,r:ze,rb:We,b:Te,lb:Ke,l:Ye};function Be(t,e,a){const{symmetricPoint:l}=a,o=G(e,l),p=V(e,o,-t.rotate),c=V(l,o,-t.rotate),r=c.x-p.x,u=c.y-p.y;r>0&&u>0&&(t.width=Math.round(r),t.height=Math.round(u),t.left=Math.round(p.x),t.top=Math.round(p.y))}function He(t,e,a){const{symmetricPoint:l,curPoint:o}=a,p=V(e,o,-t.rotate),c=V({x:o.x,y:p.y},o,t.rotate),r=Math.sqrt((c.x-l.x)**2+(c.y-l.y)**2);if(r>0){const u={x:c.x-(c.x-l.x)/2,y:c.y+(l.y-c.y)/2};t.height=Math.round(r),t.top=Math.round(u.y-r/2),t.left=Math.round(u.x-t.width/2)}}function ze(t,e,a){const{symmetricPoint:l,curPoint:o}=a,p=V(e,o,-t.rotate),c=V({x:p.x,y:o.y},o,t.rotate),r=Math.sqrt((c.x-l.x)**2+(c.y-l.y)**2);if(r>0){const u={x:c.x-(c.x-l.x)/2,y:c.y+(l.y-c.y)/2};t.width=Math.round(r),t.top=Math.round(u.y-t.height/2),t.left=Math.round(u.x-r/2)}}function Te(t,e,a){const{symmetricPoint:l,curPoint:o}=a,p=V(e,o,-t.rotate),c=V({x:o.x,y:p.y},o,t.rotate),r=Math.sqrt((c.x-l.x)**2+(c.y-l.y)**2);if(r>0){const u={x:c.x-(c.x-l.x)/2,y:c.y+(l.y-c.y)/2};t.height=Math.round(r),t.top=Math.round(u.y-r/2),t.left=Math.round(u.x-t.width/2)}}function Ye(t,e,a){const{symmetricPoint:l,curPoint:o}=a,p=V(e,o,-t.rotate),c=V({x:p.x,y:o.y},o,t.rotate),r=Math.sqrt((c.x-l.x)**2+(c.y-l.y)**2);if(r>0){const u={x:c.x-(c.x-l.x)/2,y:c.y+(l.y-c.y)/2};t.width=Math.round(r),t.top=Math.round(u.y-t.height/2),t.left=Math.round(u.x-r/2)}}function Xe(t,e,a){const{symmetricPoint:l}=a,o=G(e,l),p=V(e,o,-t.rotate),c=V(l,o,-t.rotate),r=p.x-c.x,u=c.y-p.y;r>0&&u>0&&(t.width=Math.round(r),t.height=Math.round(u),t.left=Math.round(c.x),t.top=Math.round(p.y))}function We(t,e,a){const{symmetricPoint:l}=a,o=G(e,l),p=V(l,o,-t.rotate),c=V(e,o,-t.rotate),r=c.x-p.x,u=c.y-p.y;r>0&&u>0&&(t.width=Math.round(r),t.height=Math.round(u),t.left=Math.round(p.x),t.top=Math.round(p.y))}function Ke(t,e,a){const{symmetricPoint:l}=a,o=G(e,l),p=V(l,o,-t.rotate),c=V(e,o,-t.rotate),r=p.x-c.x,u=c.y-p.y;r>0&&u>0&&(t.width=Math.round(r),t.height=Math.round(u),t.left=Math.round(c.x),t.top=Math.round(p.y))}function je(t,e,a,l){$e[t](e,a,l)}const qe=["onMousedown"],Fe=R({__name:"ShapeComponent",props:{active:{type:Boolean,default:!1},element:{require:!0,type:Object},defaultStyle:{require:!0,type:Object},index:{require:!0,type:[Number,String]}},setup(t){const e=t,a=$.editorStore,l=pe(),o=z({pointList:["lt","t","rt","r","rb","b","lb","l"],initialAngle:{lt:0,t:45,rt:90,r:135,rb:180,b:225,lb:270,l:315},angleToCursor:[{start:338,end:23,cursor:"nw"},{start:23,end:68,cursor:"n"},{start:68,end:113,cursor:"ne"},{start:113,end:158,cursor:"e"},{start:158,end:203,cursor:"se"},{start:203,end:248,cursor:"s"},{start:248,end:293,cursor:"sw"},{start:293,end:338,cursor:"w"}],cursors:{}});ae(()=>{X.on("runAnimation",()=>{e.element===a.getCurComponent&&l.value!==void 0&&he(l.value,a.getCurComponent.animations)})});const p=n=>{var O;n.stopPropagation();const d={...e.defaultStyle},i=n.clientY,s=n.clientX,h=d.rotate,_=(O=l.value)==null?void 0:O.getBoundingClientRect(),C=(_==null?void 0:_.left)+(_==null?void 0:_.width)/2,M=(_==null?void 0:_.top)+(_==null?void 0:_.height)/2,w=Math.atan2(i-M,s-C)/(Math.PI/180);let L=!1;const k=B=>{L=!0;const j=B.clientX,W=B.clientY,Q=Math.atan2(W-M,j-C)/(Math.PI/180);d.rotate=h+Q-w,a.setShapeStyle(d)},I=()=>{L&&a.recordSnapshot(),document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",I),o.cursors=r()};document.addEventListener("mousemove",k),document.addEventListener("mouseup",I)},c=n=>{var k,I;const d=(k=e.defaultStyle)==null?void 0:k.height,i=(I=e.defaultStyle)==null?void 0:I.width,s=/t/.test(n),h=/b/.test(n),_=/l/.test(n),C=/r/.test(n);let M=0,w=0;return n.length===2?(M=_?0:i,w=s?0:d):((s||h)&&(M=i/2,w=s?0:d),(_||C)&&(M=_?0:i,w=Math.floor(d/2))),{marginLeft:"-4px",marginTop:"-4px",left:`${M}px`,top:`${w}px`,cursor:o.cursors[n]}},r=()=>{const n=(a.editorState.curComponent.style.rotate+360)%360,d={};let i=-1;return o.pointList.forEach(s=>{const h=(o.initialAngle[s]+n)%360,_=o.angleToCursor.length;let C=0;for(;C<_;){i=(i+1)%_;const M=o.angleToCursor[i];if(h<23||h>=338){d[s]="nw-resize";break}if(M.start<=h&&h<M.end){d[s]=M.cursor+"-resize";break}}}),d},u=n=>{var L;((L=e.element)==null?void 0:L.component)!="v-text"&&n.preventDefault(),n.stopPropagation(),a.setCurComponent({component:e.element,index:e.index}),o.cursors=r();const d={...e.defaultStyle},i=n.clientY,s=n.clientX,h=Number(d.top),_=Number(d.left);let C=!1;const M=k=>{C=!0;const I=k.clientX,O=k.clientY;d.top=O-i+h,d.left=I-s+_,a.setShapeStyle(d),_e(()=>{X.emit("move",{isDownward:O-i>0,isRightward:I-s>0})})},w=()=>{C&&a.recordSnapshot(),X.emit("unMove"),document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",w)};document.addEventListener("mousemove",M),document.addEventListener("mouseup",w)},m=n=>{n.stopPropagation(),n.preventDefault(),a.hideContextMenu()},v=(n,d)=>{var I;const i=window.event;i==null||i.stopPropagation(),i==null||i.preventDefault();const s={...e.defaultStyle},h={x:s.left+s.width/2,y:s.top+s.height/2},_=(I=document==null?void 0:document.querySelector("#editor"))==null?void 0:I.getBoundingClientRect(),C={x:d.clientX-(_==null?void 0:_.left),y:d.clientY-(_==null?void 0:_.top)},M={x:h.x-(C.x-h.x),y:h.y-(C.y-h.y)};let w=!1;const L=O=>{w=!0;const B={x:O.clientX-(_==null?void 0:_.left),y:O.clientY-(_==null?void 0:_.top)};je(n,s,B,{center:h,curPoint:C,symmetricPoint:M}),a.setShapeStyle(s)},k=()=>{document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",k),w&&a.recordSnapshot()};document.addEventListener("mousemove",L),document.addEventListener("mouseup",k)};return(n,d)=>{const i=P("RefreshRight"),s=P("el-icon");return f(),g("div",{ref_key:"thisRef",ref:l,class:J(["shape",{active:t.active}]),onClick:m,onMousedown:u},[K(y(s,{class:"el-icon-refresh-right",onMousedown:p},{default:S(()=>[y(i)]),_:1},512),[[ne,t.active]]),(f(!0),g(N,null,U(t.active?o.pointList:[],(h,_)=>(f(),g("div",{class:"shape-point",onMousedown:C=>v(h,C),key:_,style:H(c(h))},null,44,qe))),128)),me(n.$slots,"default",{},void 0,!0)],34)}}});const Je=A(Fe,[["__scopeId","data-v-51856631"]]);function fe(t,e=[]){const a=["fontSize","width","height","top","left"],l={};return Object.keys(t).forEach(o=>{e.includes(o)||(o!="rotate"?(l[o]=t[o],a.includes(o)&&(l[o]+="px")):l.transform=o+"("+t[o]+"deg)")}),l}const Ge=R({__name:"EditorComponent",props:{isEdit:{type:Boolean,default:!0}},setup(t){const e=$.editorStore,a=r=>{r.stopPropagation(),r.preventDefault();let u=r.target,m=r.offsetY,v=r.offsetX;for(;!u.className.includes("editor");)v+=u.offsetLeft,m+=u.offsetTop,u=u.parentNode;e.showContextMenu({top:m,left:v})},l=r=>{const u={...r};return u.width&&(u.width+="px"),u.height&&(u.height+="px"),u.top&&(u.top+="px"),u.left&&(u.left+="px"),u.rotate&&(u.transform="rotate("+u.rotate+"deg)"),u},o=r=>fe(r,["top","left","width","height","rotate"]),p=(r,u)=>{r.propValue=u,e.setShapeStyle({height:c(r,u)})},c=(r,u)=>{let{lineHeight:m,fontSize:v,height:n}=r.style;m===""&&(m=1.5);const d=u.split(`
`).length*m*v;return n>d?n:d};return(r,u)=>(f(),g("div",{class:J(["editor",{edit:t.isEdit}]),id:"editor",style:H({width:x(e).editorState.canvasStyleData.width+"px",height:x(e).editorState.canvasStyleData.height+"px"}),onContextmenu:a},[(f(!0),g(N,null,U(x(e).editorState.componentData,(m,v)=>(f(),D(Je,{defaultStyle:m.style,style:H(l(m.style)),key:m.id,active:m===x(e).editorState.curComponent,element:m,index:v},{default:S(()=>[m.component!="v-text"?(f(),D(F(m.component),{key:0,class:"component",style:H(o(m.style)),propValue:m.propValue},null,8,["style","propValue"])):(f(),D(F(m.component),{key:1,class:"component",style:H(o(m.style)),propValue:m.propValue,onInput:p,element:m},null,40,["style","propValue","element"]))]),_:2},1032,["defaultStyle","style","active","element","index"]))),128)),y(Ne),y(Ee)],38))}});const Qe=A(Ge,[["__scopeId","data-v-e5128159"]]),te={redirect(t){t&&(window.location.href=t)},alert(t){t&&alert(t)}};te.redirect,te.alert;const Ze=R({__name:"ComponentWrapper",props:{config:{}},setup(t){const e=t,a=pe();ae(()=>{a.value!==void 0&&he(a.value,e.config.animations)});const l=()=>{const o=e.config.events;Object.keys(o).forEach(p=>{te[p](o[p])})};return(o,p)=>(f(),g("div",{onClick:l,ref_key:"wrapperDom",ref:a},[(f(),D(F(o.config.component),{class:"component",style:H(x(fe)(o.config.style)),propValue:o.config.propValue},null,8,["style","propValue"]))],512))}});const et=A(Ze,[["__scopeId","data-v-f6fda919"]]),tt={key:0,class:"bg"},ot={class:"canvas-container"},nt=R({__name:"Preview",props:{show:{type:Boolean}},emits:["update:show"],setup(t,{emit:e}){const a=$.editorStore.editorState,l=()=>{e("update:show",!1)};return(o,p)=>{const c=P("el-button");return o.show?(f(),g("div",tt,[y(c,{onClick:l,class:"close"},{default:S(()=>[E("关闭")]),_:1}),b("div",ot,[b("div",{class:"canvas",style:H({width:x(a).canvasStyleData.width+"px",height:x(a).canvasStyleData.height+"px"})},[(f(!0),g(N,null,U(x(a).componentData,(r,u)=>(f(),D(et,{key:u,config:r},null,8,["config"]))),128))],4)])])):oe("",!0)}}});const at=A(nt,[["__scopeId","data-v-405e2576"]]),ie=t=>(be("data-v-cb7c59cc"),t=t(),ye(),t),lt={class:"toolbar"},it=ie(()=>b("label",{for:"input",class:"insert"},"插入图片",-1)),st={class:"canvas-config"},rt=ie(()=>b("span",null,"画布大小",-1)),ct=ie(()=>b("span",null,"*",-1)),ut=R({__name:"Toolbar",setup(t){const e=$.editorStore,a=z({isShowPreview:!1}),l=()=>{e.undo()},o=()=>{e.redo()},p=v=>{const n=v.target.files[0];if(!n.type.includes("image")){ve("只能插入图片");return}const d=new FileReader;d.onload=i=>{const s=i.target.result,h=new Image;h.onload=()=>{e.addComponent({component:{id:ee(),component:"v-picture",label:"图片",icon:"",propValue:s,animations:[],events:[],style:{top:0,left:0,width:h.width,height:h.height,rotate:""}},index:void 0})},h.src=s},d.readAsDataURL(n)},c=()=>{a.isShowPreview=!0,e.setEditMode("read")},r=()=>{e.setEditMode("edit")},u=()=>{localStorage.setItem("canvasData",JSON.stringify(e.editorState.componentData)),localStorage.setItem("canvasStyle",JSON.stringify(e.editorState.canvasStyleData)),ge.success("保存成功")},m=()=>{e.setComponentData([])};return(v,n)=>{const d=P("el-button");return f(),g("div",null,[b("div",lt,[y(d,{onClick:l},{default:S(()=>[E("撤消")]),_:1}),y(d,{onClick:o},{default:S(()=>[E("重做")]),_:1}),it,b("input",{type:"file",onChange:p,id:"input",hidden:""},null,32),y(d,{onClick:c,style:{"margin-left":"10px"}},{default:S(()=>[E("预览")]),_:1}),y(d,{onClick:u},{default:S(()=>[E("保存")]),_:1}),y(d,{onClick:m},{default:S(()=>[E("清空画布")]),_:1}),b("div",st,[rt,K(b("input",{"onUpdate:modelValue":n[0]||(n[0]=i=>x(e).editorState.canvasStyleData.width=i)},null,512),[[re,x(e).editorState.canvasStyleData.width]]),ct,K(b("input",{"onUpdate:modelValue":n[1]||(n[1]=i=>x(e).editorState.canvasStyleData.height=i)},null,512),[[re,x(e).editorState.canvasStyleData.height]])])]),y(at,{show:a.isShowPreview,"onUpdate:show":n[2]||(n[2]=i=>a.isShowPreview=i),onChange:r},null,8,["show"])])}}});const dt=A(ut,[["__scopeId","data-v-cb7c59cc"]]),de=[{label:"进入",children:[{label:"渐显",value:"fadeIn"},{label:"向右进入",value:"fadeInLeft"},{label:"向左进入",value:"fadeInRight"},{label:"向上进入",value:"fadeInUp"},{label:"向下进入",value:"fadeInDown"},{label:"向右长距进入",value:"fadeInLeftBig"},{label:"向左长距进入",value:"fadeInRightBig"},{label:"向上长距进入",value:"fadeInUpBig"},{label:"向下长距进入",value:"fadeInDownBig"},{label:"旋转进入",value:"rotateIn"},{label:"左顺时针旋转",value:"rotateInDownLeft"},{label:"右逆时针旋转",value:"rotateInDownRight"},{label:"左逆时针旋转",value:"rotateInUpLeft"},{label:"右逆时针旋转",value:"rotateInUpRight"},{label:"弹入",value:"bounceIn"},{label:"向右弹入",value:"bounceInLeft"},{label:"向左弹入",value:"bounceInRight"},{label:"向上弹入",value:"bounceInUp"},{label:"向下弹入",value:"bounceInDown"},{label:"光速从右进入",value:"lightSpeedInRight"},{label:"光速从左进入",value:"lightSpeedInLeft"},{label:"光速从右退出",value:"lightSpeedOutRight"},{label:"光速从左退出",value:"lightSpeedOutLeft"},{label:"Y轴旋转",value:"flip"},{label:"中心X轴旋转",value:"flipInX"},{label:"中心Y轴旋转",value:"flipInY"},{label:"左长半径旋转",value:"rollIn"},{label:"由小变大进入",value:"zoomIn"},{label:"左变大进入",value:"zoomInLeft"},{label:"右变大进入",value:"zoomInRight"},{label:"向上变大进入",value:"zoomInUp"},{label:"向下变大进入",value:"zoomInDown"},{label:"向右滑动展开",value:"slideInLeft"},{label:"向左滑动展开",value:"slideInRight"},{label:"向上滑动展开",value:"slideInUp"},{label:"向下滑动展开",value:"slideInDown"}]},{label:"强调",children:[{label:"弹跳",value:"bounce"},{label:"闪烁",value:"flash"},{label:"放大缩小",value:"pulse"},{label:"放大缩小弹簧",value:"rubberBand"},{label:"左右晃动",value:"headShake"},{label:"左右扇形摇摆",value:"swing"},{label:"放大晃动缩小",value:"tada"},{label:"扇形摇摆",value:"wobble"},{label:"左右上下晃动",value:"jello"},{label:"Y轴旋转",value:"flip"}]},{label:"退出",children:[{label:"渐隐",value:"fadeOut"},{label:"向左退出",value:"fadeOutLeft"},{label:"向右退出",value:"fadeOutRight"},{label:"向上退出",value:"fadeOutUp"},{label:"向下退出",value:"fadeOutDown"},{label:"向左长距退出",value:"fadeOutLeftBig"},{label:"向右长距退出",value:"fadeOutRightBig"},{label:"向上长距退出",value:"fadeOutUpBig"},{label:"向下长距退出",value:"fadeOutDownBig"},{label:"旋转退出",value:"rotateOut"},{label:"左顺时针旋转",value:"rotateOutDownLeft"},{label:"右逆时针旋转",value:"rotateOutDownRight"},{label:"左逆时针旋转",value:"rotateOutUpLeft"},{label:"右逆时针旋转",value:"rotateOutUpRight"},{label:"弹出",value:"bounceOut"},{label:"向左弹出",value:"bounceOutLeft"},{label:"向右弹出",value:"bounceOutRight"},{label:"向上弹出",value:"bounceOutUp"},{label:"向下弹出",value:"bounceOutDown"},{label:"中心X轴旋转",value:"flipOutX"},{label:"中心Y轴旋转",value:"flipOutY"},{label:"左长半径旋转",value:"rollOut"},{label:"由小变大退出",value:"zoomOut"},{label:"左变大退出",value:"zoomOutLeft"},{label:"右变大退出",value:"zoomOutRight"},{label:"向上变大退出",value:"zoomOutUp"},{label:"向下变大退出",value:"zoomOutDown"},{label:"向左滑动收起",value:"slideOutLeft"},{label:"向右滑动收起",value:"slideOutRight"},{label:"向上滑动收起",value:"slideOutUp"},{label:"向下滑动收起",value:"slideOutDown"}]}],pt={class:"animation-list"},ht={key:0,class:"div-animation"},ft={class:"el-scrollbar-view"},mt=["onMouseover","onClick"],_t=R({__name:"AnimationList",setup(t){const e=$.editorStore,a=z({isShowAnimation:!1,animationClassData:de,animationActiveName:"进入",showAnimatePanel:!1,hoverPreviewAnimate:""}),l=c=>{e.addAnimation(c),a.isShowAnimation=!1},o=()=>{X.emit("runAnimation")},p=c=>{e.removeAnimation(c)};return(c,r)=>{const u=P("el-button"),m=P("el-tag"),v=P("el-scrollbar"),n=P("el-tab-pane"),d=P("el-tabs"),i=P("Modal");return f(),g("div",pt,[x(e).editorState.curComponent?(f(),g("div",ht,[y(u,{onClick:r[0]||(r[0]=s=>{a.isShowAnimation=!0})},{default:S(()=>[E("添加动画")]),_:1}),y(u,{onClick:o},{default:S(()=>[E("预览动画")]),_:1}),b("div",null,[(f(!0),g(N,null,U(x(e).editorState.curComponent.animations,(s,h)=>(f(),D(m,{key:h,closable:"",onClose:_=>p(h)},{default:S(()=>[E(Z(s.label),1)]),_:2},1032,["onClose"]))),128))])])):oe("",!0),y(i,{show:a.isShowAnimation,"onUpdate:show":r[2]||(r[2]=s=>a.isShowAnimation=s)},{default:S(()=>[y(d,{type:"card",modelValue:a.animationActiveName,"onUpdate:modelValue":r[1]||(r[1]=s=>a.animationActiveName=s)},{default:S(()=>[(f(!0),g(N,null,U(x(de),s=>(f(),D(n,{key:s.label,label:s.label,name:s.label},{default:S(()=>[y(v,{class:"animate-container"},{default:S(()=>[b("div",ft,[(f(!0),g(N,null,U(s.children,(h,_)=>(f(),g("div",{class:"animate",key:_,onMouseover:C=>a.hoverPreviewAnimate=h.value,onClick:C=>l(h)},[b("div",{class:J([a.hoverPreviewAnimate===h.value&&"animate__animated animate__"+h.value])},Z(h.label),3)],40,mt))),128))])]),_:2},1024)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["show"])])}}});const vt=A(_t,[["__scopeId","data-v-c2f72d3f"]]),gt={class:"home"},bt={class:"left"},yt={class:"center"},St={class:"right"},xt={key:1,class:"placeholder"},wt={key:1,class:"placeholder"},Ct={key:1,class:"placeholder"},Mt=R({__name:"Home",setup(t){const e=$.editorStore,a=z({activeName:"attr",reSelectAnimateIndex:void 0}),l=()=>{localStorage.getItem("canvasData")&&e.setComponentData(p(JSON.parse(localStorage.getItem("canvasData")))),localStorage.getItem("canvasStyle")&&e.setCanvasStyle(JSON.parse(localStorage.getItem("canvasStyle")))},o=()=>{let i=!1;window.onkeydown=s=>{s.keyCode==17?i=!0:i&&s.keyCode==67?e.copy():i&&s.keyCode==86?e.paste(!1):i&&s.keyCode==88&&e.cut()},window.onkeyup=s=>{s.keyCode==17&&(i=!1)}},p=m=>(m.forEach(v=>{v.id=ee()}),m),c=m=>{m.preventDefault(),m.stopPropagation();const v=Se.cloneDeep(le[m.dataTransfer.getData("index")]);v.style.top=m.offsetY,v.style.left=m.offsetX,v.id=ee(),e.addComponent({component:v,index:void 0}),e.recordSnapshot()},r=m=>{m.preventDefault(),m.dataTransfer.dropEffect="copy"},u=()=>{e.setCurComponent({component:null,index:null}),e.hideContextMenu()};return l(),o(),(m,v)=>{const n=P("el-tab-pane"),d=P("EventList"),i=P("el-tabs");return f(),g("div",gt,[y(dt),b("main",null,[b("section",bt,[y(Pe)]),b("section",yt,[b("div",{class:"content",onDrop:c,onDragover:r,onClick:u},[y(Qe)],32)]),b("section",St,[y(i,{modelValue:a.activeName,"onUpdate:modelValue":v[0]||(v[0]=s=>a.activeName=s),type:"card"},{default:S(()=>[y(n,{label:"属性",name:"attr"},{default:S(()=>[x(e).editorState.curComponent?(f(),D(Ve,{key:0})):(f(),g("p",xt,"请选择组件"))]),_:1}),y(n,{label:"动画",name:"animation"},{default:S(()=>[x(e).editorState.curComponent?(f(),D(vt,{key:0})):(f(),g("p",wt,"请选择组件"))]),_:1}),y(n,{label:"事件",name:"events"},{default:S(()=>[x(e).editorState.curComponent?(f(),D(d,{key:0})):(f(),g("p",Ct,"请选择组件"))]),_:1})]),_:1},8,["modelValue"])])])])}}});const Dt=A(Mt,[["__scopeId","data-v-af42b5d0"]]);export{Dt as default};
