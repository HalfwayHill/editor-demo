import{d as O,o as d,c as g,F as $,r as U,a as L,b as q,e as S,t as F,u as C,l as re,_ as N,f as Y,g as se,h as M,i as x,w,j as H,k as R,m as T,v as J,n as B,p as G,q as z,s as ne,x as Q,y as Z,z as P,A as ce,B as ue,C as me,D as de,E as A,G as oe,H as _e,I as fe,J as ae,K as ve,L as ye,M as ge,N as be,O as Se}from"./index-d46ace36.js";const xe={class:"component-list"},we=["data-index"],Ce=O({__name:"ComponentList",setup(a){const e=n=>{n.dataTransfer.setData("index",n.target.dataset.index)};return(n,r)=>(d(),g("div",xe,[(d(!0),g($,null,U(C(re),(o,u)=>(d(),g("div",{key:u,class:"item",draggable:"true",onDragstart:r[0]||(r[0]=i=>e(i)),"data-index":u},[(d(),L(q(o.icon),{class:"icon"})),S("span",null,F(o.label),1)],40,we))),128))]))}});const ke=N(Ce,[["__scopeId","data-v-c47933ae"]]),Le={class:"attr-list"},Me=O({__name:"AttrList",setup(a){const e=R.editorStore,n=Y({excludes:["VPicture","VGroup"],options:[{label:"左对齐",value:"left"},{label:"居中",value:"center"},{label:"右对齐",value:"right"}],map:{left:"x 坐标",top:"y 坐标",height:"高",width:"宽",color:"颜色",backgroundColor:"背景色",borderWidth:"边框宽度",borderColor:"边框颜色",borderRadius:"边框半径",fontSize:"字体大小",fontWeight:"字体粗细",lineHeight:"行高",letterSpacing:"字间距",textAlign:"对齐方式",opacity:"透明度"}}),r=se(()=>e.editorState.curComponent?Object.keys(e.editorState.curComponent.style):[]),o=se(()=>e.editorState.curComponent);return(u,i)=>{const p=M("el-color-picker"),f=M("el-option"),y=M("el-select"),_=M("el-input"),m=M("el-form-item"),s=M("el-form");return d(),g("div",Le,[x(s,null,{default:w(()=>[(d(!0),g($,null,U(r.value.filter(t=>t!="rotate"),(t,l)=>(d(),L(m,{key:l,label:n.map[t]},{default:w(()=>[t=="borderColor"?(d(),L(p,{key:0,modelValue:o.value.style[t],"onUpdate:modelValue":c=>o.value.style[t]=c},null,8,["modelValue","onUpdate:modelValue"])):t=="color"?(d(),L(p,{key:1,modelValue:o.value.style[t],"onUpdate:modelValue":c=>o.value.style[t]=c},null,8,["modelValue","onUpdate:modelValue"])):t=="backgroundColor"?(d(),L(p,{key:2,modelValue:o.value.style[t],"onUpdate:modelValue":c=>o.value.style[t]=c},null,8,["modelValue","onUpdate:modelValue"])):t=="textAlign"?(d(),L(y,{key:3,modelValue:o.value.style[t],"onUpdate:modelValue":c=>o.value.style[t]=c},{default:w(()=>[(d(!0),g($,null,U(n.options,c=>(d(),L(f,{key:c.value,label:c.label,value:c.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):(d(),L(_,{key:4,type:"number",modelValue:o.value.style[t],"onUpdate:modelValue":c=>o.value.style[t]=c},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["label"]))),128)),o.value&&!n.excludes.includes(o.value.component)?(d(),L(m,{key:0,label:"内容"},{default:w(()=>[x(_,{type:"textarea",modelValue:o.value.propValue,"onUpdate:modelValue":i[0]||(i[0]=t=>o.value.propValue=t)},null,8,["modelValue"])]),_:1})):H("",!0)]),_:1})])}}});const De=N(Me,[["__scopeId","data-v-8c0b3edf"]]),Ie=O({__name:"ContextMenu",setup(a){const e=R.editorStore;Y({copyData:null});const n=()=>{e.copy()},r=()=>{e.paste(!0)},o=()=>{e.cut()},u=()=>{e.deleteComponent(),e.recordSnapshot()},i=()=>{e.upComponent(),e.recordSnapshot()},p=()=>{e.downComponent(),e.recordSnapshot()},f=()=>{e.topComponent(),e.recordSnapshot()},y=()=>{e.bottomComponent(),e.recordSnapshot()};return(_,m)=>T((d(),g("div",{class:"contextmenu",style:B({top:C(e).editorState.menuTop+"px",left:C(e).editorState.menuLeft+"px"})},[S("ul",null,[C(e).editorState.curComponent?(d(),g($,{key:0},[S("li",{onClick:n},"复制"),S("li",{onClick:r},"粘贴"),S("li",{onClick:o},"剪切"),S("li",{onClick:u},"删除"),S("li",{onClick:f},"置顶"),S("li",{onClick:y},"置底"),S("li",{onClick:i},"上移"),S("li",{onClick:p},"下移")],64)):(d(),g("li",{key:1,onClick:r},"粘贴"))])],4)),[[J,C(e).editorState.menuShow]])}});const Pe=N(Ie,[["__scopeId","data-v-f5a7b493"]]),Ve={class:"mark-line"},Ae=O({__name:"MarkLine",setup(a){const e=R.editorStore,n=new Map,r=(_,m)=>{_&&n.set(m,_)},o=Y({lines:["xt","xc","xb","yl","yc","yr"],diff:3,lineStatus:{xt:!1,xc:!1,xb:!1,yl:!1,yc:!1,yr:!1}});G(()=>{z.on("move",_=>{i(_.isDownward,_.isRightward)}),z.on("unMove",()=>{u()})});const u=()=>{Object.keys(o.lineStatus).forEach(_=>{o.lineStatus[_]=!1})},i=(_,m)=>{const s=e.editorState.componentData,t=ne(e.editorState.curComponent.style),l=t.width/2,c=t.height/2;u(),s.forEach(h=>{if(h==e.editorState.curComponent)return;const v=ne(h.style),{top:b,left:k,bottom:I,right:D}=v,V=v.width/2,E=v.height/2,X={top:[{isNearly:y(t.top,b),lineNode:n.get("xt"),line:"xt",dragShift:b,lineShift:b},{isNearly:y(t.bottom,b),lineNode:n.get("xt"),line:"xt",dragShift:b-t.height,lineShift:b},{isNearly:y(t.top+c,b+E),lineNode:n.get("xc"),line:"xc",dragShift:b+E-c,lineShift:b+E},{isNearly:y(t.top,I),lineNode:n.get("xb"),line:"xb",dragShift:I,lineShift:I},{isNearly:y(t.bottom,I),lineNode:n.get("xb"),line:"xb",dragShift:I-t.height,lineShift:I}],left:[{isNearly:y(t.left,k),lineNode:n.get("yl"),line:"yl",dragShift:k,lineShift:k},{isNearly:y(t.right,k),lineNode:n.get("yl"),line:"yl",dragShift:k-t.width,lineShift:k},{isNearly:y(t.left+l,k+V),lineNode:n.get("yc"),line:"yc",dragShift:k+V-l,lineShift:k+V},{isNearly:y(t.left,D),lineNode:n.get("yr"),line:"yr",dragShift:D,lineShift:D},{isNearly:y(t.right,D),lineNode:n.get("yr"),line:"yr",dragShift:D-t.width,lineShift:D}]},j=[],{rotate:te}=e.editorState.curComponent.style;Object.keys(X).forEach(W=>{X[W].forEach(K=>{K.isNearly&&(e.setShapePosStyle({key:W,value:te!=0?p(W,K,t):K.dragShift}),K.lineNode.style[W]=`${K.lineShift}px`,j.push(K.line))})}),j.length&&f(j,_,m)})},p=(_,m,s)=>{const{width:t,height:l}=e.editorState.curComponent.style;return _=="top"?Math.round(m.dragShift-(l-s.height)/2):Math.round(m.dragShift-(t-s.width)/2)},f=(_,m,s)=>{s?_.includes("yr")?o.lineStatus.yr=!0:_.includes("yc")?o.lineStatus.yc=!0:_.includes("yl")&&(o.lineStatus.yl=!0):_.includes("yl")?o.lineStatus.yl=!0:_.includes("yc")?o.lineStatus.yc=!0:_.includes("yr")&&(o.lineStatus.yr=!0),m?_.includes("xb")?o.lineStatus.xb=!0:_.includes("xc")?o.lineStatus.xc=!0:_.includes("xt")&&(o.lineStatus.xt=!0):_.includes("xt")?o.lineStatus.xt=!0:_.includes("xc")?o.lineStatus.xc=!0:_.includes("xb")&&(o.lineStatus.xb=!0)},y=(_,m)=>Math.abs(_-m)<=o.diff;return(_,m)=>(d(),g("div",Ve,[(d(!0),g($,null,U(o.lines,s=>T((d(),g("div",{key:s,class:Q(["line",s.includes("x")?"xline":"yline"]),ref_for:!0,ref:t=>r(t,s)},null,2)),[[J,o.lineStatus[s]||!1]])),128))]))}});const Oe=N(Ae,[["__scopeId","data-v-763a98e8"]]);async function pe(a,e=[]){if(a){const n=r=>new Promise(o=>{a.classList.add("animate__animated","animate__"+r.value);const u=()=>{a.removeEventListener("animationend",u),a.removeEventListener("animationcancel",u),a.classList.remove("animate__animated","animate__"+r.value),o()};a.addEventListener("animationend",u),a.addEventListener("animationcancel",u)});for(let r=0,o=e.length;r<o;r++)await n(e[r])}else console.log("runAnimation el为空")}const Ne={lt:$e,t:Ee,rt:Ye,r:Ue,rb:Xe,b:Re,lb:He,l:Be};function $e(a,e,n){const{symmetricPoint:r}=n,o=Z(e,r),u=P(e,o,-a.rotate),i=P(r,o,-a.rotate),p=i.x-u.x,f=i.y-u.y;p>0&&f>0&&(a.width=Math.round(p),a.height=Math.round(f),a.left=Math.round(u.x),a.top=Math.round(u.y))}function Ee(a,e,n){const{symmetricPoint:r,curPoint:o}=n,u=P(e,o,-a.rotate),i=P({x:o.x,y:u.y},o,a.rotate),p=Math.sqrt((i.x-r.x)**2+(i.y-r.y)**2);if(p>0){const f={x:i.x-(i.x-r.x)/2,y:i.y+(r.y-i.y)/2};a.height=Math.round(p),a.top=Math.round(f.y-p/2),a.left=Math.round(f.x-a.width/2)}}function Ue(a,e,n){const{symmetricPoint:r,curPoint:o}=n,u=P(e,o,-a.rotate),i=P({x:u.x,y:o.y},o,a.rotate),p=Math.sqrt((i.x-r.x)**2+(i.y-r.y)**2);if(p>0){const f={x:i.x-(i.x-r.x)/2,y:i.y+(r.y-i.y)/2};a.width=Math.round(p),a.top=Math.round(f.y-a.height/2),a.left=Math.round(f.x-p/2)}}function Re(a,e,n){const{symmetricPoint:r,curPoint:o}=n,u=P(e,o,-a.rotate),i=P({x:o.x,y:u.y},o,a.rotate),p=Math.sqrt((i.x-r.x)**2+(i.y-r.y)**2);if(p>0){const f={x:i.x-(i.x-r.x)/2,y:i.y+(r.y-i.y)/2};a.height=Math.round(p),a.top=Math.round(f.y-p/2),a.left=Math.round(f.x-a.width/2)}}function Be(a,e,n){const{symmetricPoint:r,curPoint:o}=n,u=P(e,o,-a.rotate),i=P({x:u.x,y:o.y},o,a.rotate),p=Math.sqrt((i.x-r.x)**2+(i.y-r.y)**2);if(p>0){const f={x:i.x-(i.x-r.x)/2,y:i.y+(r.y-i.y)/2};a.width=Math.round(p),a.top=Math.round(f.y-a.height/2),a.left=Math.round(f.x-p/2)}}function Ye(a,e,n){const{symmetricPoint:r}=n,o=Z(e,r),u=P(e,o,-a.rotate),i=P(r,o,-a.rotate),p=u.x-i.x,f=i.y-u.y;p>0&&f>0&&(a.width=Math.round(p),a.height=Math.round(f),a.left=Math.round(i.x),a.top=Math.round(u.y))}function Xe(a,e,n){const{symmetricPoint:r}=n,o=Z(e,r),u=P(r,o,-a.rotate),i=P(e,o,-a.rotate),p=i.x-u.x,f=i.y-u.y;p>0&&f>0&&(a.width=Math.round(p),a.height=Math.round(f),a.left=Math.round(u.x),a.top=Math.round(u.y))}function He(a,e,n){const{symmetricPoint:r}=n,o=Z(e,r),u=P(r,o,-a.rotate),i=P(e,o,-a.rotate),p=u.x-i.x,f=i.y-u.y;p>0&&f>0&&(a.width=Math.round(p),a.height=Math.round(f),a.left=Math.round(i.x),a.top=Math.round(u.y))}function Te(a,e,n,r){Ne[a](e,n,r)}const ze=["onMousedown"],We=O({__name:"ShapeComponent",props:{active:{type:Boolean,default:!1},element:{require:!0,type:Object},defaultStyle:{require:!0,type:Object},index:{require:!0,type:[Number,String]}},setup(a){const e=a,n=R.editorStore,r=ce(),o=Y({pointList:["lt","t","rt","r","rb","b","lb","l"],initialAngle:{lt:0,t:45,rt:90,r:135,rb:180,b:225,lb:270,l:315},angleToCursor:[{start:338,end:23,cursor:"nw"},{start:23,end:68,cursor:"n"},{start:68,end:113,cursor:"ne"},{start:113,end:158,cursor:"e"},{start:158,end:203,cursor:"se"},{start:203,end:248,cursor:"s"},{start:248,end:293,cursor:"sw"},{start:293,end:338,cursor:"w"}],cursors:{}});G(()=>{z.on("runAnimation",()=>{e.element===n.getCurComponent&&r.value!==void 0&&pe(r.value,n.getCurComponent.animations)})});const u=m=>{var E;m.preventDefault(),m.stopPropagation();const s={...e.defaultStyle},t=m.clientY,l=m.clientX,c=s.rotate,h=(E=r.value)==null?void 0:E.getBoundingClientRect(),v=(h==null?void 0:h.left)+(h==null?void 0:h.width)/2,b=(h==null?void 0:h.top)+(h==null?void 0:h.height)/2,k=Math.atan2(t-b,l-v)/(Math.PI/180);let I=!1;const D=X=>{I=!0;const j=X.clientX,te=X.clientY,W=Math.atan2(te-b,j-v)/(Math.PI/180);s.rotate=c+W-k,n.setShapeStyle(s)},V=()=>{I&&n.recordSnapshot(),document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",V),o.cursors=p()};document.addEventListener("mousemove",D),document.addEventListener("mouseup",V)},i=m=>{var D,V;const s=(D=e.defaultStyle)==null?void 0:D.height,t=(V=e.defaultStyle)==null?void 0:V.width,l=/t/.test(m),c=/b/.test(m),h=/l/.test(m),v=/r/.test(m);let b=0,k=0;return m.length===2?(b=h?0:t,k=l?0:s):((l||c)&&(b=t/2,k=l?0:s),(h||v)&&(b=h?0:t,k=Math.floor(s/2))),{marginLeft:"-4px",marginTop:"-4px",left:`${b}px`,top:`${k}px`,cursor:o.cursors[m]}},p=()=>{const m=(n.editorState.curComponent.style.rotate+360)%360,s={};let t=-1;return o.pointList.forEach(l=>{const c=(o.initialAngle[l]+m)%360,h=o.angleToCursor.length;for(;;){t=(t+1)%h;const v=o.angleToCursor[t];if(c<23||c>=338){s[l]="nw-resize";return}if(v.start<=c&&c<v.end){s[l]=v.cursor+"-resize";return}}}),s},f=m=>{var I;((I=e.element)==null?void 0:I.component)!="v-text"&&m.preventDefault(),m.stopPropagation(),n.setCurComponent({component:e.element,index:e.index}),o.cursors=p();const s={...e.defaultStyle},t=m.clientY,l=m.clientX,c=Number(s.top),h=Number(s.left);let v=!1;const b=D=>{v=!0;const V=D.clientX,E=D.clientY;s.top=E-t+c,s.left=V-l+h,n.setShapeStyle(s),me(()=>{z.emit("move",{isDownward:E-t>0,isRightward:V-l>0})})},k=()=>{v&&n.recordSnapshot(),z.emit("unMove"),document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",k)};document.addEventListener("mousemove",b),document.addEventListener("mouseup",k)},y=m=>{m.stopPropagation(),m.preventDefault(),n.hideContextMenu()},_=(m,s)=>{const t=window.event;t==null||t.stopPropagation(),t==null||t.preventDefault();const l={...e.defaultStyle},c={x:l.left+l.width/2,y:l.top+l.height/2},h=n.editorState.editor.getBoundingClientRect(),v={x:s.clientX-(h==null?void 0:h.left),y:s.clientY-(h==null?void 0:h.top)},b={x:c.x-(v.x-c.x),y:c.y-(v.y-c.y)};let k=!1,I=!0;const D=E=>{if(I){I=!1;return}k=!0;const X={x:E.clientX-(h==null?void 0:h.left),y:E.clientY-(h==null?void 0:h.top)};Te(m,l,X,{center:c,curPoint:v,symmetricPoint:b}),n.setShapeStyle(l)},V=()=>{document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",V),k&&n.recordSnapshot()};document.addEventListener("mousemove",D),document.addEventListener("mouseup",V)};return(m,s)=>{const t=M("RefreshRight"),l=M("el-icon");return d(),g("div",{ref_key:"thisRef",ref:r,class:Q(["shape",{active:a.active}]),onClick:y,onMousedown:f},[T(x(l,{class:"el-icon-refresh-right",onMousedown:u},{default:w(()=>[x(t)]),_:1},512),[[J,a.active]]),(d(!0),g($,null,U(a.active?o.pointList:[],c=>(d(),g("div",{class:"shape-point",onMousedown:h=>_(c,h),key:c,style:B(i(c))},null,44,ze))),128)),ue(m.$slots,"default",{},void 0,!0)],34)}}});const Ke=N(We,[["__scopeId","data-v-5a748337"]]),je=O({__name:"AreaComponent",props:{start:{type:Object},width:{type:Number},height:{type:Number}},setup(a){return(e,n)=>(d(),g("div",{style:B({left:a.start.x+"px",top:a.start.y+"px",width:a.width+"px",height:a.height+"px"}),class:"area"},null,4))}});const qe=N(je,[["__scopeId","data-v-b92f54dd"]]),Fe=O({__name:"EditorComponent",props:{isEdit:{type:Boolean,default:!0}},setup(a){const e=Y({editorX:0,editorY:0,start:{x:0,y:0},width:0,height:0,isShowArea:!1}),n=R.editorStore;G(()=>{n.getEditor();const s=n.editorState.editor.getBoundingClientRect();e.editorX=s.x,e.editorY=s.y,z.on("hideArea",()=>{o()})});const r=s=>{s.preventDefault(),o();const t=s.clientX,l=s.clientY;e.start.x=t-e.editorX,e.start.y=l-e.editorY,e.isShowArea=!0;const c=v=>{e.width=Math.abs(v.clientX-t),e.height=Math.abs(v.clientY-l),v.clientX<t&&(e.start.x=v.clientX-e.editorX),v.clientY<l&&(e.start.y=v.clientY-e.editorY)},h=v=>{if(document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",h),v.clientX==t&&v.clientY==l){o();return}u()};document.addEventListener("mousemove",c),document.addEventListener("mouseup",h)},o=()=>{e.isShowArea=!1,e.width=0,e.height=0},u=()=>{const s=i();if(s.length<=1){o();return}let t=1/0,l=1/0,c=-1/0,h=-1/0;s.forEach(v=>{const b=ne(v.style);b.left<l&&(l=b.left),b.top<t&&(t=b.top),b.right>c&&(c=b.right),b.bottom>h&&(h=b.bottom)}),e.start.x=l,e.start.y=t,e.width=c-l,e.height=h-t,n.setAreaData({style:{left:l,top:t,width:e.width,height:e.height},components:s})},i=()=>{const s=[],{x:t,y:l}=e.start;return n.editorState.componentData.forEach(c=>{const{left:h,top:v,width:b,height:k}=c.style;t<=h&&l<=v&&h+b<=t+e.width&&v+k<=l+e.height&&s.push(c)}),s},p=s=>{s.stopPropagation(),s.preventDefault();let t=s.target,l=s.offsetY,c=s.offsetX;for(;!t.className.includes("editor");)c+=t.offsetLeft,l+=t.offsetTop,t=t.parentNode;n.showContextMenu({top:l,left:c})},f=s=>{const t={};return["width","height","top","left","rotate"].forEach(l=>{l!="rotate"?t[l]=s[l]+"px":t.transform="rotate("+s[l]+"deg)"}),t},y=s=>de(s,["top","left","width","height","rotate"]),_=(s,t)=>{s.propValue=t,n.setShapeStyle({height:m(s,t)})},m=(s,t)=>{let{lineHeight:l,fontSize:c,height:h}=s.style;l===""&&(l=1.5);const v=t.split(`
`).length*l*c;return h>v?h:v};return(s,t)=>(d(),g("div",{class:Q(["editor",{edit:a.isEdit}]),id:"editor",style:B({width:C(n).editorState.canvasStyleData.width+"px",height:C(n).editorState.canvasStyleData.height+"px",transform:"scale("+C(n).editorState.canvasStyleData.scale/100+")"}),onContextmenu:p,onMousedown:r},[(d(!0),g($,null,U(C(n).editorState.componentData,(l,c)=>(d(),L(Ke,{defaultStyle:l.style,style:B(f(l.style)),key:l.id,active:l===C(n).editorState.curComponent,element:l,index:c},{default:w(()=>[l.component!="v-text"?(d(),L(q(l.component),{key:0,class:"component",style:B(y(l.style)),propValue:l.propValue,element:l},null,8,["style","propValue","element"])):(d(),L(q(l.component),{key:1,class:"component",style:B(y(l.style)),propValue:l.propValue,onInput:_,element:l},null,40,["style","propValue","element"]))]),_:2},1032,["defaultStyle","style","active","element","index"]))),128)),x(Pe),x(Oe),T(x(qe,{start:e.start,width:e.width,height:e.height},null,8,["start","width","height"]),[[J,e.isShowArea]])],38))}});const Je=N(Fe,[["__scopeId","data-v-40990efa"]]),le={redirect(a){a&&(window.location.href=a)},alert(a){a&&alert(a)}},Ge=[{key:"redirect",label:"跳转事件",event:le.redirect,param:""},{key:"alert",label:"alert 事件",event:le.alert,param:""}],Qe=O({__name:"ComponentWrapper",props:{config:{}},setup(a){const e=a,n=ce();G(()=>{n.value!==void 0&&pe(n.value,e.config.animations)});const r=()=>{const o=e.config.events;Object.keys(o).forEach(u=>{le[u](o[u])})};return(o,u)=>(d(),g("div",{onClick:r,ref_key:"wrapperDom",ref:n},[(d(),L(q(o.config.component),{class:"component",style:B(C(de)(o.config.style)),propValue:o.config.propValue},null,8,["style","propValue"]))],512))}});const Ze=N(Qe,[["__scopeId","data-v-01edd797"]]),et={key:0,class:"bg"},tt={class:"canvas-container"},ot=O({__name:"Preview",props:{show:{type:Boolean}},emits:["update:show"],setup(a,{emit:e}){const n=R.editorStore.editorState,r=()=>{e("update:show",!1)};return(o,u)=>{const i=M("el-button");return o.show?(d(),g("div",et,[x(i,{onClick:r,class:"close"},{default:w(()=>[A("关闭")]),_:1}),S("div",tt,[S("div",{class:"canvas",style:B({width:C(n).canvasStyleData.width+"px",height:C(n).canvasStyleData.height+"px"})},[(d(!0),g($,null,U(C(n).componentData,(p,f)=>(d(),L(Ze,{key:f,config:p},null,8,["config"]))),128))],4)])])):H("",!0)}}});const nt=N(ot,[["__scopeId","data-v-13472ac8"]]),ee=a=>(ge("data-v-447080db"),a=a(),be(),a),at={class:"toolbar"},lt=ee(()=>S("label",{for:"input",class:"insert"},"插入图片",-1)),st={class:"canvas-config"},it=ee(()=>S("span",null,"画布大小",-1)),rt=ee(()=>S("span",null,"*",-1)),ct={class:"canvas-config"},ut=ee(()=>S("span",null,"画布比例",-1)),dt=O({__name:"Toolbar",setup(a){const e=R.editorStore,n=Y({isShowPreview:!1}),r=()=>{e.compose()},o=()=>{e.decompose()},u=()=>{e.undo()},i=()=>{e.redo()},p=s=>{const t=s.target.files[0];if(!t.type.includes("image")){_e("只能插入图片");return}const l=new FileReader;l.onload=c=>{const h=c.target.result,v=new Image;v.onload=()=>{e.addComponent({component:{...fe,id:ae(),component:"v-picture",label:"图片",icon:"",propValue:h,style:{...ve,top:0,left:0,width:v.width,height:v.height}},index:void 0})},v.src=h},l.readAsDataURL(t)},f=()=>{n.isShowPreview=!0,e.setEditMode("read")},y=()=>{e.setEditMode("edit")},_=()=>{localStorage.setItem("canvasData",JSON.stringify(e.editorState.componentData)),localStorage.setItem("canvasStyle",JSON.stringify(e.editorState.canvasStyleData)),ye.success("保存成功")},m=()=>{e.setComponentData([])};return(s,t)=>{const l=M("el-button");return d(),g("div",null,[S("div",at,[x(l,{onClick:u},{default:w(()=>[A("撤消")]),_:1}),x(l,{onClick:i},{default:w(()=>[A("重做")]),_:1}),lt,S("input",{type:"file",onChange:p,id:"input",hidden:""},null,32),x(l,{onClick:f,style:{"margin-left":"10px"}},{default:w(()=>[A("预览")]),_:1}),x(l,{onClick:_},{default:w(()=>[A("保存")]),_:1}),x(l,{onClick:m},{default:w(()=>[A("清空画布")]),_:1}),x(l,{onClick:r},{default:w(()=>[A("组合")]),_:1}),x(l,{onClick:o},{default:w(()=>[A("拆分")]),_:1}),S("div",st,[it,T(S("input",{"onUpdate:modelValue":t[0]||(t[0]=c=>C(e).editorState.canvasStyleData.width=c)},null,512),[[oe,C(e).editorState.canvasStyleData.width]]),rt,T(S("input",{"onUpdate:modelValue":t[1]||(t[1]=c=>C(e).editorState.canvasStyleData.height=c)},null,512),[[oe,C(e).editorState.canvasStyleData.height]])]),S("div",ct,[ut,T(S("input",{"onUpdate:modelValue":t[2]||(t[2]=c=>C(e).editorState.canvasStyleData.scale=c)},null,512),[[oe,C(e).editorState.canvasStyleData.scale]]),A(" % ")])]),x(nt,{show:n.isShowPreview,"onUpdate:show":t[3]||(t[3]=c=>n.isShowPreview=c),onChange:y},null,8,["show"])])}}});const pt=N(dt,[["__scopeId","data-v-447080db"]]),ie=[{label:"进入",children:[{label:"渐显",value:"fadeIn"},{label:"向右进入",value:"fadeInLeft"},{label:"向左进入",value:"fadeInRight"},{label:"向上进入",value:"fadeInUp"},{label:"向下进入",value:"fadeInDown"},{label:"向右长距进入",value:"fadeInLeftBig"},{label:"向左长距进入",value:"fadeInRightBig"},{label:"向上长距进入",value:"fadeInUpBig"},{label:"向下长距进入",value:"fadeInDownBig"},{label:"旋转进入",value:"rotateIn"},{label:"左顺时针旋转",value:"rotateInDownLeft"},{label:"右逆时针旋转",value:"rotateInDownRight"},{label:"左逆时针旋转",value:"rotateInUpLeft"},{label:"右逆时针旋转",value:"rotateInUpRight"},{label:"弹入",value:"bounceIn"},{label:"向右弹入",value:"bounceInLeft"},{label:"向左弹入",value:"bounceInRight"},{label:"向上弹入",value:"bounceInUp"},{label:"向下弹入",value:"bounceInDown"},{label:"光速从右进入",value:"lightSpeedInRight"},{label:"光速从左进入",value:"lightSpeedInLeft"},{label:"光速从右退出",value:"lightSpeedOutRight"},{label:"光速从左退出",value:"lightSpeedOutLeft"},{label:"Y轴旋转",value:"flip"},{label:"中心X轴旋转",value:"flipInX"},{label:"中心Y轴旋转",value:"flipInY"},{label:"左长半径旋转",value:"rollIn"},{label:"由小变大进入",value:"zoomIn"},{label:"左变大进入",value:"zoomInLeft"},{label:"右变大进入",value:"zoomInRight"},{label:"向上变大进入",value:"zoomInUp"},{label:"向下变大进入",value:"zoomInDown"},{label:"向右滑动展开",value:"slideInLeft"},{label:"向左滑动展开",value:"slideInRight"},{label:"向上滑动展开",value:"slideInUp"},{label:"向下滑动展开",value:"slideInDown"}]},{label:"强调",children:[{label:"弹跳",value:"bounce"},{label:"闪烁",value:"flash"},{label:"放大缩小",value:"pulse"},{label:"放大缩小弹簧",value:"rubberBand"},{label:"左右晃动",value:"headShake"},{label:"左右扇形摇摆",value:"swing"},{label:"放大晃动缩小",value:"tada"},{label:"扇形摇摆",value:"wobble"},{label:"左右上下晃动",value:"jello"},{label:"Y轴旋转",value:"flip"}]},{label:"退出",children:[{label:"渐隐",value:"fadeOut"},{label:"向左退出",value:"fadeOutLeft"},{label:"向右退出",value:"fadeOutRight"},{label:"向上退出",value:"fadeOutUp"},{label:"向下退出",value:"fadeOutDown"},{label:"向左长距退出",value:"fadeOutLeftBig"},{label:"向右长距退出",value:"fadeOutRightBig"},{label:"向上长距退出",value:"fadeOutUpBig"},{label:"向下长距退出",value:"fadeOutDownBig"},{label:"旋转退出",value:"rotateOut"},{label:"左顺时针旋转",value:"rotateOutDownLeft"},{label:"右逆时针旋转",value:"rotateOutDownRight"},{label:"左逆时针旋转",value:"rotateOutUpLeft"},{label:"右逆时针旋转",value:"rotateOutUpRight"},{label:"弹出",value:"bounceOut"},{label:"向左弹出",value:"bounceOutLeft"},{label:"向右弹出",value:"bounceOutRight"},{label:"向上弹出",value:"bounceOutUp"},{label:"向下弹出",value:"bounceOutDown"},{label:"中心X轴旋转",value:"flipOutX"},{label:"中心Y轴旋转",value:"flipOutY"},{label:"左长半径旋转",value:"rollOut"},{label:"由小变大退出",value:"zoomOut"},{label:"左变大退出",value:"zoomOutLeft"},{label:"右变大退出",value:"zoomOutRight"},{label:"向上变大退出",value:"zoomOutUp"},{label:"向下变大退出",value:"zoomOutDown"},{label:"向左滑动收起",value:"slideOutLeft"},{label:"向右滑动收起",value:"slideOutRight"},{label:"向上滑动收起",value:"slideOutUp"},{label:"向下滑动收起",value:"slideOutDown"}]}],ht=O({__name:"Modal",props:{show:{type:Boolean}},emits:["update:show"],setup(a,{emit:e}){const n=()=>{e("update:show")},r=o=>{o.stopPropagation()};return(o,u)=>o.show?(d(),g("div",{key:0,class:"modal-bg",onClick:n},[S("div",{class:"fadeInLeft animated modal",onClick:r},[ue(o.$slots,"default",{},void 0,!0)])])):H("",!0)}});const he=N(ht,[["__scopeId","data-v-b4747281"]]),mt={class:"animation-list"},_t={key:0,class:"div-animation"},ft={class:"el-scrollbar-view"},vt=["onMouseover","onClick"],yt=O({__name:"AnimationList",setup(a){const e=R.editorStore,n=Y({isShowAnimation:!1,animationClassData:ie,animationActiveName:"进入",showAnimatePanel:!1,hoverPreviewAnimate:""}),r=i=>{e.addAnimation(i),n.isShowAnimation=!1},o=()=>{z.emit("runAnimation")},u=i=>{e.removeAnimation(i)};return(i,p)=>{const f=M("el-button"),y=M("el-tag"),_=M("el-scrollbar"),m=M("el-tab-pane"),s=M("el-tabs");return d(),g("div",mt,[C(e).editorState.curComponent?(d(),g("div",_t,[x(f,{onClick:p[0]||(p[0]=t=>{n.isShowAnimation=!0})},{default:w(()=>[A("添加动画")]),_:1}),x(f,{onClick:o},{default:w(()=>[A("预览动画")]),_:1}),S("div",null,[(d(!0),g($,null,U(C(e).editorState.curComponent.animations,(t,l)=>(d(),L(y,{key:l,closable:"",onClose:c=>u(l)},{default:w(()=>[A(F(t.label),1)]),_:2},1032,["onClose"]))),128))])])):H("",!0),x(he,{show:n.isShowAnimation,"onUpdate:show":p[2]||(p[2]=t=>n.isShowAnimation=t)},{default:w(()=>[x(s,{type:"card",modelValue:n.animationActiveName,"onUpdate:modelValue":p[1]||(p[1]=t=>n.animationActiveName=t)},{default:w(()=>[(d(!0),g($,null,U(C(ie),t=>(d(),L(m,{key:t.label,label:t.label,name:t.label},{default:w(()=>[x(_,{class:"animate-container"},{default:w(()=>[S("div",ft,[(d(!0),g($,null,U(t.children,(l,c)=>(d(),g("div",{class:"animate",key:c,onMouseover:h=>n.hoverPreviewAnimate=l.value,onClick:h=>r(l)},[S("div",{class:Q([n.hoverPreviewAnimate===l.value&&"animate__animated animate__"+l.value])},F(l.label),3)],40,vt))),128))])]),_:2},1024)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["show"])])}}});const gt=N(yt,[["__scopeId","data-v-41b1b119"]]),bt={class:"event-list"},St={key:0,class:"div-events"},xt=O({__name:"EventList",setup(a){const e=R.editorStore,n=Y({isShowEvent:!1,eventURL:"",eventActiveName:"redirect",eventList:Ge}),r=(u,i)=>{n.isShowEvent=!1,e.addEvent({event:u,param:i})},o=u=>{e.removeEvent(u)};return(u,i)=>{const p=M("el-button"),f=M("el-tag"),y=M("el-input"),_=M("el-tab-pane"),m=M("el-tabs");return d(),g("div",bt,[C(e).editorState.curComponent?(d(),g("div",St,[x(p,{onClick:i[0]||(i[0]=s=>n.isShowEvent=!0)},{default:w(()=>[A("添加事件")]),_:1}),S("div",null,[(d(!0),g($,null,U(Object.keys(C(e).editorState.curComponent.events),s=>(d(),L(f,{key:s,closable:"",onClose:t=>o(s)},{default:w(()=>[A(F(s),1)]),_:2},1032,["onClose"]))),128))])])):H("",!0),x(he,{show:n.isShowEvent,"onUpdate:show":i[2]||(i[2]=s=>n.isShowEvent=s)},{default:w(()=>[x(m,{type:"card",modelValue:n.eventActiveName,"onUpdate:modelValue":i[1]||(i[1]=s=>n.eventActiveName=s)},{default:w(()=>[(d(!0),g($,null,U(n.eventList,s=>(d(),L(_,{key:s.key,label:s.label,name:s.key,style:{padding:"0 20px"}},{default:w(()=>[s.key=="redirect"?(d(),L(y,{key:0,modelValue:s.param,"onUpdate:modelValue":t=>s.param=t,type:"textarea",placeholder:"请输入完整的 URL"},null,8,["modelValue","onUpdate:modelValue"])):H("",!0),s.key=="alert"?(d(),L(y,{key:1,modelValue:s.param,"onUpdate:modelValue":t=>s.param=t,type:"textarea",placeholder:"请输入要 alert 的内容"},null,8,["modelValue","onUpdate:modelValue"])):H("",!0),x(p,{style:{"margin-top":"20px"},onClick:t=>r(s.key,s.param)},{default:w(()=>[A("确定")]),_:2},1032,["onClick"])]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["show"])])}}});const wt=N(xt,[["__scopeId","data-v-03af1cf7"]]),Ct={class:"home"},kt={class:"left"},Lt={class:"center"},Mt={class:"right"},Dt={key:1,class:"placeholder"},It={key:1,class:"placeholder"},Pt={key:1,class:"placeholder"},Vt=O({__name:"Home",setup(a){const e=R.editorStore,n=Y({activeName:"attr",reSelectAnimateIndex:void 0}),r=()=>{localStorage.getItem("canvasData")&&e.setComponentData(u(JSON.parse(localStorage.getItem("canvasData")))),localStorage.getItem("canvasStyle")&&e.setCanvasStyle(JSON.parse(localStorage.getItem("canvasStyle")))},o=()=>{let t=!1;window.onkeydown=l=>{l.keyCode==17?t=!0:t&&l.keyCode==67?e.copy():t&&l.keyCode==86?e.paste(!1):t&&l.keyCode==88&&e.cut()},window.onkeyup=l=>{l.keyCode==17&&(t=!1)}},u=y=>(y.forEach(_=>{_.id=ae()}),y),i=y=>{y.preventDefault(),y.stopPropagation();const _=Se.cloneDeep(re[y.dataTransfer.getData("index")]);_.style.top=y.offsetY,_.style.left=y.offsetX,_.id=ae(),e.addComponent({component:_,index:void 0}),e.recordSnapshot()},p=y=>{y.preventDefault(),y.dataTransfer.dropEffect="copy"},f=()=>{e.setCurComponent({component:null,index:null}),e.hideContextMenu()};return r(),o(),(y,_)=>{const m=M("el-tab-pane"),s=M("el-tabs");return d(),g("div",Ct,[x(pt),S("main",null,[S("section",kt,[x(ke)]),S("section",Lt,[S("div",{class:"content",onDrop:i,onDragover:p,onClick:f},[x(Je)],32)]),S("section",Mt,[x(s,{modelValue:n.activeName,"onUpdate:modelValue":_[0]||(_[0]=t=>n.activeName=t),type:"card"},{default:w(()=>[x(m,{label:"属性",name:"attr"},{default:w(()=>[C(e).editorState.curComponent?(d(),L(De,{key:0})):(d(),g("p",Dt,"请选择组件"))]),_:1}),x(m,{label:"动画",name:"animation"},{default:w(()=>[C(e).editorState.curComponent?(d(),L(gt,{key:0})):(d(),g("p",It,"请选择组件"))]),_:1}),x(m,{label:"事件",name:"events"},{default:w(()=>[C(e).editorState.curComponent?(d(),L(wt,{key:0})):(d(),g("p",Pt,"请选择组件"))]),_:1})]),_:1},8,["modelValue"])])])])}}});const Ot=N(Vt,[["__scopeId","data-v-37191b7d"]]);export{Ot as default};
