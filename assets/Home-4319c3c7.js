import{d as R,o as p,c as v,F as U,r as $,a as k,b as J,e as C,t as ee,u as b,_ as N,f as z,g as se,h as L,i as S,w as x,j as A,k as B,l as j,v as ne,n as H,m as ae,p as G,q as pe,s as me,x as _e,y as E,z as re,A as ve,B as te,E as ge,C as be,D as ye,G as Se}from"./index-55a6f656.js";const xe="/editor-demo/assets/title-9b4c7ab1.jpg",we={rotate:"",opacity:1},le=[{id:0,component:"v-text",label:"文字",propValue:"文字",icon:"Edit",animations:[],events:{},style:{top:0,left:0,width:200,height:33,fontSize:14,fontWeight:500,lineHeight:"",letterSpacing:0,textAlign:"",color:""}},{id:0,component:"v-button",label:"按钮",propValue:"按钮",icon:"Crop",animations:[],events:{},style:{top:0,left:0,width:100,height:34,borderWidth:"",borderColor:"",borderRadius:"",fontSize:14,fontWeight:500,lineHeight:"",letterSpacing:0,textAlign:"",color:"",backgroundColor:""}},{id:0,component:"v-picture",label:"图片",icon:"PictureRounded",propValue:Ce(xe),animations:[],events:{},style:{top:0,left:0,width:300,height:200,borderRadius:""}}];le.forEach(e=>{e.style={...e.style,...we}});function Ce(e){return new URL(e,import.meta.url).href}const Me={class:"component-list"},ke=["data-index"],Le=R({__name:"ComponentList",setup(e){const t=a=>{a.dataTransfer.setData("index",a.target.dataset.index)};return(a,l)=>(p(),v("div",Me,[(p(!0),v(U,null,$(b(le),(o,h)=>(p(),v("div",{key:h,class:"item",draggable:"true",onDragstart:l[0]||(l[0]=c=>t(c)),"data-index":h},[(p(),k(J(o.icon),{class:"icon"})),C("span",null,ee(o.label),1)],40,ke))),128))]))}});const De=N(Le,[["__scopeId","data-v-c47933ae"]]),Pe={class:"attr-list"},Ie=R({__name:"AttrList",setup(e){const t=B.editorStore,a=z({excludes:["Picture"],options:[{label:"左对齐",value:"left"},{label:"居中",value:"center"},{label:"右对齐",value:"right"}],map:{left:"x 坐标",top:"y 坐标",height:"高",width:"宽",color:"颜色",backgroundColor:"背景色",borderWidth:"边框宽度",borderColor:"边框颜色",borderRadius:"边框半径",fontSize:"字体大小",fontWeight:"字体粗细",lineHeight:"行高",letterSpacing:"字间距",textAlign:"对齐方式",opacity:"透明度"}}),l=se(()=>t.editorState.curComponent?Object.keys(t.editorState.curComponent.style):[]),o=se(()=>t.editorState.curComponent);return(h,c)=>{const r=L("el-color-picker"),u=L("el-option"),m=L("el-select"),_=L("el-input"),n=L("el-form-item"),d=L("el-form");return p(),v("div",Pe,[S(d,null,{default:x(()=>[(p(!0),v(U,null,$(l.value.filter(i=>i!="rotate"),(i,s)=>(p(),k(n,{key:s,label:a.map[i]},{default:x(()=>[i=="borderColor"?(p(),k(r,{key:0,modelValue:o.value.style[i],"onUpdate:modelValue":f=>o.value.style[i]=f},null,8,["modelValue","onUpdate:modelValue"])):i=="color"?(p(),k(r,{key:1,modelValue:o.value.style[i],"onUpdate:modelValue":f=>o.value.style[i]=f},null,8,["modelValue","onUpdate:modelValue"])):i=="backgroundColor"?(p(),k(r,{key:2,modelValue:o.value.style[i],"onUpdate:modelValue":f=>o.value.style[i]=f},null,8,["modelValue","onUpdate:modelValue"])):i=="textAlign"?(p(),k(m,{key:3,modelValue:o.value.style[i],"onUpdate:modelValue":f=>o.value.style[i]=f},{default:x(()=>[(p(!0),v(U,null,$(a.options,f=>(p(),k(u,{key:f.value,label:f.label,value:f.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):(p(),k(_,{key:4,type:"number",modelValue:o.value.style[i],"onUpdate:modelValue":f=>o.value.style[i]=f},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["label"]))),128)),o.value&&o.value.propValue&&!a.excludes.includes(o.value.component)?(p(),k(n,{key:0,label:"内容"},{default:x(()=>[S(_,{type:"textarea",modelValue:o.value.propValue,"onUpdate:modelValue":c[0]||(c[0]=i=>o.value.propValue=i)},null,8,["modelValue"])]),_:1})):A("",!0)]),_:1})])}}});const Ve=N(Ie,[["__scopeId","data-v-fb23c8da"]]),Oe=R({__name:"ContextMenu",setup(e){const t=B.editorStore;z({copyData:null});const a=()=>{t.copy()},l=()=>{t.paste(!0)},o=()=>{t.cut()},h=()=>{t.deleteComponent(),t.recordSnapshot()},c=()=>{t.upComponent(),t.recordSnapshot()},r=()=>{t.downComponent(),t.recordSnapshot()},u=()=>{t.topComponent(),t.recordSnapshot()},m=()=>{t.bottomComponent(),t.recordSnapshot()};return(_,n)=>j((p(),v("div",{class:"contextmenu",style:H({top:b(t).editorState.menuTop+"px",left:b(t).editorState.menuLeft+"px"})},[C("ul",null,[b(t).editorState.curComponent?(p(),v("li",{key:0,onClick:a},"复制")):A("",!0),C("li",{onClick:l},"粘贴"),b(t).editorState.curComponent?(p(),v("li",{key:1,onClick:o},"剪切")):A("",!0),b(t).editorState.curComponent?(p(),v("li",{key:2,onClick:h},"删除")):A("",!0),b(t).editorState.curComponent?(p(),v("li",{key:3,onClick:u},"置顶")):A("",!0),b(t).editorState.curComponent?(p(),v("li",{key:4,onClick:m},"置底")):A("",!0),b(t).editorState.curComponent?(p(),v("li",{key:5,onClick:c},"上移")):A("",!0),b(t).editorState.curComponent?(p(),v("li",{key:6,onClick:r},"下移")):A("",!0)])],4)),[[ne,b(t).editorState.menuShow]])}});const Re=N(Oe,[["__scopeId","data-v-ab3b3a2f"]]);function Ne(e){return{all:e=e||new Map,on:function(t,a){var l=e.get(t);l?l.push(a):e.set(t,[a])},off:function(t,a){var l=e.get(t);l&&(a?l.splice(l.indexOf(a)>>>0,1):e.set(t,[]))},emit:function(t,a){var l=e.get(t);l&&l.slice().map(function(o){o(a)}),(l=e.get("*"))&&l.slice().map(function(o){o(t,a)})}}}const X=Ne();function W(e){return e*Math.PI/180}function V(e,t,a){return{x:(e.x-t.x)*Math.cos(W(a))-(e.y-t.y)*Math.sin(W(a))+t.x,y:(e.x-t.x)*Math.sin(W(a))+(e.y-t.y)*Math.cos(W(a))+t.y}}function Ae(e,t,a){let l;switch(a){case"t":l={x:e.left+e.width/2,y:e.top};break;case"b":l={x:e.left+e.width/2,y:e.top+e.height};break;case"l":l={x:e.left,y:e.top+e.height/2};break;case"r":l={x:e.left+e.width,y:e.top+e.height/2};break;case"lt":l={x:e.left,y:e.top};break;case"rt":l={x:e.left+e.width,y:e.top};break;case"lb":l={x:e.left,y:e.top+e.height};break;default:l={x:e.left+e.width,y:e.top+e.height};break}return V(l,t,e.rotate)}function Q(e,t){return{x:e.x+(t.x-e.x)/2,y:e.y+(t.y-e.y)/2}}function ce(e){return Math.abs(Math.sin(W(e)))}function ue(e){return Math.abs(Math.cos(W(e)))}const Ue={class:"mark-line"},$e=R({__name:"MarkLine",setup(e){const t=B.editorStore,a=new Map,l=(n,d)=>{n&&a.set(d,n)},o=z({lines:["xt","xc","xb","yl","yc","yr"],diff:3,lineStatus:{xt:!1,xc:!1,xb:!1,yl:!1,yc:!1,yr:!1}});ae(()=>{X.on("move",n=>{r(n.isDownward,n.isRightward)}),X.on("unMove",()=>{c()})});const h=n=>{if(n={...n},n.rotate!=0){const d=n.width*ue(n.rotate)+n.height*ce(n.rotate),i=(n.width-d)/2;n.left+=i,n.right=n.left+d;const s=n.height*ue(n.rotate)+n.width*ce(n.rotate),f=(s-n.height)/2;n.top-=f,n.bottom=n.top+s,n.width=d,n.height=s}else n.bottom=n.top+n.height,n.right=n.left+n.width;return n},c=()=>{Object.keys(o.lineStatus).forEach(n=>{o.lineStatus[n]=!1})},r=(n,d)=>{const i=t.editorState.componentData,s=h(t.editorState.curComponent.style),f=s.width/2,g=s.height/2;c(),i.forEach(y=>{if(y==t.editorState.curComponent)return;const I=h(y.style),{top:w,left:M,bottom:D,right:P}=I,O=I.width/2,T=I.height/2,q={top:[{isNearly:_(s.top,w),lineNode:a.get("xt"),line:"xt",dragShift:w,lineShift:w},{isNearly:_(s.bottom,w),lineNode:a.get("xt"),line:"xt",dragShift:w-s.height,lineShift:w},{isNearly:_(s.top+g,w+T),lineNode:a.get("xc"),line:"xc",dragShift:w+T-g,lineShift:w+T},{isNearly:_(s.top,D),lineNode:a.get("xb"),line:"xb",dragShift:D,lineShift:D},{isNearly:_(s.bottom,D),lineNode:a.get("xb"),line:"xb",dragShift:D-s.height,lineShift:D}],left:[{isNearly:_(s.left,M),lineNode:a.get("yl"),line:"yl",dragShift:M,lineShift:M},{isNearly:_(s.right,M),lineNode:a.get("yl"),line:"yl",dragShift:M-s.width,lineShift:M},{isNearly:_(s.left+f,M+O),lineNode:a.get("yc"),line:"yc",dragShift:M+O-f,lineShift:M+O},{isNearly:_(s.left,P),lineNode:a.get("yr"),line:"yr",dragShift:P,lineShift:P},{isNearly:_(s.right,P),lineNode:a.get("yr"),line:"yr",dragShift:P-s.width,lineShift:P}]},K=[],{rotate:Z}=t.editorState.curComponent.style;Object.keys(q).forEach(F=>{q[F].forEach(Y=>{Y.isNearly&&(t.setShapePosStyle({key:F,value:Z!=0?u(F,Y,s):Y.dragShift}),Y.lineNode.style[F]=`${Y.lineShift}px`,K.push(Y.line))})}),K.length&&m(K,n,d)})},u=(n,d,i)=>{const{width:s,height:f}=t.editorState.curComponent.style;return n=="top"?Math.round(d.dragShift-(f-i.height)/2):Math.round(d.dragShift-(s-i.width)/2)},m=(n,d,i)=>{i?n.includes("yr")?o.lineStatus.yr=!0:n.includes("yc")?o.lineStatus.yc=!0:n.includes("yl")&&(o.lineStatus.yl=!0):n.includes("yl")?o.lineStatus.yl=!0:n.includes("yc")?o.lineStatus.yc=!0:n.includes("yr")&&(o.lineStatus.yr=!0),d?n.includes("xb")?o.lineStatus.xb=!0:n.includes("xc")?o.lineStatus.xc=!0:n.includes("xt")&&(o.lineStatus.xt=!0):n.includes("xt")?o.lineStatus.xt=!0:n.includes("xc")?o.lineStatus.xc=!0:n.includes("xb")&&(o.lineStatus.xb=!0)},_=(n,d)=>Math.abs(n-d)<=o.diff;return(n,d)=>(p(),v("div",Ue,[(p(!0),v(U,null,$(o.lines,i=>j((p(),v("div",{key:i,class:G(["line",i.includes("x")?"xline":"yline"]),ref_for:!0,ref:s=>l(s,i)},null,2)),[[ne,o.lineStatus[i]||!1]])),128))]))}});const Ee=N($e,[["__scopeId","data-v-736c7152"]]);async function he(e,t=[]){if(e){const a=l=>new Promise(o=>{e.classList.add("animate__animated","animate__"+l.value);const h=()=>{e.removeEventListener("animationend",h),e.removeEventListener("animationcancel",h),e.classList.remove("animate__animated","animate__"+l.value),o()};e.addEventListener("animationend",h),e.addEventListener("animationcancel",h)});for(let l=0,o=t.length;l<o;l++)await a(t[l])}else console.log("runAnimation el为空")}const Be={lt:He,t:ze,rt:Xe,r:Te,rb:Ke,b:Ye,lb:je,l:We};function He(e,t,a){const{symmetricPoint:l}=a,o=Q(t,l),h=V(t,o,-e.rotate),c=V(l,o,-e.rotate),r=c.x-h.x,u=c.y-h.y;r>0&&u>0&&(e.width=Math.round(r),e.height=Math.round(u),e.left=Math.round(h.x),e.top=Math.round(h.y))}function ze(e,t,a){const{symmetricPoint:l,clickPoint:o}=a,h=V(t,o,-e.rotate),c=V({x:o.x,y:h.y},o,e.rotate),r=Math.sqrt((c.x-l.x)**2+(c.y-l.y)**2);if(r>0){const u={x:c.x-(c.x-l.x)/2,y:c.y+(l.y-c.y)/2};e.height=Math.round(r),e.top=Math.round(u.y-r/2),e.left=Math.round(u.x-e.width/2)}}function Te(e,t,a){const{symmetricPoint:l,clickPoint:o}=a,h=V(t,o,-e.rotate),c=V({x:h.x,y:o.y},o,e.rotate),r=Math.sqrt((c.x-l.x)**2+(c.y-l.y)**2);if(r>0){const u={x:c.x-(c.x-l.x)/2,y:c.y+(l.y-c.y)/2};e.width=Math.round(r),e.top=Math.round(u.y-e.height/2),e.left=Math.round(u.x-r/2)}}function Ye(e,t,a){const{symmetricPoint:l,clickPoint:o}=a,h=V(t,o,-e.rotate),c=V({x:o.x,y:h.y},o,e.rotate),r=Math.sqrt((c.x-l.x)**2+(c.y-l.y)**2);if(r>0){const u={x:c.x-(c.x-l.x)/2,y:c.y+(l.y-c.y)/2};e.height=Math.round(r),e.top=Math.round(u.y-r/2),e.left=Math.round(u.x-e.width/2)}}function We(e,t,a){const{symmetricPoint:l,clickPoint:o}=a,h=V(t,o,-e.rotate),c=V({x:h.x,y:o.y},o,e.rotate),r=Math.sqrt((c.x-l.x)**2+(c.y-l.y)**2);if(r>0){const u={x:c.x-(c.x-l.x)/2,y:c.y+(l.y-c.y)/2};e.width=Math.round(r),e.top=Math.round(u.y-e.height/2),e.left=Math.round(u.x-r/2)}}function Xe(e,t,a){const{symmetricPoint:l}=a,o=Q(t,l),h=V(t,o,-e.rotate),c=V(l,o,-e.rotate),r=h.x-c.x,u=c.y-h.y;r>0&&u>0&&(e.width=Math.round(r),e.height=Math.round(u),e.left=Math.round(c.x),e.top=Math.round(h.y))}function Ke(e,t,a){const{symmetricPoint:l}=a,o=Q(t,l),h=V(l,o,-e.rotate),c=V(t,o,-e.rotate),r=c.x-h.x,u=c.y-h.y;r>0&&u>0&&(e.width=Math.round(r),e.height=Math.round(u),e.left=Math.round(h.x),e.top=Math.round(h.y))}function je(e,t,a){const{symmetricPoint:l}=a,o=Q(t,l),h=V(l,o,-e.rotate),c=V(t,o,-e.rotate),r=h.x-c.x,u=c.y-h.y;r>0&&u>0&&(e.width=Math.round(r),e.height=Math.round(u),e.left=Math.round(c.x),e.top=Math.round(h.y))}function qe(e,t,a,l){Be[e](t,a,l)}const Fe=["onMousedown"],Je=R({__name:"ShapeComponent",props:{active:{type:Boolean,default:!1},element:{require:!0,type:Object},defaultStyle:{require:!0,type:Object},index:{require:!0,type:[Number,String]}},setup(e){const t=e,a=B.editorStore,l=pe(),o=z({pointList:["lt","t","rt","r","rb","b","lb","l"],initialAngle:{lt:0,t:45,rt:90,r:135,rb:180,b:225,lb:270,l:315},angleToCursor:[{start:338,end:23,cursor:"nw"},{start:23,end:68,cursor:"n"},{start:68,end:113,cursor:"ne"},{start:113,end:158,cursor:"e"},{start:158,end:203,cursor:"se"},{start:203,end:248,cursor:"s"},{start:248,end:293,cursor:"sw"},{start:293,end:338,cursor:"w"}],cursors:{}});ae(()=>{X.on("runAnimation",()=>{t.element===a.getCurComponent&&l.value!==void 0&&he(l.value,a.getCurComponent.animations)})});const h=n=>{var O;n.stopPropagation();const d={...t.defaultStyle},i=n.clientY,s=n.clientX,f=d.rotate,g=(O=l.value)==null?void 0:O.getBoundingClientRect(),y=(g==null?void 0:g.left)+(g==null?void 0:g.width)/2,I=(g==null?void 0:g.top)+(g==null?void 0:g.height)/2,w=Math.atan2(i-I,s-y)/(Math.PI/180);let M=!1;const D=T=>{M=!0;const q=T.clientX,K=T.clientY,Z=Math.atan2(K-I,q-y)/(Math.PI/180);d.rotate=f+Z-w,a.setShapeStyle(d)},P=()=>{M&&a.recordSnapshot(),document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",P),o.cursors=r()};document.addEventListener("mousemove",D),document.addEventListener("mouseup",P)},c=n=>{var D,P;const d=(D=t.defaultStyle)==null?void 0:D.height,i=(P=t.defaultStyle)==null?void 0:P.width,s=/t/.test(n),f=/b/.test(n),g=/l/.test(n),y=/r/.test(n);let I=0,w=0;return n.length===2?(I=g?0:i,w=s?0:d):((s||f)&&(I=i/2,w=s?0:d),(g||y)&&(I=g?0:i,w=Math.floor(d/2))),{marginLeft:"-4px",marginTop:"-4px",left:`${I}px`,top:`${w}px`,cursor:o.cursors[n]}},r=()=>{const n=(a.editorState.curComponent.style.rotate+360)%360,d={};return o.pointList.forEach(i=>{const s=(o.initialAngle[i]+n)%360;for(let f=0,g=o.angleToCursor.length;f<g;f++){const y=o.angleToCursor[f];if(s<23||s>=338){d[i]="nw-resize";break}if(y.start<=s&&s<y.end){d[i]=y.cursor+"-resize";break}}}),d},u=n=>{var M;((M=t.element)==null?void 0:M.component)!="v-text"&&n.preventDefault(),n.stopPropagation(),a.setCurComponent({component:t.element,index:t.index}),o.cursors=r();const d={...t.defaultStyle},i=n.clientY,s=n.clientX,f=Number(d.top),g=Number(d.left);let y=!1;const I=D=>{y=!0;const P=D.clientX,O=D.clientY;d.top=O-i+f,d.left=P-s+g,a.setShapeStyle(d),_e(()=>{X.emit("move",{isDownward:O-i>0,isRightward:P-s>0})})},w=()=>{y&&a.recordSnapshot(),X.emit("unMove"),document.removeEventListener("mousemove",I),document.removeEventListener("mouseup",w)};document.addEventListener("mousemove",I),document.addEventListener("mouseup",w)},m=n=>{n.stopPropagation(),n.preventDefault(),a.hideContextMenu()},_=n=>{var D;const d=window.event;d==null||d.stopPropagation(),d==null||d.preventDefault();const i={...t.defaultStyle},s={x:i.left+i.width/2,y:i.top+i.height/2},f=Ae(i,s,n),g={x:s.x-(f.x-s.x),y:s.y-(f.y-s.y)},y=(D=document==null?void 0:document.querySelector("#editor"))==null?void 0:D.getBoundingClientRect();let I=!1;const w=P=>{I=!0;const O={x:P.clientX-(y==null?void 0:y.left),y:P.clientY-(y==null?void 0:y.top)};qe(n,i,O,{center:s,clickPoint:f,symmetricPoint:g}),a.setShapeStyle(i)},M=()=>{document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",M),I&&a.recordSnapshot()};document.addEventListener("mousemove",w),document.addEventListener("mouseup",M)};return(n,d)=>{const i=L("RefreshRight"),s=L("el-icon");return p(),v("div",{ref_key:"thisRef",ref:l,class:G(["shape",{active:e.active}]),onClick:m,onMousedown:u},[j(S(s,{class:"el-icon-refresh-right",onMousedown:h},{default:x(()=>[S(i)]),_:1},512),[[ne,e.active]]),(p(!0),v(U,null,$(e.active?o.pointList:[],(f,g)=>(p(),v("div",{class:"shape-point",onMousedown:y=>_(f),key:g,style:H(c(f))},null,44,Fe))),128)),me(n.$slots,"default",{},void 0,!0)],34)}}});const Ge=N(Je,[["__scopeId","data-v-0d43a2a0"]]);function fe(e,t=[]){const a=["fontSize","width","height","top","left"],l={};return Object.keys(e).forEach(o=>{t.includes(o)||(o!="rotate"?(l[o]=e[o],a.includes(o)&&(l[o]+="px")):l.transform=o+"("+e[o]+"deg)")}),l}const Qe=R({__name:"EditorComponent",props:{isEdit:{type:Boolean,default:!0}},setup(e){const t=B.editorStore,a=r=>{r.stopPropagation(),r.preventDefault();let u=r.target,m=r.offsetY,_=r.offsetX;for(;!u.className.includes("editor");)_+=u.offsetLeft,m+=u.offsetTop,u=u.parentNode;t.showContextMenu({top:m,left:_})},l=r=>{const u={...r};return u.width&&(u.width+="px"),u.height&&(u.height+="px"),u.top&&(u.top+="px"),u.left&&(u.left+="px"),u.rotate&&(u.transform="rotate("+u.rotate+"deg)"),u},o=r=>fe(r,["top","left","width","height","rotate"]),h=(r,u)=>{r.propValue=u,t.setShapeStyle({height:c(r,u)})},c=(r,u)=>{let{lineHeight:m,fontSize:_,height:n}=r.style;m===""&&(m=1.5);const d=u.split(`
`).length*m*_;return n>d?n:d};return(r,u)=>(p(),v("div",{class:G(["editor",{edit:e.isEdit}]),id:"editor",style:H({width:b(t).editorState.canvasStyleData.width+"px",height:b(t).editorState.canvasStyleData.height+"px"}),onContextmenu:a},[(p(!0),v(U,null,$(b(t).editorState.componentData,(m,_)=>(p(),k(Ge,{defaultStyle:m.style,style:H(l(m.style)),key:m.id,active:m===b(t).editorState.curComponent,element:m,index:_},{default:x(()=>[m.component!="v-text"?(p(),k(J(m.component),{key:0,class:"component",style:H(o(m.style)),propValue:m.propValue},null,8,["style","propValue"])):(p(),k(J(m.component),{key:1,class:"component",style:H(o(m.style)),propValue:m.propValue,onInput:h,element:m},null,40,["style","propValue","element"]))]),_:2},1032,["defaultStyle","style","active","element","index"]))),128)),S(Re),S(Ee)],38))}});const Ze=N(Qe,[["__scopeId","data-v-e5128159"]]),oe={redirect(e){e&&(window.location.href=e)},alert(e){e&&alert(e)}};oe.redirect,oe.alert;const et=R({__name:"ComponentWrapper",props:{config:{}},setup(e){const t=e,a=pe();ae(()=>{a.value!==void 0&&he(a.value,t.config.animations)});const l=()=>{const o=t.config.events;Object.keys(o).forEach(h=>{oe[h](o[h])})};return(o,h)=>(p(),v("div",{onClick:l,ref_key:"wrapperDom",ref:a},[(p(),k(J(o.config.component),{class:"component",style:H(b(fe)(o.config.style)),propValue:o.config.propValue},null,8,["style","propValue"]))],512))}});const tt=N(et,[["__scopeId","data-v-f6fda919"]]),ot={key:0,class:"bg"},nt={class:"canvas-container"},at=R({__name:"Preview",props:{show:{type:Boolean}},emits:["update:show"],setup(e,{emit:t}){const a=B.editorStore.editorState,l=()=>{t("update:show",!1)};return(o,h)=>{const c=L("el-button");return o.show?(p(),v("div",ot,[S(c,{onClick:l,class:"close"},{default:x(()=>[E("关闭")]),_:1}),C("div",nt,[C("div",{class:"canvas",style:H({width:b(a).canvasStyleData.width+"px",height:b(a).canvasStyleData.height+"px"})},[(p(!0),v(U,null,$(b(a).componentData,(r,u)=>(p(),k(tt,{key:u,config:r},null,8,["config"]))),128))],4)])])):A("",!0)}}});const lt=N(at,[["__scopeId","data-v-405e2576"]]),ie=e=>(be("data-v-89261d27"),e=e(),ye(),e),it={class:"toolbar"},st=ie(()=>C("label",{for:"input",class:"insert"},"插入图片",-1)),rt={class:"canvas-config"},ct=ie(()=>C("span",null,"画布大小",-1)),ut=ie(()=>C("span",null,"*",-1)),dt=R({__name:"Toolbar",setup(e){const t=B.editorStore,a=z({isShowPreview:!1}),l=()=>{t.undo()},o=()=>{t.redo()},h=_=>{const n=_.target.files[0];if(!n.type.includes("image")){ve("只能插入图片");return}const d=new FileReader;d.onload=i=>{const s=i.target.result,f=new Image;f.onload=()=>{t.addComponent({component:{id:te(),component:"v-picture",label:"图片",icon:"",propValue:s,animations:[],events:[],style:{top:0,left:0,width:f.width,height:f.height,rotate:""}},index:void 0})},f.src=s},d.readAsDataURL(n)},c=()=>{a.isShowPreview=!0,t.setEditMode("read")},r=()=>{t.setEditMode("edit")},u=()=>{localStorage.setItem("canvasData",JSON.stringify(t.editorState.componentData)),localStorage.setItem("canvasStyle",JSON.stringify(t.editorState.canvasStyleData)),ge.success("保存成功")},m=()=>{t.setComponentData([])};return(_,n)=>{const d=L("el-button");return p(),v("div",it,[S(d,{onClick:l},{default:x(()=>[E("撤消")]),_:1}),S(d,{onClick:o},{default:x(()=>[E("重做")]),_:1}),st,C("input",{type:"file",onChange:h,id:"input",hidden:""},null,32),S(d,{onClick:c,style:{"margin-left":"10px"}},{default:x(()=>[E("预览")]),_:1}),S(d,{onClick:u},{default:x(()=>[E("保存")]),_:1}),S(d,{onClick:m},{default:x(()=>[E("清空画布")]),_:1}),C("div",rt,[ct,j(C("input",{"onUpdate:modelValue":n[0]||(n[0]=i=>b(t).editorState.canvasStyleData.width=i)},null,512),[[re,b(t).editorState.canvasStyleData.width]]),ut,j(C("input",{"onUpdate:modelValue":n[1]||(n[1]=i=>b(t).editorState.canvasStyleData.height=i)},null,512),[[re,b(t).editorState.canvasStyleData.height]])]),S(lt,{show:a.isShowPreview,"onUpdate:show":n[2]||(n[2]=i=>a.isShowPreview=i),onChange:r},null,8,["show"])])}}});const pt=N(dt,[["__scopeId","data-v-89261d27"]]),de=[{label:"进入",children:[{label:"渐显",value:"fadeIn"},{label:"向右进入",value:"fadeInLeft"},{label:"向左进入",value:"fadeInRight"},{label:"向上进入",value:"fadeInUp"},{label:"向下进入",value:"fadeInDown"},{label:"向右长距进入",value:"fadeInLeftBig"},{label:"向左长距进入",value:"fadeInRightBig"},{label:"向上长距进入",value:"fadeInUpBig"},{label:"向下长距进入",value:"fadeInDownBig"},{label:"旋转进入",value:"rotateIn"},{label:"左顺时针旋转",value:"rotateInDownLeft"},{label:"右逆时针旋转",value:"rotateInDownRight"},{label:"左逆时针旋转",value:"rotateInUpLeft"},{label:"右逆时针旋转",value:"rotateInUpRight"},{label:"弹入",value:"bounceIn"},{label:"向右弹入",value:"bounceInLeft"},{label:"向左弹入",value:"bounceInRight"},{label:"向上弹入",value:"bounceInUp"},{label:"向下弹入",value:"bounceInDown"},{label:"光速从右进入",value:"lightSpeedInRight"},{label:"光速从左进入",value:"lightSpeedInLeft"},{label:"光速从右退出",value:"lightSpeedOutRight"},{label:"光速从左退出",value:"lightSpeedOutLeft"},{label:"Y轴旋转",value:"flip"},{label:"中心X轴旋转",value:"flipInX"},{label:"中心Y轴旋转",value:"flipInY"},{label:"左长半径旋转",value:"rollIn"},{label:"由小变大进入",value:"zoomIn"},{label:"左变大进入",value:"zoomInLeft"},{label:"右变大进入",value:"zoomInRight"},{label:"向上变大进入",value:"zoomInUp"},{label:"向下变大进入",value:"zoomInDown"},{label:"向右滑动展开",value:"slideInLeft"},{label:"向左滑动展开",value:"slideInRight"},{label:"向上滑动展开",value:"slideInUp"},{label:"向下滑动展开",value:"slideInDown"}]},{label:"强调",children:[{label:"弹跳",value:"bounce"},{label:"闪烁",value:"flash"},{label:"放大缩小",value:"pulse"},{label:"放大缩小弹簧",value:"rubberBand"},{label:"左右晃动",value:"headShake"},{label:"左右扇形摇摆",value:"swing"},{label:"放大晃动缩小",value:"tada"},{label:"扇形摇摆",value:"wobble"},{label:"左右上下晃动",value:"jello"},{label:"Y轴旋转",value:"flip"}]},{label:"退出",children:[{label:"渐隐",value:"fadeOut"},{label:"向左退出",value:"fadeOutLeft"},{label:"向右退出",value:"fadeOutRight"},{label:"向上退出",value:"fadeOutUp"},{label:"向下退出",value:"fadeOutDown"},{label:"向左长距退出",value:"fadeOutLeftBig"},{label:"向右长距退出",value:"fadeOutRightBig"},{label:"向上长距退出",value:"fadeOutUpBig"},{label:"向下长距退出",value:"fadeOutDownBig"},{label:"旋转退出",value:"rotateOut"},{label:"左顺时针旋转",value:"rotateOutDownLeft"},{label:"右逆时针旋转",value:"rotateOutDownRight"},{label:"左逆时针旋转",value:"rotateOutUpLeft"},{label:"右逆时针旋转",value:"rotateOutUpRight"},{label:"弹出",value:"bounceOut"},{label:"向左弹出",value:"bounceOutLeft"},{label:"向右弹出",value:"bounceOutRight"},{label:"向上弹出",value:"bounceOutUp"},{label:"向下弹出",value:"bounceOutDown"},{label:"中心X轴旋转",value:"flipOutX"},{label:"中心Y轴旋转",value:"flipOutY"},{label:"左长半径旋转",value:"rollOut"},{label:"由小变大退出",value:"zoomOut"},{label:"左变大退出",value:"zoomOutLeft"},{label:"右变大退出",value:"zoomOutRight"},{label:"向上变大退出",value:"zoomOutUp"},{label:"向下变大退出",value:"zoomOutDown"},{label:"向左滑动收起",value:"slideOutLeft"},{label:"向右滑动收起",value:"slideOutRight"},{label:"向上滑动收起",value:"slideOutUp"},{label:"向下滑动收起",value:"slideOutDown"}]}],ht={class:"animation-list"},ft={key:0,class:"div-animation"},mt={class:"el-scrollbar-view"},_t=["onMouseover","onClick"],vt=R({__name:"AnimationList",setup(e){const t=B.editorStore,a=z({isShowAnimation:!1,animationClassData:de,animationActiveName:"进入",showAnimatePanel:!1,hoverPreviewAnimate:""}),l=c=>{t.addAnimation(c),a.isShowAnimation=!1},o=()=>{X.emit("runAnimation")},h=c=>{t.removeAnimation(c)};return(c,r)=>{const u=L("el-button"),m=L("el-tag"),_=L("el-scrollbar"),n=L("el-tab-pane"),d=L("el-tabs"),i=L("Modal");return p(),v("div",ht,[b(t).editorState.curComponent?(p(),v("div",ft,[S(u,{onClick:r[0]||(r[0]=s=>{a.isShowAnimation=!0})},{default:x(()=>[E("添加动画")]),_:1}),S(u,{onClick:o},{default:x(()=>[E("预览动画")]),_:1}),C("div",null,[(p(!0),v(U,null,$(b(t).editorState.curComponent.animations,(s,f)=>(p(),k(m,{key:f,closable:"",onClose:g=>h(f)},{default:x(()=>[E(ee(s.label),1)]),_:2},1032,["onClose"]))),128))])])):A("",!0),S(i,{show:a.isShowAnimation,"onUpdate:show":r[2]||(r[2]=s=>a.isShowAnimation=s)},{default:x(()=>[S(d,{type:"card",modelValue:a.animationActiveName,"onUpdate:modelValue":r[1]||(r[1]=s=>a.animationActiveName=s)},{default:x(()=>[(p(!0),v(U,null,$(b(de),s=>(p(),k(n,{key:s.label,label:s.label,name:s.label},{default:x(()=>[S(_,{class:"animate-container"},{default:x(()=>[C("div",mt,[(p(!0),v(U,null,$(s.children,(f,g)=>(p(),v("div",{class:"animate",key:g,onMouseover:y=>a.hoverPreviewAnimate=f.value,onClick:y=>l(f)},[C("div",{class:G([a.hoverPreviewAnimate===f.value&&"animate__animated animate__"+f.value])},ee(f.label),3)],40,_t))),128))])]),_:2},1024)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["show"])])}}});const gt=N(vt,[["__scopeId","data-v-c2f72d3f"]]),bt={class:"home"},yt={class:"left"},St={class:"center"},xt={class:"right"},wt={key:1,class:"placeholder"},Ct={key:1,class:"placeholder"},Mt={key:1,class:"placeholder"},kt=R({__name:"Home",setup(e){const t=B.editorStore,a=z({activeName:"attr",reSelectAnimateIndex:void 0}),l=()=>{localStorage.getItem("canvasData")&&t.setComponentData(h(JSON.parse(localStorage.getItem("canvasData")))),localStorage.getItem("canvasStyle")&&t.setCanvasStyle(JSON.parse(localStorage.getItem("canvasStyle")))},o=()=>{let i=!1;window.onkeydown=s=>{s.keyCode==17?i=!0:i&&s.keyCode==67?t.copy():i&&s.keyCode==86?t.paste(!1):i&&s.keyCode==88&&t.cut()},window.onkeyup=s=>{s.keyCode==17&&(i=!1)}},h=m=>(m.forEach(_=>{_.id=te()}),m),c=m=>{m.preventDefault(),m.stopPropagation();const _=Se.cloneDeep(le[m.dataTransfer.getData("index")]);_.style.top=m.offsetY,_.style.left=m.offsetX,_.id=te(),t.addComponent({component:_,index:void 0}),t.recordSnapshot()},r=m=>{m.preventDefault(),m.dataTransfer.dropEffect="copy"},u=()=>{t.setCurComponent({component:null,index:null}),t.hideContextMenu()};return l(),o(),(m,_)=>{const n=L("el-tab-pane"),d=L("EventList"),i=L("el-tabs");return p(),v("div",bt,[S(pt),C("main",null,[C("section",yt,[S(De)]),C("section",St,[C("div",{class:"content",onDrop:c,onDragover:r,onClick:u},[S(Ze)],32)]),C("section",xt,[S(i,{modelValue:a.activeName,"onUpdate:modelValue":_[0]||(_[0]=s=>a.activeName=s),type:"card"},{default:x(()=>[S(n,{label:"属性",name:"attr"},{default:x(()=>[b(t).editorState.curComponent?(p(),k(Ve,{key:0})):(p(),v("p",wt,"请选择组件"))]),_:1}),S(n,{label:"动画",name:"animation"},{default:x(()=>[b(t).editorState.curComponent?(p(),k(gt,{key:0})):(p(),v("p",Ct,"请选择组件"))]),_:1}),S(n,{label:"事件",name:"events"},{default:x(()=>[b(t).editorState.curComponent?(p(),k(d,{key:0})):(p(),v("p",Mt,"请选择组件"))]),_:1})]),_:1},8,["modelValue"])])])])}}});const Dt=N(kt,[["__scopeId","data-v-af42b5d0"]]);export{Dt as default};
