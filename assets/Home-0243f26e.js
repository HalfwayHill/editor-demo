import{d as O,o as f,c as y,F as $,r as U,a as D,b as J,e as S,t as K,u as x,l as ce,_ as E,f as H,g as ie,h as I,i as w,w as C,j,k as X,m as q,v as Q,n as T,p as Z,q as Y,s as ae,x as ee,y as W,z as M,A as ue,B as oe,C as de,D as fe,E as pe,$ as _e,G as A,H as ne,I as ve,J as ge,K as le,L as be,M as ye,N as Se,O as xe,P as we,Q as Ce}from"./index-e645b730.js";const Me={class:"component-list"},Le=["data-index"],ke=O({__name:"ComponentList",setup(n){const e=o=>{o.dataTransfer.setData("index",o.target.dataset.index)};return(o,v)=>(f(),y("div",Me,[(f(!0),y($,null,U(x(ce),(s,u)=>(f(),y("div",{key:u,class:"item",draggable:"true",onDragstart:v[0]||(v[0]=d=>e(d)),"data-index":u},[(f(),D(J(s.icon),{class:"icon"})),S("span",null,K(s.label),1)],40,Le))),128))]))}});const De=E(ke,[["__scopeId","data-v-c47933ae"]]),Ie={class:"attr-list"},Pe=O({__name:"AttrList",setup(n){const e=X.editorStore,o=H({excludes:["VPicture","VGroup"],options:[{label:"左对齐",value:"left"},{label:"居中",value:"center"},{label:"右对齐",value:"right"}],map:{left:"x 坐标",top:"y 坐标",height:"高",width:"宽",color:"颜色",backgroundColor:"背景色",borderWidth:"边框宽度",borderColor:"边框颜色",borderRadius:"边框半径",fontSize:"字体大小",fontWeight:"字体粗细",lineHeight:"行高",letterSpacing:"字间距",textAlign:"对齐方式",opacity:"透明度"}}),v=ie(()=>e.editorState.curComponent?Object.keys(e.editorState.curComponent.style):[]),s=ie(()=>e.editorState.curComponent);return(u,d)=>{const p=I("el-color-picker"),c=I("el-option"),i=I("el-select"),a=I("el-input"),g=I("el-form-item"),l=I("el-form");return f(),y("div",Ie,[w(l,null,{default:C(()=>[(f(!0),y($,null,U(v.value.filter(t=>t!="rotate"),(t,r)=>(f(),D(g,{key:r,label:o.map[t]},{default:C(()=>[t=="borderColor"?(f(),D(p,{key:0,modelValue:s.value.style[t],"onUpdate:modelValue":h=>s.value.style[t]=h},null,8,["modelValue","onUpdate:modelValue"])):t=="color"?(f(),D(p,{key:1,modelValue:s.value.style[t],"onUpdate:modelValue":h=>s.value.style[t]=h},null,8,["modelValue","onUpdate:modelValue"])):t=="backgroundColor"?(f(),D(p,{key:2,modelValue:s.value.style[t],"onUpdate:modelValue":h=>s.value.style[t]=h},null,8,["modelValue","onUpdate:modelValue"])):t=="textAlign"?(f(),D(i,{key:3,modelValue:s.value.style[t],"onUpdate:modelValue":h=>s.value.style[t]=h},{default:C(()=>[(f(!0),y($,null,U(o.options,h=>(f(),D(c,{key:h.value,label:h.label,value:h.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):(f(),D(a,{key:4,type:"number",modelValue:s.value.style[t],"onUpdate:modelValue":h=>s.value.style[t]=h},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["label"]))),128)),s.value&&!o.excludes.includes(s.value.component)?(f(),D(g,{key:0,label:"内容"},{default:C(()=>[w(a,{type:"textarea",modelValue:s.value.propValue,"onUpdate:modelValue":d[0]||(d[0]=t=>s.value.propValue=t)},null,8,["modelValue"])]),_:1})):j("",!0)]),_:1})])}}});const Ve=E(Pe,[["__scopeId","data-v-8c0b3edf"]]),Ae=O({__name:"ContextMenu",setup(n){const e=X.editorStore;H({copyData:null});const o=()=>{e.setClickComponentStatus(!0)},v=()=>{e.copy()},s=()=>{e.paste(!0),e.recordSnapshot()},u=()=>{e.cut()},d=()=>{e.deleteComponent(),e.recordSnapshot()},p=()=>{e.upComponent(),e.recordSnapshot()},c=()=>{e.downComponent(),e.recordSnapshot()},i=()=>{e.topComponent(),e.recordSnapshot()},a=()=>{e.bottomComponent(),e.recordSnapshot()};return(g,l)=>q((f(),y("div",{class:"contextmenu",style:T({top:x(e).editorState.menuTop+"px",left:x(e).editorState.menuLeft+"px"})},[S("ul",{onMouseup:o},[x(e).editorState.curComponent?(f(),y($,{key:0},[S("li",{onClick:v},"复制"),S("li",{onClick:s},"粘贴"),S("li",{onClick:u},"剪切"),S("li",{onClick:d},"删除"),S("li",{onClick:i},"置顶"),S("li",{onClick:a},"置底"),S("li",{onClick:p},"上移"),S("li",{onClick:c},"下移")],64)):(f(),y("li",{key:1,onClick:s},"粘贴"))],32)],4)),[[Q,x(e).editorState.menuShow]])}});const Ne=E(Ae,[["__scopeId","data-v-13e169ce"]]),Oe={class:"mark-line"},Ee=O({__name:"MarkLine",setup(n){const e=X.editorStore,o=new Map,v=(a,g)=>{a&&o.set(g,a)},s=H({lines:["xt","xc","xb","yl","yc","yr"],diff:3,lineStatus:{xt:!1,xc:!1,xb:!1,yl:!1,yc:!1,yr:!1}});Z(()=>{Y.on("move",a=>{d(a.isDownward,a.isRightward)}),Y.on("unMove",()=>{u()})});const u=()=>{Object.keys(s.lineStatus).forEach(a=>{s.lineStatus[a]=!1})},d=(a,g)=>{const l=e.editorState.componentData,t=ae(e.editorState.curComponent.style),r=t.width/2,h=t.height/2;u(),l.forEach(b=>{if(b==e.editorState.curComponent)return;const _=ae(b.style),{top:m,left:L,bottom:k,right:P}=_,N=_.width/2,V=_.height/2,B={top:[{isNearly:i(t.top,m),lineNode:o.get("xt"),line:"xt",dragShift:m,lineShift:m},{isNearly:i(t.bottom,m),lineNode:o.get("xt"),line:"xt",dragShift:m-t.height,lineShift:m},{isNearly:i(t.top+h,m+V),lineNode:o.get("xc"),line:"xc",dragShift:m+V-h,lineShift:m+V},{isNearly:i(t.top,k),lineNode:o.get("xb"),line:"xb",dragShift:k,lineShift:k},{isNearly:i(t.bottom,k),lineNode:o.get("xb"),line:"xb",dragShift:k-t.height,lineShift:k}],left:[{isNearly:i(t.left,L),lineNode:o.get("yl"),line:"yl",dragShift:L,lineShift:L},{isNearly:i(t.right,L),lineNode:o.get("yl"),line:"yl",dragShift:L-t.width,lineShift:L},{isNearly:i(t.left+r,L+N),lineNode:o.get("yc"),line:"yc",dragShift:L+N-r,lineShift:L+N},{isNearly:i(t.left,P),lineNode:o.get("yr"),line:"yr",dragShift:P,lineShift:P},{isNearly:i(t.right,P),lineNode:o.get("yr"),line:"yr",dragShift:P-t.width,lineShift:P}]},R=[],{rotate:F}=e.editorState.curComponent.style;Object.keys(B).forEach(G=>{B[G].forEach(z=>{z.isNearly&&(e.setShapeSingleStyle({key:G,value:F!=0?p(G,z,t):z.dragShift}),z.lineNode.style[G]=`${z.lineShift}px`,R.push(z.line))})}),R.length&&c(R,a,g)})},p=(a,g,l)=>{const{width:t,height:r}=e.editorState.curComponent.style;return a=="top"?Math.round(g.dragShift-(r-l.height)/2):Math.round(g.dragShift-(t-l.width)/2)},c=(a,g,l)=>{l?a.includes("yr")?s.lineStatus.yr=!0:a.includes("yc")?s.lineStatus.yc=!0:a.includes("yl")&&(s.lineStatus.yl=!0):a.includes("yl")?s.lineStatus.yl=!0:a.includes("yc")?s.lineStatus.yc=!0:a.includes("yr")&&(s.lineStatus.yr=!0),g?a.includes("xb")?s.lineStatus.xb=!0:a.includes("xc")?s.lineStatus.xc=!0:a.includes("xt")&&(s.lineStatus.xt=!0):a.includes("xt")?s.lineStatus.xt=!0:a.includes("xc")?s.lineStatus.xc=!0:a.includes("xb")&&(s.lineStatus.xb=!0)},i=(a,g)=>Math.abs(a-g)<=s.diff;return(a,g)=>(f(),y("div",Oe,[(f(!0),y($,null,U(s.lines,l=>q((f(),y("div",{key:l,class:ee(["line",l.includes("x")?"xline":"yline"]),ref_for:!0,ref:t=>v(t,l)},null,2)),[[Q,s.lineStatus[l]||!1]])),128))]))}});const $e=E(Ee,[["__scopeId","data-v-ffbd92d2"]]);async function he(n,e=[]){if(n){const o=v=>new Promise(s=>{n.classList.add("animate__animated","animate__"+v.value);const u=()=>{n.removeEventListener("animationend",u),n.removeEventListener("animationcancel",u),n.classList.remove("animate__animated","animate__"+v.value),s()};n.addEventListener("animationend",u),n.addEventListener("animationcancel",u)});for(let v=0,s=e.length;v<s;v++)await o(e[v])}else console.log("runAnimation el为空")}const Re={lt:Ue,t:Te,rt:Be,r:He,rb:Ye,b:ze,lb:Xe,l:We};function Ue(n,e,o,v,s){const{symmetricPoint:u}=s;let d=W(e,u),p=M(e,d,-n.rotate),c=M(u,d,-n.rotate),i=c.x-p.x,a=c.y-p.y;if(v){i/a>o?(p.x+=Math.abs(i-a*o),i=a*o):(p.y+=Math.abs(a-i/o),a=i/o);const g=M(p,d,n.rotate);d=W(g,u),p=M(g,d,-n.rotate),c=M(u,d,-n.rotate),i=c.x-p.x,a=c.y-p.y}i>0&&a>0&&(n.width=Math.round(i),n.height=Math.round(a),n.left=Math.round(p.x),n.top=Math.round(p.y))}function Be(n,e,o,v,s){const{symmetricPoint:u}=s;let d=W(e,u),p=M(e,d,-n.rotate),c=M(u,d,-n.rotate),i=p.x-c.x,a=c.y-p.y;if(v){i/a>o?(p.x-=Math.abs(i-a*o),i=a*o):(p.y+=Math.abs(a-i/o),a=i/o);const g=M(p,d,n.rotate);d=W(g,u),p=M(g,d,-n.rotate),c=M(u,d,-n.rotate),i=p.x-c.x,a=c.y-p.y}i>0&&a>0&&(n.width=Math.round(i),n.height=Math.round(a),n.left=Math.round(c.x),n.top=Math.round(p.y))}function Ye(n,e,o,v,s){const{symmetricPoint:u}=s;let d=W(e,u),p=M(u,d,-n.rotate),c=M(e,d,-n.rotate),i=c.x-p.x,a=c.y-p.y;if(v){i/a>o?(c.x-=Math.abs(i-a*o),i=a*o):(c.y-=Math.abs(a-i/o),a=i/o);const g=M(c,d,n.rotate);d=W(g,u),p=M(u,d,-n.rotate),c=M(g,d,-n.rotate),i=c.x-p.x,a=c.y-p.y}i>0&&a>0&&(n.width=Math.round(i),n.height=Math.round(a),n.left=Math.round(p.x),n.top=Math.round(p.y))}function Xe(n,e,o,v,s){const{symmetricPoint:u}=s;let d=W(e,u),p=M(u,d,-n.rotate),c=M(e,d,-n.rotate),i=p.x-c.x,a=c.y-p.y;if(v){i/a>o?(c.x+=Math.abs(i-a*o),i=a*o):(c.y-=Math.abs(a-i/o),a=i/o);const g=M(c,d,n.rotate);d=W(g,u),p=M(u,d,-n.rotate),c=M(g,d,-n.rotate),i=p.x-c.x,a=c.y-p.y}i>0&&a>0&&(n.width=Math.round(i),n.height=Math.round(a),n.left=Math.round(c.x),n.top=Math.round(p.y))}function Te(n,e,o,v,s){const{symmetricPoint:u,curPoint:d}=s,p=M(e,d,-n.rotate),c=M({x:d.x,y:p.y},d,n.rotate),i=Math.sqrt((c.x-u.x)**2+(c.y-u.y)**2);if(i>0){const a={x:c.x-(c.x-u.x)/2,y:c.y+(u.y-c.y)/2};let g=n.width;v&&(g=i*o),n.width=g,n.height=Math.round(i),n.top=Math.round(a.y-i/2),n.left=Math.round(a.x-n.width/2)}}function He(n,e,o,v,s){const{symmetricPoint:u,curPoint:d}=s,p=M(e,d,-n.rotate),c=M({x:p.x,y:d.y},d,n.rotate),i=Math.sqrt((c.x-u.x)**2+(c.y-u.y)**2);if(i>0){const a={x:c.x-(c.x-u.x)/2,y:c.y+(u.y-c.y)/2};let g=n.height;v&&(g=i/o),n.height=g,n.width=Math.round(i),n.top=Math.round(a.y-n.height/2),n.left=Math.round(a.x-i/2)}}function ze(n,e,o,v,s){const{symmetricPoint:u,curPoint:d}=s,p=M(e,d,-n.rotate),c=M({x:d.x,y:p.y},d,n.rotate),i=Math.sqrt((c.x-u.x)**2+(c.y-u.y)**2);if(i>0){const a={x:c.x-(c.x-u.x)/2,y:c.y+(u.y-c.y)/2};let g=n.width;v&&(g=i*o),n.width=g,n.height=Math.round(i),n.top=Math.round(a.y-i/2),n.left=Math.round(a.x-n.width/2)}}function We(n,e,o,v,s){const{symmetricPoint:u,curPoint:d}=s,p=M(e,d,-n.rotate),c=M({x:p.x,y:d.y},d,n.rotate),i=Math.sqrt((c.x-u.x)**2+(c.y-u.y)**2);if(i>0){const a={x:c.x-(c.x-u.x)/2,y:c.y+(u.y-c.y)/2};let g=n.height;v&&(g=i/o),n.height=g,n.width=Math.round(i),n.top=Math.round(a.y-n.height/2),n.left=Math.round(a.x-i/2)}}function je(n,e,o,v,s,u){Re[n](e,o,v,s,u)}const qe=["onMousedown"],Ge=O({__name:"ShapeComponent",props:{active:{type:Boolean,default:!1},element:{require:!0,type:Object},defaultStyle:{require:!0,type:Object},index:{require:!0,type:[Number,String]}},setup(n){const e=n,o=X.editorStore,v=ue(),s=H({pointList:["lt","t","rt","r","rb","b","lb","l"],initialAngle:{lt:0,t:45,rt:90,r:135,rb:180,b:225,lb:270,l:315},angleToCursor:[{start:338,end:23,cursor:"nw"},{start:23,end:68,cursor:"n"},{start:68,end:113,cursor:"ne"},{start:113,end:158,cursor:"e"},{start:158,end:203,cursor:"se"},{start:203,end:248,cursor:"s"},{start:248,end:293,cursor:"sw"},{start:293,end:338,cursor:"w"}],cursors:{}});Z(()=>{o.editorState.curComponent&&(s.cursors=p()),Y.on("runAnimation",()=>{e.element===o.getCurComponent&&v.value!==void 0&&he(v.value,o.getCurComponent.animations)})});const u=l=>{var B;o.setClickComponentStatus(!0),l.preventDefault(),l.stopPropagation();const t={...e.defaultStyle},r=l.clientY,h=l.clientX,b=t.rotate,_=(B=v.value)==null?void 0:B.getBoundingClientRect(),m=(_==null?void 0:_.left)+(_==null?void 0:_.width)/2,L=(_==null?void 0:_.top)+(_==null?void 0:_.height)/2,k=Math.atan2(r-L,h-m)/(Math.PI/180);let P=!1;const N=R=>{P=!0;const F=R.clientX,G=R.clientY,z=Math.atan2(G-L,F-m)/(Math.PI/180);t.rotate=b+z-k,o.setShapeStyle(t)},V=()=>{P&&o.recordSnapshot(),document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",V),s.cursors=p()};document.addEventListener("mousemove",N),document.addEventListener("mouseup",V)},d=l=>{var N,V;const t=(N=e.defaultStyle)==null?void 0:N.height,r=(V=e.defaultStyle)==null?void 0:V.width,h=/t/.test(l),b=/b/.test(l),_=/l/.test(l),m=/r/.test(l);let L=0,k=0;return l.length===2?(L=_?0:r,k=h?0:t):((h||b)&&(L=r/2,k=h?0:t),(_||m)&&(L=_?0:r,k=Math.floor(t/2))),{marginLeft:"-4px",marginTop:"-4px",left:`${L}px`,top:`${k}px`,cursor:s.cursors[l]}},p=()=>{const l=oe(o.editorState.curComponent.style.rotate),t={};let r=-1;return s.pointList.forEach(h=>{const b=oe(s.initialAngle[h]+l),_=s.angleToCursor.length;for(;;){r=(r+1)%_;const m=s.angleToCursor[r];if(b<23||b>=338){t[h]="nw-resize";return}if(m.start<=b&&b<m.end){t[h]=m.cursor+"-resize";return}}}),t},c=l=>{var P,N;o.setClickComponentStatus(!0),((P=e.element)==null?void 0:P.component)!="v-text"&&((N=e.element)==null?void 0:N.component)!="rect-shape"&&l.preventDefault(),l.stopPropagation(),o.setCurComponent({component:e.element,index:e.index}),s.cursors=p();const t={...e.defaultStyle},r=l.clientY,h=l.clientX,b=Number(t.top),_=Number(t.left);let m=!1;const L=V=>{m=!0;const B=V.clientX,R=V.clientY;t.top=R-r+b,t.left=B-h+_,o.setShapeStyle(t),fe(()=>{Y.emit("move",{isDownward:R-r>0,isRightward:B-h>0})})},k=()=>{m&&o.recordSnapshot(),Y.emit("unMove"),document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",k)};document.addEventListener("mousemove",L),document.addEventListener("mouseup",k)},i=l=>{l.stopPropagation(),l.preventDefault(),o.hideContextMenu()},a=(l,t)=>{o.setClickComponentStatus(!0),t.stopPropagation(),t.preventDefault();const r={...e.defaultStyle},h=r.width/r.height,b={x:r.left+r.width/2,y:r.top+r.height/2},_=o.editorState.editor.getBoundingClientRect(),m={x:t.clientX-(_==null?void 0:_.left),y:t.clientY-(_==null?void 0:_.top)},L={x:b.x-(m.x-b.x),y:b.y-(m.y-b.y)};let k=!1,P=!0;const N=g(),V=R=>{if(P){P=!1;return}k=!0;const F={x:R.clientX-(_==null?void 0:_.left),y:R.clientY-(_==null?void 0:_.top)};je(l,r,F,h,N,{center:b,curPoint:m,symmetricPoint:L}),o.setShapeStyle(r)},B=()=>{document.removeEventListener("mousemove",V),document.removeEventListener("mouseup",B),k&&o.recordSnapshot()};document.addEventListener("mousemove",V),document.addEventListener("mouseup",B)},g=()=>{var t;if(((t=e.element)==null?void 0:t.component)!="Group")return!1;const l=[0,90,180,360];for(const r of e.element.propValue)if(!l.includes(oe(parseInt(r.style.rotate))))return!0;return!1};return(l,t)=>{const r=I("RefreshRight"),h=I("el-icon");return f(),y("div",{ref_key:"thisRef",ref:v,class:ee(["shape",{active:n.active}]),onClick:i,onMousedown:c},[q(w(h,{class:"el-icon-refresh-right",onMousedown:u},{default:C(()=>[w(r)]),_:1},512),[[Q,n.active]]),(f(!0),y($,null,U(n.active?s.pointList:[],b=>(f(),y("div",{class:"shape-point",onMousedown:_=>a(b,_),key:b,style:T(d(b))},null,44,qe))),128)),de(l.$slots,"default",{},void 0,!0)],34)}}});const Fe=E(Ge,[["__scopeId","data-v-ab9dc583"]]),Je=O({__name:"AreaComponent",props:{start:{type:Object},width:{type:Number},height:{type:Number}},setup(n){return(e,o)=>(f(),y("div",{style:T({left:n.start.x+"px",top:n.start.y+"px",width:n.width+"px",height:n.height+"px"}),class:"area"},null,4))}});const Ke=E(Je,[["__scopeId","data-v-b92f54dd"]]),Qe=O({__name:"EditorComponent",props:{isEdit:{type:Boolean,default:!0}},setup(n){const e=H({editorX:0,editorY:0,start:{x:0,y:0},width:0,height:0,isShowArea:!1}),o=X.editorStore;Z(()=>{o.getEditor();const l=o.editorState.editor.getBoundingClientRect();e.editorX=l.x,e.editorY=l.y,Y.on("hideArea",()=>{s()})});const v=l=>{const t=o.editorState.curComponent;(!t||t.component!="v-text"&&t.component!="rect-shape")&&l.preventDefault(),s();const r=l.clientX,h=l.clientY;e.start.x=r-e.editorX,e.start.y=h-e.editorY,e.isShowArea=!0;const b=m=>{e.width=Math.abs(m.clientX-r),e.height=Math.abs(m.clientY-h),m.clientX<r&&(e.start.x=m.clientX-e.editorX),m.clientY<h&&(e.start.y=m.clientY-e.editorY)},_=m=>{if(document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",_),m.clientX==r&&m.clientY==h){s();return}u()};document.addEventListener("mousemove",b),document.addEventListener("mouseup",_)},s=()=>{e.isShowArea=!1,e.width=0,e.height=0},u=()=>{const l=d();if(l.length<=1){s();return}let t=1/0,r=1/0,h=-1/0,b=-1/0;l.forEach(_=>{let m={};_.component=="VGroup"?_.propValue.forEach(L=>{const k=_e(`#component${L.id}`).getBoundingClientRect();m.left=k.left-e.editorX,m.top=k.top-e.editorY,m.right=k.right-e.editorX,m.bottom=k.bottom-e.editorY,m.left<r&&(r=m.left),m.top<t&&(t=m.top),m.right>h&&(h=m.right),m.bottom>b&&(b=m.bottom)}):m=ae(_.style),m.left<r&&(r=m.left),m.top<t&&(t=m.top),m.right>h&&(h=m.right),m.bottom>b&&(b=m.bottom)}),e.start.x=r,e.start.y=t,e.width=h-r,e.height=b-t,o.setAreaData({style:{left:r,top:t,width:e.width,height:e.height},components:l})},d=()=>{const l=[],{x:t,y:r}=e.start;return o.editorState.componentData.forEach(h=>{const{left:b,top:_,width:m,height:L}=h.style;t<=b&&r<=_&&b+m<=t+e.width&&_+L<=r+e.height&&l.push(h)}),l},p=l=>{l.stopPropagation(),l.preventDefault();let t=l.target,r=l.offsetY,h=l.offsetX;for(;!t.className.includes("editor");)h+=t.offsetLeft,r+=t.offsetTop,t=t.parentNode;o.showContextMenu({top:r,left:h})},c=l=>{const t={};return["width","height","top","left","rotate"].forEach(r=>{r!="rotate"?t[r]=l[r]+"px":t.transform="rotate("+l[r]+"deg)"}),t},i=l=>pe(l,["top","left","width","height","rotate"]),a=(l,t)=>{o.setShapeStyle({height:g(l,t)})},g=(l,t)=>{let{lineHeight:r,fontSize:h,height:b}=l.style;r===""&&(r=1.5);const _=(t.split("<br>").length-1)*r*h;return b>_?b:_};return(l,t)=>(f(),y("div",{class:ee(["editor",{edit:n.isEdit}]),id:"editor",style:T({width:x(o).editorState.canvasStyleData.width+"px",height:x(o).editorState.canvasStyleData.height+"px",transform:"scale("+x(o).editorState.canvasStyleData.scale/100+")"}),onContextmenu:p,onMousedown:v},[(f(!0),y($,null,U(x(o).editorState.componentData,(r,h)=>(f(),D(Fe,{defaultStyle:r.style,style:T(c(r.style)),key:r.id,active:r===x(o).editorState.curComponent,element:r,index:h},{default:C(()=>[r.component!="v-text"?(f(),D(J(r.component),{key:0,class:"component",style:T(i(r.style)),propValue:r.propValue,element:r,id:"component"+r.id},null,8,["style","propValue","element","id"])):(f(),D(J(r.component),{key:1,class:"component",style:T(i(r.style)),propValue:r.propValue,onInput:a,element:r,id:"component"+r.id},null,40,["style","propValue","element","id"]))]),_:2},1032,["defaultStyle","style","active","element","index"]))),128)),w(Ne),w($e),q(w(Ke,{start:e.start,width:e.width,height:e.height},null,8,["start","width","height"]),[[Q,e.isShowArea]])],38))}});const Ze=E(Qe,[["__scopeId","data-v-bcd743d2"]]),se={redirect(n){n&&(window.location.href=n)},alert(n){n&&alert(n)}},et=[{key:"redirect",label:"跳转事件",event:se.redirect,param:""},{key:"alert",label:"alert 事件",event:se.alert,param:""}],tt=O({__name:"ComponentWrapper",props:{config:{}},setup(n){const e=n,o=ue();Z(()=>{o.value!==void 0&&he(o.value,e.config.animations)});const v=()=>{const s=e.config.events;Object.keys(s).forEach(u=>{se[u](s[u])})};return(s,u)=>(f(),y("div",{onClick:v,ref_key:"wrapperDom",ref:o},[(f(),D(J(s.config.component),{class:"component",style:T(x(pe)(s.config.style)),propValue:s.config.propValue,element:s.config},null,8,["style","propValue","element"]))],512))}});const ot=E(tt,[["__scopeId","data-v-f9a224a7"]]),nt={key:0,class:"bg"},at={class:"canvas-container"},lt=O({__name:"Preview",props:{show:{type:Boolean}},emits:["update:show"],setup(n,{emit:e}){const o=X.editorStore.editorState,v=()=>{e("update:show",!1)};return(s,u)=>{const d=I("el-button");return s.show?(f(),y("div",nt,[w(d,{onClick:v,class:"close"},{default:C(()=>[A("关闭")]),_:1}),S("div",at,[S("div",{class:"canvas",style:T({width:x(o).canvasStyleData.width+"px",height:x(o).canvasStyleData.height+"px",transform:"scale("+x(o).canvasStyleData.scale/100+")"})},[(f(!0),y($,null,U(x(o).componentData,(p,c)=>(f(),D(ot,{key:c,config:p},null,8,["config"]))),128))],4)])])):j("",!0)}}});const st=E(lt,[["__scopeId","data-v-5b8d6646"]]),te=n=>(Se("data-v-cfbbd917"),n=n(),xe(),n),it={class:"toolbar"},rt=te(()=>S("label",{for:"input",class:"insert"},"插入图片",-1)),ct={class:"canvas-config"},ut=te(()=>S("span",null,"画布大小",-1)),dt=te(()=>S("span",null,"*",-1)),pt={class:"canvas-config"},ht=te(()=>S("span",null,"画布比例",-1)),mt=O({__name:"Toolbar",setup(n){const e=X.editorStore,o=H({isShowPreview:!1}),v=()=>{e.compose(),e.recordSnapshot()},s=()=>{e.decompose(),e.recordSnapshot()},u=()=>{e.undo()},d=()=>{e.redo()},p=l=>{const t=l.target.files[0];if(!t.type.includes("image")){ve("只能插入图片");return}const r=new FileReader;r.onload=h=>{const b=h.target.result,_=new Image;_.onload=()=>{e.addComponent({component:{...ge,id:le(),component:"v-picture",label:"图片",icon:"",propValue:b,style:{...be,top:0,left:0,width:_.width,height:_.height}},index:void 0})},_.src=b},r.readAsDataURL(t)},c=()=>{o.isShowPreview=!0,e.setEditMode("preview")},i=()=>{e.setEditMode("edit")},a=()=>{localStorage.setItem("canvasData",JSON.stringify(e.editorState.componentData)),localStorage.setItem("canvasStyle",JSON.stringify(e.editorState.canvasStyleData)),ye.success("保存成功")},g=()=>{e.setComponentData([]),e.recordSnapshot()};return Y.on("preview",c),Y.on("save",a),Y.on("clearCanvas",g),(l,t)=>{const r=I("el-button");return f(),y("div",null,[S("div",it,[w(r,{onClick:u},{default:C(()=>[A("撤消")]),_:1}),w(r,{onClick:d},{default:C(()=>[A("重做")]),_:1}),rt,S("input",{type:"file",onChange:p,id:"input",hidden:""},null,32),w(r,{onClick:c,style:{"margin-left":"10px"}},{default:C(()=>[A("预览")]),_:1}),w(r,{onClick:a},{default:C(()=>[A("保存")]),_:1}),w(r,{onClick:g},{default:C(()=>[A("清空画布")]),_:1}),w(r,{onClick:v,disabled:!x(e).editorState.areaData.components.length},{default:C(()=>[A("组合")]),_:1},8,["disabled"]),w(r,{onClick:s,disabled:!x(e).editorState.curComponent||x(e).editorState.curComponent.component!="VGroup"},{default:C(()=>[A("拆分")]),_:1},8,["disabled"]),S("div",ct,[ut,q(S("input",{"onUpdate:modelValue":t[0]||(t[0]=h=>x(e).editorState.canvasStyleData.width=h)},null,512),[[ne,x(e).editorState.canvasStyleData.width]]),dt,q(S("input",{"onUpdate:modelValue":t[1]||(t[1]=h=>x(e).editorState.canvasStyleData.height=h)},null,512),[[ne,x(e).editorState.canvasStyleData.height]])]),S("div",pt,[ht,q(S("input",{"onUpdate:modelValue":t[2]||(t[2]=h=>x(e).editorState.canvasStyleData.scale=h)},null,512),[[ne,x(e).editorState.canvasStyleData.scale]]),A(" % ")])]),w(st,{show:o.isShowPreview,"onUpdate:show":t[3]||(t[3]=h=>o.isShowPreview=h),onChange:i},null,8,["show"])])}}});const ft=E(mt,[["__scopeId","data-v-cfbbd917"]]),re=[{label:"进入",children:[{label:"渐显",value:"fadeIn"},{label:"向右进入",value:"fadeInLeft"},{label:"向左进入",value:"fadeInRight"},{label:"向上进入",value:"fadeInUp"},{label:"向下进入",value:"fadeInDown"},{label:"向右长距进入",value:"fadeInLeftBig"},{label:"向左长距进入",value:"fadeInRightBig"},{label:"向上长距进入",value:"fadeInUpBig"},{label:"向下长距进入",value:"fadeInDownBig"},{label:"旋转进入",value:"rotateIn"},{label:"左顺时针旋转",value:"rotateInDownLeft"},{label:"右逆时针旋转",value:"rotateInDownRight"},{label:"左逆时针旋转",value:"rotateInUpLeft"},{label:"右逆时针旋转",value:"rotateInUpRight"},{label:"弹入",value:"bounceIn"},{label:"向右弹入",value:"bounceInLeft"},{label:"向左弹入",value:"bounceInRight"},{label:"向上弹入",value:"bounceInUp"},{label:"向下弹入",value:"bounceInDown"},{label:"光速从右进入",value:"lightSpeedInRight"},{label:"光速从左进入",value:"lightSpeedInLeft"},{label:"光速从右退出",value:"lightSpeedOutRight"},{label:"光速从左退出",value:"lightSpeedOutLeft"},{label:"Y轴旋转",value:"flip"},{label:"中心X轴旋转",value:"flipInX"},{label:"中心Y轴旋转",value:"flipInY"},{label:"左长半径旋转",value:"rollIn"},{label:"由小变大进入",value:"zoomIn"},{label:"左变大进入",value:"zoomInLeft"},{label:"右变大进入",value:"zoomInRight"},{label:"向上变大进入",value:"zoomInUp"},{label:"向下变大进入",value:"zoomInDown"},{label:"向右滑动展开",value:"slideInLeft"},{label:"向左滑动展开",value:"slideInRight"},{label:"向上滑动展开",value:"slideInUp"},{label:"向下滑动展开",value:"slideInDown"}]},{label:"强调",children:[{label:"弹跳",value:"bounce"},{label:"闪烁",value:"flash"},{label:"放大缩小",value:"pulse"},{label:"放大缩小弹簧",value:"rubberBand"},{label:"左右晃动",value:"headShake"},{label:"左右扇形摇摆",value:"swing"},{label:"放大晃动缩小",value:"tada"},{label:"扇形摇摆",value:"wobble"},{label:"左右上下晃动",value:"jello"},{label:"Y轴旋转",value:"flip"}]},{label:"退出",children:[{label:"渐隐",value:"fadeOut"},{label:"向左退出",value:"fadeOutLeft"},{label:"向右退出",value:"fadeOutRight"},{label:"向上退出",value:"fadeOutUp"},{label:"向下退出",value:"fadeOutDown"},{label:"向左长距退出",value:"fadeOutLeftBig"},{label:"向右长距退出",value:"fadeOutRightBig"},{label:"向上长距退出",value:"fadeOutUpBig"},{label:"向下长距退出",value:"fadeOutDownBig"},{label:"旋转退出",value:"rotateOut"},{label:"左顺时针旋转",value:"rotateOutDownLeft"},{label:"右逆时针旋转",value:"rotateOutDownRight"},{label:"左逆时针旋转",value:"rotateOutUpLeft"},{label:"右逆时针旋转",value:"rotateOutUpRight"},{label:"弹出",value:"bounceOut"},{label:"向左弹出",value:"bounceOutLeft"},{label:"向右弹出",value:"bounceOutRight"},{label:"向上弹出",value:"bounceOutUp"},{label:"向下弹出",value:"bounceOutDown"},{label:"中心X轴旋转",value:"flipOutX"},{label:"中心Y轴旋转",value:"flipOutY"},{label:"左长半径旋转",value:"rollOut"},{label:"由小变大退出",value:"zoomOut"},{label:"左变大退出",value:"zoomOutLeft"},{label:"右变大退出",value:"zoomOutRight"},{label:"向上变大退出",value:"zoomOutUp"},{label:"向下变大退出",value:"zoomOutDown"},{label:"向左滑动收起",value:"slideOutLeft"},{label:"向右滑动收起",value:"slideOutRight"},{label:"向上滑动收起",value:"slideOutUp"},{label:"向下滑动收起",value:"slideOutDown"}]}],_t=O({__name:"Modal",props:{show:{type:Boolean}},emits:["update:show"],setup(n,{emit:e}){const o=()=>{e("update:show")},v=s=>{s.stopPropagation()};return(s,u)=>s.show?(f(),y("div",{key:0,class:"modal-bg",onClick:o},[S("div",{class:"fadeInLeft animated modal",onClick:v},[de(s.$slots,"default",{},void 0,!0)])])):j("",!0)}});const me=E(_t,[["__scopeId","data-v-b4747281"]]),vt={class:"animation-list"},gt={key:0,class:"div-animation"},bt={class:"el-scrollbar-view"},yt=["onMouseover","onClick"],St=O({__name:"AnimationList",setup(n){const e=X.editorStore,o=H({isShowAnimation:!1,animationClassData:re,animationActiveName:"进入",showAnimatePanel:!1,hoverPreviewAnimate:""}),v=d=>{e.addAnimation(d),o.isShowAnimation=!1},s=()=>{Y.emit("runAnimation")},u=d=>{e.removeAnimation(d)};return(d,p)=>{const c=I("el-button"),i=I("el-tag"),a=I("el-scrollbar"),g=I("el-tab-pane"),l=I("el-tabs");return f(),y("div",vt,[x(e).editorState.curComponent?(f(),y("div",gt,[w(c,{onClick:p[0]||(p[0]=t=>{o.isShowAnimation=!0})},{default:C(()=>[A("添加动画")]),_:1}),w(c,{onClick:s},{default:C(()=>[A("预览动画")]),_:1}),S("div",null,[(f(!0),y($,null,U(x(e).editorState.curComponent.animations,(t,r)=>(f(),D(i,{key:r,closable:"",onClose:h=>u(r)},{default:C(()=>[A(K(t.label),1)]),_:2},1032,["onClose"]))),128))])])):j("",!0),w(me,{show:o.isShowAnimation,"onUpdate:show":p[2]||(p[2]=t=>o.isShowAnimation=t)},{default:C(()=>[w(l,{type:"card",modelValue:o.animationActiveName,"onUpdate:modelValue":p[1]||(p[1]=t=>o.animationActiveName=t)},{default:C(()=>[(f(!0),y($,null,U(x(re),t=>(f(),D(g,{key:t.label,label:t.label,name:t.label},{default:C(()=>[w(a,{class:"animate-container"},{default:C(()=>[S("div",bt,[(f(!0),y($,null,U(t.children,(r,h)=>(f(),y("div",{class:"animate",key:h,onMouseover:b=>o.hoverPreviewAnimate=r.value,onClick:b=>v(r)},[S("div",{class:ee([o.hoverPreviewAnimate===r.value&&"animate__animated animate__"+r.value])},K(r.label),3)],40,yt))),128))])]),_:2},1024)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["show"])])}}});const xt=E(St,[["__scopeId","data-v-41b1b119"]]),wt={class:"event-list"},Ct={key:0,class:"div-events"},Mt=O({__name:"EventList",setup(n){const e=X.editorStore,o=H({isShowEvent:!1,eventURL:"",eventActiveName:"redirect",eventList:et}),v=(u,d)=>{o.isShowEvent=!1,e.addEvent({event:u,param:d})},s=u=>{e.removeEvent(u)};return(u,d)=>{const p=I("el-button"),c=I("el-tag"),i=I("el-input"),a=I("el-tab-pane"),g=I("el-tabs");return f(),y("div",wt,[x(e).editorState.curComponent?(f(),y("div",Ct,[w(p,{onClick:d[0]||(d[0]=l=>o.isShowEvent=!0)},{default:C(()=>[A("添加事件")]),_:1}),S("div",null,[(f(!0),y($,null,U(Object.keys(x(e).editorState.curComponent.events),l=>(f(),D(c,{key:l,closable:"",onClose:t=>s(l)},{default:C(()=>[A(K(l),1)]),_:2},1032,["onClose"]))),128))])])):j("",!0),w(me,{show:o.isShowEvent,"onUpdate:show":d[2]||(d[2]=l=>o.isShowEvent=l)},{default:C(()=>[w(g,{type:"card",modelValue:o.eventActiveName,"onUpdate:modelValue":d[1]||(d[1]=l=>o.eventActiveName=l)},{default:C(()=>[(f(!0),y($,null,U(o.eventList,l=>(f(),D(a,{key:l.key,label:l.label,name:l.key,style:{padding:"0 20px"}},{default:C(()=>[l.key=="redirect"?(f(),D(i,{key:0,modelValue:l.param,"onUpdate:modelValue":t=>l.param=t,type:"textarea",placeholder:"请输入完整的 URL"},null,8,["modelValue","onUpdate:modelValue"])):j("",!0),l.key=="alert"?(f(),D(i,{key:1,modelValue:l.param,"onUpdate:modelValue":t=>l.param=t,type:"textarea",placeholder:"请输入要 alert 的内容"},null,8,["modelValue","onUpdate:modelValue"])):j("",!0),w(p,{style:{"margin-top":"20px"},onClick:t=>v(l.key,l.param)},{default:C(()=>[A("确定")]),_:2},1032,["onClick"])]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["show"])])}}});const Lt=E(Mt,[["__scopeId","data-v-03af1cf7"]]),kt={class:"home"},Dt={class:"left"},It={class:"center"},Pt={class:"right"},Vt={key:1,class:"placeholder"},At={key:1,class:"placeholder"},Nt={key:1,class:"placeholder"},Ot=O({__name:"Home",setup(n){const e=X.editorStore,o=H({activeName:"attr",reSelectAnimateIndex:void 0}),v=()=>{localStorage.getItem("canvasData")&&e.setComponentData(s(JSON.parse(localStorage.getItem("canvasData")))),localStorage.getItem("canvasStyle")&&e.setCanvasStyle(JSON.parse(localStorage.getItem("canvasStyle")))},s=i=>(i.forEach(a=>{a.id=le()}),i),u=i=>{i.preventDefault(),i.stopPropagation();const a=Ce.cloneDeep(ce[i.dataTransfer.getData("index")]);a.style.top=i.offsetY,a.style.left=i.offsetX,a.id=le(),e.addComponent({component:a,index:void 0}),e.recordSnapshot()},d=i=>{i.preventDefault(),i.dataTransfer.dropEffect="copy"},p=()=>{e.setClickComponentStatus(!1)},c=i=>{e.editorState.isClickComponent||e.setCurComponent({component:null,index:null}),i.button!=2&&e.hideContextMenu()};return v(),we(),(i,a)=>{const g=I("el-tab-pane"),l=I("el-tabs");return f(),y("div",kt,[w(ft),S("main",null,[S("section",Dt,[w(De)]),S("section",It,[S("div",{class:"content",onDrop:u,onDragover:d,onMousedown:p,onMouseup:c},[w(Ze)],32)]),S("section",Pt,[w(l,{modelValue:o.activeName,"onUpdate:modelValue":a[0]||(a[0]=t=>o.activeName=t),type:"card"},{default:C(()=>[w(g,{label:"属性",name:"attr"},{default:C(()=>[x(e).editorState.curComponent?(f(),D(Ve,{key:0})):(f(),y("p",Vt,"请选择组件"))]),_:1}),w(g,{label:"动画",name:"animation"},{default:C(()=>[x(e).editorState.curComponent?(f(),D(xt,{key:0})):(f(),y("p",At,"请选择组件"))]),_:1}),w(g,{label:"事件",name:"events"},{default:C(()=>[x(e).editorState.curComponent?(f(),D(Lt,{key:0})):(f(),y("p",Nt,"请选择组件"))]),_:1})]),_:1},8,["modelValue"])])])])}}});const $t=E(Ot,[["__scopeId","data-v-7076e16c"]]);export{$t as default};
