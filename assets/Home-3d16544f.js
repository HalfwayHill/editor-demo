import{d as O,o as m,c as b,F as $,r as U,a as k,b as G,e as S,t as J,u as x,l as re,_ as E,f as T,g as se,h as D,i as w,w as C,j as W,k as Y,m as K,v as Q,n as X,p as Z,q as j,s as ne,x as ee,y as z,z as M,A as ce,B as ue,C as me,D as de,E as A,G as oe,H as fe,I as _e,J as ae,K as ve,L as ye,M as ge,N as be,O as Se}from"./index-eceb4a64.js";const xe={class:"component-list"},we=["data-index"],Ce=O({__name:"ComponentList",setup(n){const e=o=>{o.dataTransfer.setData("index",o.target.dataset.index)};return(o,f)=>(m(),b("div",xe,[(m(!0),b($,null,U(x(re),(i,u)=>(m(),b("div",{key:u,class:"item",draggable:"true",onDragstart:f[0]||(f[0]=d=>e(d)),"data-index":u},[(m(),k(G(i.icon),{class:"icon"})),S("span",null,J(i.label),1)],40,we))),128))]))}});const Me=E(Ce,[["__scopeId","data-v-c47933ae"]]),Le={class:"attr-list"},ke=O({__name:"AttrList",setup(n){const e=Y.editorStore,o=T({excludes:["VPicture","VGroup"],options:[{label:"左对齐",value:"left"},{label:"居中",value:"center"},{label:"右对齐",value:"right"}],map:{left:"x 坐标",top:"y 坐标",height:"高",width:"宽",color:"颜色",backgroundColor:"背景色",borderWidth:"边框宽度",borderColor:"边框颜色",borderRadius:"边框半径",fontSize:"字体大小",fontWeight:"字体粗细",lineHeight:"行高",letterSpacing:"字间距",textAlign:"对齐方式",opacity:"透明度"}}),f=se(()=>e.editorState.curComponent?Object.keys(e.editorState.curComponent.style):[]),i=se(()=>e.editorState.curComponent);return(u,d)=>{const p=D("el-color-picker"),c=D("el-option"),r=D("el-select"),l=D("el-input"),v=D("el-form-item"),s=D("el-form");return m(),b("div",Le,[w(s,null,{default:C(()=>[(m(!0),b($,null,U(f.value.filter(t=>t!="rotate"),(t,a)=>(m(),k(v,{key:a,label:o.map[t]},{default:C(()=>[t=="borderColor"?(m(),k(p,{key:0,modelValue:i.value.style[t],"onUpdate:modelValue":h=>i.value.style[t]=h},null,8,["modelValue","onUpdate:modelValue"])):t=="color"?(m(),k(p,{key:1,modelValue:i.value.style[t],"onUpdate:modelValue":h=>i.value.style[t]=h},null,8,["modelValue","onUpdate:modelValue"])):t=="backgroundColor"?(m(),k(p,{key:2,modelValue:i.value.style[t],"onUpdate:modelValue":h=>i.value.style[t]=h},null,8,["modelValue","onUpdate:modelValue"])):t=="textAlign"?(m(),k(r,{key:3,modelValue:i.value.style[t],"onUpdate:modelValue":h=>i.value.style[t]=h},{default:C(()=>[(m(!0),b($,null,U(o.options,h=>(m(),k(c,{key:h.value,label:h.label,value:h.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):(m(),k(l,{key:4,type:"number",modelValue:i.value.style[t],"onUpdate:modelValue":h=>i.value.style[t]=h},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["label"]))),128)),i.value&&!o.excludes.includes(i.value.component)?(m(),k(v,{key:0,label:"内容"},{default:C(()=>[w(l,{type:"textarea",modelValue:i.value.propValue,"onUpdate:modelValue":d[0]||(d[0]=t=>i.value.propValue=t)},null,8,["modelValue"])]),_:1})):W("",!0)]),_:1})])}}});const De=E(ke,[["__scopeId","data-v-8c0b3edf"]]),Pe=O({__name:"ContextMenu",setup(n){const e=Y.editorStore;T({copyData:null});const o=()=>{e.copy()},f=()=>{e.paste(!0),e.recordSnapshot()},i=()=>{e.cut()},u=()=>{e.deleteComponent(),e.recordSnapshot()},d=()=>{e.upComponent(),e.recordSnapshot()},p=()=>{e.downComponent(),e.recordSnapshot()},c=()=>{e.topComponent(),e.recordSnapshot()},r=()=>{e.bottomComponent(),e.recordSnapshot()};return(l,v)=>K((m(),b("div",{class:"contextmenu",style:X({top:x(e).editorState.menuTop+"px",left:x(e).editorState.menuLeft+"px"})},[S("ul",null,[x(e).editorState.curComponent?(m(),b($,{key:0},[S("li",{onClick:o},"复制"),S("li",{onClick:f},"粘贴"),S("li",{onClick:i},"剪切"),S("li",{onClick:u},"删除"),S("li",{onClick:c},"置顶"),S("li",{onClick:r},"置底"),S("li",{onClick:d},"上移"),S("li",{onClick:p},"下移")],64)):(m(),b("li",{key:1,onClick:f},"粘贴"))])],4)),[[Q,x(e).editorState.menuShow]])}});const Ie=E(Pe,[["__scopeId","data-v-a4cd2f9f"]]),Ve={class:"mark-line"},Ae=O({__name:"MarkLine",setup(n){const e=Y.editorStore,o=new Map,f=(l,v)=>{l&&o.set(v,l)},i=T({lines:["xt","xc","xb","yl","yc","yr"],diff:3,lineStatus:{xt:!1,xc:!1,xb:!1,yl:!1,yc:!1,yr:!1}});Z(()=>{j.on("move",l=>{d(l.isDownward,l.isRightward)}),j.on("unMove",()=>{u()})});const u=()=>{Object.keys(i.lineStatus).forEach(l=>{i.lineStatus[l]=!1})},d=(l,v)=>{const s=e.editorState.componentData,t=ne(e.editorState.curComponent.style),a=t.width/2,h=t.height/2;u(),s.forEach(g=>{if(g==e.editorState.curComponent)return;const _=ne(g.style),{top:y,left:L,bottom:P,right:I}=_,N=_.width/2,V=_.height/2,B={top:[{isNearly:r(t.top,y),lineNode:o.get("xt"),line:"xt",dragShift:y,lineShift:y},{isNearly:r(t.bottom,y),lineNode:o.get("xt"),line:"xt",dragShift:y-t.height,lineShift:y},{isNearly:r(t.top+h,y+V),lineNode:o.get("xc"),line:"xc",dragShift:y+V-h,lineShift:y+V},{isNearly:r(t.top,P),lineNode:o.get("xb"),line:"xb",dragShift:P,lineShift:P},{isNearly:r(t.bottom,P),lineNode:o.get("xb"),line:"xb",dragShift:P-t.height,lineShift:P}],left:[{isNearly:r(t.left,L),lineNode:o.get("yl"),line:"yl",dragShift:L,lineShift:L},{isNearly:r(t.right,L),lineNode:o.get("yl"),line:"yl",dragShift:L-t.width,lineShift:L},{isNearly:r(t.left+a,L+N),lineNode:o.get("yc"),line:"yc",dragShift:L+N-a,lineShift:L+N},{isNearly:r(t.left,I),lineNode:o.get("yr"),line:"yr",dragShift:I,lineShift:I},{isNearly:r(t.right,I),lineNode:o.get("yr"),line:"yr",dragShift:I-t.width,lineShift:I}]},R=[],{rotate:F}=e.editorState.curComponent.style;Object.keys(B).forEach(q=>{B[q].forEach(H=>{H.isNearly&&(e.setShapePosStyle({key:q,value:F!=0?p(q,H,t):H.dragShift}),H.lineNode.style[q]=`${H.lineShift}px`,R.push(H.line))})}),R.length&&c(R,l,v)})},p=(l,v,s)=>{const{width:t,height:a}=e.editorState.curComponent.style;return l=="top"?Math.round(v.dragShift-(a-s.height)/2):Math.round(v.dragShift-(t-s.width)/2)},c=(l,v,s)=>{s?l.includes("yr")?i.lineStatus.yr=!0:l.includes("yc")?i.lineStatus.yc=!0:l.includes("yl")&&(i.lineStatus.yl=!0):l.includes("yl")?i.lineStatus.yl=!0:l.includes("yc")?i.lineStatus.yc=!0:l.includes("yr")&&(i.lineStatus.yr=!0),v?l.includes("xb")?i.lineStatus.xb=!0:l.includes("xc")?i.lineStatus.xc=!0:l.includes("xt")&&(i.lineStatus.xt=!0):l.includes("xt")?i.lineStatus.xt=!0:l.includes("xc")?i.lineStatus.xc=!0:l.includes("xb")&&(i.lineStatus.xb=!0)},r=(l,v)=>Math.abs(l-v)<=i.diff;return(l,v)=>(m(),b("div",Ve,[(m(!0),b($,null,U(i.lines,s=>K((m(),b("div",{key:s,class:ee(["line",s.includes("x")?"xline":"yline"]),ref_for:!0,ref:t=>f(t,s)},null,2)),[[Q,i.lineStatus[s]||!1]])),128))]))}});const Ne=E(Ae,[["__scopeId","data-v-763a98e8"]]);async function pe(n,e=[]){if(n){const o=f=>new Promise(i=>{n.classList.add("animate__animated","animate__"+f.value);const u=()=>{n.removeEventListener("animationend",u),n.removeEventListener("animationcancel",u),n.classList.remove("animate__animated","animate__"+f.value),i()};n.addEventListener("animationend",u),n.addEventListener("animationcancel",u)});for(let f=0,i=e.length;f<i;f++)await o(e[f])}else console.log("runAnimation el为空")}const Oe={lt:Ee,t:Be,rt:$e,r:Ye,rb:Re,b:Xe,lb:Ue,l:Te};function Ee(n,e,o,f,i){const{symmetricPoint:u}=i;let d=z(e,u),p=M(e,d,-n.rotate),c=M(u,d,-n.rotate),r=c.x-p.x,l=c.y-p.y;if(f){r/l>o?(p.x+=Math.abs(r-l*o),r=l*o):(p.y+=Math.abs(l-r/o),l=r/o);const v=M(p,d,n.rotate);d=z(v,u),p=M(v,d,-n.rotate),c=M(u,d,-n.rotate),r=c.x-p.x,l=c.y-p.y}r>0&&l>0&&(n.width=Math.round(r),n.height=Math.round(l),n.left=Math.round(p.x),n.top=Math.round(p.y))}function $e(n,e,o,f,i){const{symmetricPoint:u}=i;let d=z(e,u),p=M(e,d,-n.rotate),c=M(u,d,-n.rotate),r=p.x-c.x,l=c.y-p.y;if(f){r/l>o?(p.x-=Math.abs(r-l*o),r=l*o):(p.y+=Math.abs(l-r/o),l=r/o);const v=M(p,d,n.rotate);d=z(v,u),p=M(v,d,-n.rotate),c=M(u,d,-n.rotate),r=p.x-c.x,l=c.y-p.y}r>0&&l>0&&(n.width=Math.round(r),n.height=Math.round(l),n.left=Math.round(c.x),n.top=Math.round(p.y))}function Re(n,e,o,f,i){const{symmetricPoint:u}=i;let d=z(e,u),p=M(u,d,-n.rotate),c=M(e,d,-n.rotate),r=c.x-p.x,l=c.y-p.y;if(f){r/l>o?(c.x-=Math.abs(r-l*o),r=l*o):(c.y-=Math.abs(l-r/o),l=r/o);const v=M(c,d,n.rotate);d=z(v,u),p=M(u,d,-n.rotate),c=M(v,d,-n.rotate),r=c.x-p.x,l=c.y-p.y}r>0&&l>0&&(n.width=Math.round(r),n.height=Math.round(l),n.left=Math.round(p.x),n.top=Math.round(p.y))}function Ue(n,e,o,f,i){const{symmetricPoint:u}=i;let d=z(e,u),p=M(u,d,-n.rotate),c=M(e,d,-n.rotate),r=p.x-c.x,l=c.y-p.y;if(f){r/l>o?(c.x+=Math.abs(r-l*o),r=l*o):(c.y-=Math.abs(l-r/o),l=r/o);const v=M(c,d,n.rotate);d=z(v,u),p=M(u,d,-n.rotate),c=M(v,d,-n.rotate),r=p.x-c.x,l=c.y-p.y}r>0&&l>0&&(n.width=Math.round(r),n.height=Math.round(l),n.left=Math.round(c.x),n.top=Math.round(p.y))}function Be(n,e,o,f,i){const{symmetricPoint:u,curPoint:d}=i,p=M(e,d,-n.rotate),c=M({x:d.x,y:p.y},d,n.rotate),r=Math.sqrt((c.x-u.x)**2+(c.y-u.y)**2);if(r>0){const l={x:c.x-(c.x-u.x)/2,y:c.y+(u.y-c.y)/2};let v=n.width;f&&(v=r*o),n.width=v,n.height=Math.round(r),n.top=Math.round(l.y-r/2),n.left=Math.round(l.x-n.width/2)}}function Ye(n,e,o,f,i){const{symmetricPoint:u,curPoint:d}=i,p=M(e,d,-n.rotate),c=M({x:p.x,y:d.y},d,n.rotate),r=Math.sqrt((c.x-u.x)**2+(c.y-u.y)**2);if(r>0){const l={x:c.x-(c.x-u.x)/2,y:c.y+(u.y-c.y)/2};let v=n.height;f&&(v=r/o),n.height=v,n.width=Math.round(r),n.top=Math.round(l.y-n.height/2),n.left=Math.round(l.x-r/2)}}function Xe(n,e,o,f,i){const{symmetricPoint:u,curPoint:d}=i,p=M(e,d,-n.rotate),c=M({x:d.x,y:p.y},d,n.rotate),r=Math.sqrt((c.x-u.x)**2+(c.y-u.y)**2);if(r>0){const l={x:c.x-(c.x-u.x)/2,y:c.y+(u.y-c.y)/2};let v=n.width;f&&(v=r*o),n.width=v,n.height=Math.round(r),n.top=Math.round(l.y-r/2),n.left=Math.round(l.x-n.width/2)}}function Te(n,e,o,f,i){const{symmetricPoint:u,curPoint:d}=i,p=M(e,d,-n.rotate),c=M({x:p.x,y:d.y},d,n.rotate),r=Math.sqrt((c.x-u.x)**2+(c.y-u.y)**2);if(r>0){const l={x:c.x-(c.x-u.x)/2,y:c.y+(u.y-c.y)/2};let v=n.height;f&&(v=r/o),n.height=v,n.width=Math.round(r),n.top=Math.round(l.y-n.height/2),n.left=Math.round(l.x-r/2)}}function He(n,e,o,f,i,u){Oe[n](e,o,f,i,u)}const ze=["onMousedown"],We=O({__name:"ShapeComponent",props:{active:{type:Boolean,default:!1},element:{require:!0,type:Object},defaultStyle:{require:!0,type:Object},index:{require:!0,type:[Number,String]}},setup(n){const e=n,o=Y.editorStore,f=ce(),i=T({pointList:["lt","t","rt","r","rb","b","lb","l"],initialAngle:{lt:0,t:45,rt:90,r:135,rb:180,b:225,lb:270,l:315},angleToCursor:[{start:338,end:23,cursor:"nw"},{start:23,end:68,cursor:"n"},{start:68,end:113,cursor:"ne"},{start:113,end:158,cursor:"e"},{start:158,end:203,cursor:"se"},{start:203,end:248,cursor:"s"},{start:248,end:293,cursor:"sw"},{start:293,end:338,cursor:"w"}],cursors:{}});Z(()=>{o.editorState.curComponent&&(i.cursors=p()),j.on("runAnimation",()=>{e.element===o.getCurComponent&&f.value!==void 0&&pe(f.value,o.getCurComponent.animations)})});const u=s=>{var B;s.preventDefault(),s.stopPropagation();const t={...e.defaultStyle},a=s.clientY,h=s.clientX,g=t.rotate,_=(B=f.value)==null?void 0:B.getBoundingClientRect(),y=(_==null?void 0:_.left)+(_==null?void 0:_.width)/2,L=(_==null?void 0:_.top)+(_==null?void 0:_.height)/2,P=Math.atan2(a-L,h-y)/(Math.PI/180);let I=!1;const N=R=>{I=!0;const F=R.clientX,q=R.clientY,H=Math.atan2(q-L,F-y)/(Math.PI/180);t.rotate=g+H-P,o.setShapeStyle(t)},V=()=>{I&&o.recordSnapshot(),document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",V),i.cursors=p()};document.addEventListener("mousemove",N),document.addEventListener("mouseup",V)},d=s=>{var N,V;const t=(N=e.defaultStyle)==null?void 0:N.height,a=(V=e.defaultStyle)==null?void 0:V.width,h=/t/.test(s),g=/b/.test(s),_=/l/.test(s),y=/r/.test(s);let L=0,P=0;return s.length===2?(L=_?0:a,P=h?0:t):((h||g)&&(L=a/2,P=h?0:t),(_||y)&&(L=_?0:a,P=Math.floor(t/2))),{marginLeft:"-4px",marginTop:"-4px",left:`${L}px`,top:`${P}px`,cursor:i.cursors[s]}},p=()=>{const s=(o.editorState.curComponent.style.rotate+360)%360,t={};let a=-1;return i.pointList.forEach(h=>{const g=(i.initialAngle[h]+s)%360,_=i.angleToCursor.length;for(;;){a=(a+1)%_;const y=i.angleToCursor[a];if(g<23||g>=338){t[h]="nw-resize";return}if(y.start<=g&&g<y.end){t[h]=y.cursor+"-resize";return}}}),t},c=s=>{var I,N;((I=e.element)==null?void 0:I.component)!="v-text"&&((N=e.element)==null?void 0:N.component)!="rect-shape"&&s.preventDefault(),s.stopPropagation(),o.setCurComponent({component:e.element,index:e.index}),i.cursors=p();const t={...e.defaultStyle},a=s.clientY,h=s.clientX,g=Number(t.top),_=Number(t.left);let y=!1;const L=V=>{y=!0;const B=V.clientX,R=V.clientY;t.top=R-a+g,t.left=B-h+_,o.setShapeStyle(t),me(()=>{j.emit("move",{isDownward:R-a>0,isRightward:B-h>0})})},P=()=>{y&&o.recordSnapshot(),j.emit("unMove"),document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",P)};document.addEventListener("mousemove",L),document.addEventListener("mouseup",P)},r=s=>{s.stopPropagation(),s.preventDefault(),o.hideContextMenu()},l=(s,t)=>{t.stopPropagation(),t.preventDefault();const a={...e.defaultStyle},h=a.width/a.height,g={x:a.left+a.width/2,y:a.top+a.height/2},_=o.editorState.editor.getBoundingClientRect(),y={x:t.clientX-(_==null?void 0:_.left),y:t.clientY-(_==null?void 0:_.top)},L={x:g.x-(y.x-g.x),y:g.y-(y.y-g.y)};let P=!1,I=!0;const N=v(),V=R=>{if(I){I=!1;return}P=!0;const F={x:R.clientX-(_==null?void 0:_.left),y:R.clientY-(_==null?void 0:_.top)};He(s,a,F,h,N,{center:g,curPoint:y,symmetricPoint:L}),o.setShapeStyle(a)},B=()=>{document.removeEventListener("mousemove",V),document.removeEventListener("mouseup",B),P&&o.recordSnapshot()};document.addEventListener("mousemove",V),document.addEventListener("mouseup",B)},v=()=>{var t;if(((t=e.element)==null?void 0:t.component)!="Group")return!1;const s=[0,90,180,360];for(const a of e.element.propValue)if(!s.includes(parseInt(a.style.rotate)))return!0;return!1};return(s,t)=>{const a=D("RefreshRight"),h=D("el-icon");return m(),b("div",{ref_key:"thisRef",ref:f,class:ee(["shape",{active:n.active}]),onClick:r,onMousedown:c},[K(w(h,{class:"el-icon-refresh-right",onMousedown:u},{default:C(()=>[w(a)]),_:1},512),[[Q,n.active]]),(m(!0),b($,null,U(n.active?i.pointList:[],g=>(m(),b("div",{class:"shape-point",onMousedown:_=>l(g,_),key:g,style:X(d(g))},null,44,ze))),128)),ue(s.$slots,"default",{},void 0,!0)],34)}}});const Ke=E(We,[["__scopeId","data-v-0dd30c3a"]]),je=O({__name:"AreaComponent",props:{start:{type:Object},width:{type:Number},height:{type:Number}},setup(n){return(e,o)=>(m(),b("div",{style:X({left:n.start.x+"px",top:n.start.y+"px",width:n.width+"px",height:n.height+"px"}),class:"area"},null,4))}});const qe=E(je,[["__scopeId","data-v-b92f54dd"]]),Fe=O({__name:"EditorComponent",props:{isEdit:{type:Boolean,default:!0}},setup(n){const e=T({editorX:0,editorY:0,start:{x:0,y:0},width:0,height:0,isShowArea:!1}),o=Y.editorStore;Z(()=>{o.getEditor();const s=o.editorState.editor.getBoundingClientRect();e.editorX=s.x,e.editorY=s.y,j.on("hideArea",()=>{i()})});const f=s=>{const t=o.editorState.curComponent;(!t||t.component!="v-text"&&t.component!="rect-shape")&&s.preventDefault(),i();const a=s.clientX,h=s.clientY;e.start.x=a-e.editorX,e.start.y=h-e.editorY,e.isShowArea=!0;const g=y=>{e.width=Math.abs(y.clientX-a),e.height=Math.abs(y.clientY-h),y.clientX<a&&(e.start.x=y.clientX-e.editorX),y.clientY<h&&(e.start.y=y.clientY-e.editorY)},_=y=>{if(document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",_),y.clientX==a&&y.clientY==h){i();return}u()};document.addEventListener("mousemove",g),document.addEventListener("mouseup",_)},i=()=>{e.isShowArea=!1,e.width=0,e.height=0},u=()=>{const s=d();if(s.length<=1){i();return}let t=1/0,a=1/0,h=-1/0,g=-1/0;s.forEach(_=>{const y=ne(_.style);y.left<a&&(a=y.left),y.top<t&&(t=y.top),y.right>h&&(h=y.right),y.bottom>g&&(g=y.bottom)}),e.start.x=a,e.start.y=t,e.width=h-a,e.height=g-t,o.setAreaData({style:{left:a,top:t,width:e.width,height:e.height},components:s})},d=()=>{const s=[],{x:t,y:a}=e.start;return o.editorState.componentData.forEach(h=>{const{left:g,top:_,width:y,height:L}=h.style;t<=g&&a<=_&&g+y<=t+e.width&&_+L<=a+e.height&&s.push(h)}),s},p=s=>{s.stopPropagation(),s.preventDefault();let t=s.target,a=s.offsetY,h=s.offsetX;for(;!t.className.includes("editor");)h+=t.offsetLeft,a+=t.offsetTop,t=t.parentNode;o.showContextMenu({top:a,left:h})},c=s=>{const t={};return["width","height","top","left","rotate"].forEach(a=>{a!="rotate"?t[a]=s[a]+"px":t.transform="rotate("+s[a]+"deg)"}),t},r=s=>de(s,["top","left","width","height","rotate"]),l=(s,t)=>{o.setShapeStyle({height:v(s,t)})},v=(s,t)=>{let{lineHeight:a,fontSize:h,height:g}=s.style;a===""&&(a=1.5);const _=(t.split("<br>").length-1)*a*h;return g>_?g:_};return(s,t)=>(m(),b("div",{class:ee(["editor",{edit:n.isEdit}]),id:"editor",style:X({width:x(o).editorState.canvasStyleData.width+"px",height:x(o).editorState.canvasStyleData.height+"px",transform:"scale("+x(o).editorState.canvasStyleData.scale/100+")"}),onContextmenu:p,onMousedown:f},[(m(!0),b($,null,U(x(o).editorState.componentData,(a,h)=>(m(),k(Ke,{defaultStyle:a.style,style:X(c(a.style)),key:a.id,active:a===x(o).editorState.curComponent,element:a,index:h},{default:C(()=>[a.component!="v-text"?(m(),k(G(a.component),{key:0,class:"component",style:X(r(a.style)),propValue:a.propValue,element:a,id:"component"+a.id},null,8,["style","propValue","element","id"])):(m(),k(G(a.component),{key:1,class:"component",style:X(r(a.style)),propValue:a.propValue,onInput:l,element:a,id:"component"+a.id},null,40,["style","propValue","element","id"]))]),_:2},1032,["defaultStyle","style","active","element","index"]))),128)),w(Ie),w(Ne),K(w(qe,{start:e.start,width:e.width,height:e.height},null,8,["start","width","height"]),[[Q,e.isShowArea]])],38))}});const Ge=E(Fe,[["__scopeId","data-v-9f078f3b"]]),le={redirect(n){n&&(window.location.href=n)},alert(n){n&&alert(n)}},Je=[{key:"redirect",label:"跳转事件",event:le.redirect,param:""},{key:"alert",label:"alert 事件",event:le.alert,param:""}],Qe=O({__name:"ComponentWrapper",props:{config:{}},setup(n){const e=n,o=ce();Z(()=>{o.value!==void 0&&pe(o.value,e.config.animations)});const f=()=>{const i=e.config.events;Object.keys(i).forEach(u=>{le[u](i[u])})};return(i,u)=>(m(),b("div",{onClick:f,ref_key:"wrapperDom",ref:o},[(m(),k(G(i.config.component),{class:"component",style:X(x(de)(i.config.style)),propValue:i.config.propValue,element:i.config},null,8,["style","propValue","element"]))],512))}});const Ze=E(Qe,[["__scopeId","data-v-f9a224a7"]]),et={key:0,class:"bg"},tt={class:"canvas-container"},ot=O({__name:"Preview",props:{show:{type:Boolean}},emits:["update:show"],setup(n,{emit:e}){const o=Y.editorStore.editorState,f=()=>{e("update:show",!1)};return(i,u)=>{const d=D("el-button");return i.show?(m(),b("div",et,[w(d,{onClick:f,class:"close"},{default:C(()=>[A("关闭")]),_:1}),S("div",tt,[S("div",{class:"canvas",style:X({width:x(o).canvasStyleData.width+"px",height:x(o).canvasStyleData.height+"px",transform:"scale("+x(o).canvasStyleData.scale/100+")"})},[(m(!0),b($,null,U(x(o).componentData,(p,c)=>(m(),k(Ze,{key:c,config:p},null,8,["config"]))),128))],4)])])):W("",!0)}}});const nt=E(ot,[["__scopeId","data-v-5b8d6646"]]),te=n=>(ge("data-v-a4c6ba15"),n=n(),be(),n),at={class:"toolbar"},lt=te(()=>S("label",{for:"input",class:"insert"},"插入图片",-1)),st={class:"canvas-config"},it=te(()=>S("span",null,"画布大小",-1)),rt=te(()=>S("span",null,"*",-1)),ct={class:"canvas-config"},ut=te(()=>S("span",null,"画布比例",-1)),dt=O({__name:"Toolbar",setup(n){const e=Y.editorStore,o=T({isShowPreview:!1}),f=()=>{e.compose(),e.recordSnapshot()},i=()=>{e.decompose(),e.recordSnapshot()},u=()=>{e.undo()},d=()=>{e.redo()},p=s=>{const t=s.target.files[0];if(!t.type.includes("image")){fe("只能插入图片");return}const a=new FileReader;a.onload=h=>{const g=h.target.result,_=new Image;_.onload=()=>{e.addComponent({component:{..._e,id:ae(),component:"v-picture",label:"图片",icon:"",propValue:g,style:{...ve,top:0,left:0,width:_.width,height:_.height}},index:void 0})},_.src=g},a.readAsDataURL(t)},c=()=>{o.isShowPreview=!0,e.setEditMode("read")},r=()=>{e.setEditMode("edit")},l=()=>{localStorage.setItem("canvasData",JSON.stringify(e.editorState.componentData)),localStorage.setItem("canvasStyle",JSON.stringify(e.editorState.canvasStyleData)),ye.success("保存成功")},v=()=>{e.setComponentData([])};return(s,t)=>{const a=D("el-button");return m(),b("div",null,[S("div",at,[w(a,{onClick:u},{default:C(()=>[A("撤消")]),_:1}),w(a,{onClick:d},{default:C(()=>[A("重做")]),_:1}),lt,S("input",{type:"file",onChange:p,id:"input",hidden:""},null,32),w(a,{onClick:c,style:{"margin-left":"10px"}},{default:C(()=>[A("预览")]),_:1}),w(a,{onClick:l},{default:C(()=>[A("保存")]),_:1}),w(a,{onClick:v},{default:C(()=>[A("清空画布")]),_:1}),w(a,{onClick:f,disabled:!x(e).editorState.areaData.components.length},{default:C(()=>[A("组合")]),_:1},8,["disabled"]),w(a,{onClick:i,disabled:!x(e).editorState.curComponent||x(e).editorState.curComponent.component!="VGroup"},{default:C(()=>[A("拆分")]),_:1},8,["disabled"]),S("div",st,[it,K(S("input",{"onUpdate:modelValue":t[0]||(t[0]=h=>x(e).editorState.canvasStyleData.width=h)},null,512),[[oe,x(e).editorState.canvasStyleData.width]]),rt,K(S("input",{"onUpdate:modelValue":t[1]||(t[1]=h=>x(e).editorState.canvasStyleData.height=h)},null,512),[[oe,x(e).editorState.canvasStyleData.height]])]),S("div",ct,[ut,K(S("input",{"onUpdate:modelValue":t[2]||(t[2]=h=>x(e).editorState.canvasStyleData.scale=h)},null,512),[[oe,x(e).editorState.canvasStyleData.scale]]),A(" % ")])]),w(nt,{show:o.isShowPreview,"onUpdate:show":t[3]||(t[3]=h=>o.isShowPreview=h),onChange:r},null,8,["show"])])}}});const pt=E(dt,[["__scopeId","data-v-a4c6ba15"]]),ie=[{label:"进入",children:[{label:"渐显",value:"fadeIn"},{label:"向右进入",value:"fadeInLeft"},{label:"向左进入",value:"fadeInRight"},{label:"向上进入",value:"fadeInUp"},{label:"向下进入",value:"fadeInDown"},{label:"向右长距进入",value:"fadeInLeftBig"},{label:"向左长距进入",value:"fadeInRightBig"},{label:"向上长距进入",value:"fadeInUpBig"},{label:"向下长距进入",value:"fadeInDownBig"},{label:"旋转进入",value:"rotateIn"},{label:"左顺时针旋转",value:"rotateInDownLeft"},{label:"右逆时针旋转",value:"rotateInDownRight"},{label:"左逆时针旋转",value:"rotateInUpLeft"},{label:"右逆时针旋转",value:"rotateInUpRight"},{label:"弹入",value:"bounceIn"},{label:"向右弹入",value:"bounceInLeft"},{label:"向左弹入",value:"bounceInRight"},{label:"向上弹入",value:"bounceInUp"},{label:"向下弹入",value:"bounceInDown"},{label:"光速从右进入",value:"lightSpeedInRight"},{label:"光速从左进入",value:"lightSpeedInLeft"},{label:"光速从右退出",value:"lightSpeedOutRight"},{label:"光速从左退出",value:"lightSpeedOutLeft"},{label:"Y轴旋转",value:"flip"},{label:"中心X轴旋转",value:"flipInX"},{label:"中心Y轴旋转",value:"flipInY"},{label:"左长半径旋转",value:"rollIn"},{label:"由小变大进入",value:"zoomIn"},{label:"左变大进入",value:"zoomInLeft"},{label:"右变大进入",value:"zoomInRight"},{label:"向上变大进入",value:"zoomInUp"},{label:"向下变大进入",value:"zoomInDown"},{label:"向右滑动展开",value:"slideInLeft"},{label:"向左滑动展开",value:"slideInRight"},{label:"向上滑动展开",value:"slideInUp"},{label:"向下滑动展开",value:"slideInDown"}]},{label:"强调",children:[{label:"弹跳",value:"bounce"},{label:"闪烁",value:"flash"},{label:"放大缩小",value:"pulse"},{label:"放大缩小弹簧",value:"rubberBand"},{label:"左右晃动",value:"headShake"},{label:"左右扇形摇摆",value:"swing"},{label:"放大晃动缩小",value:"tada"},{label:"扇形摇摆",value:"wobble"},{label:"左右上下晃动",value:"jello"},{label:"Y轴旋转",value:"flip"}]},{label:"退出",children:[{label:"渐隐",value:"fadeOut"},{label:"向左退出",value:"fadeOutLeft"},{label:"向右退出",value:"fadeOutRight"},{label:"向上退出",value:"fadeOutUp"},{label:"向下退出",value:"fadeOutDown"},{label:"向左长距退出",value:"fadeOutLeftBig"},{label:"向右长距退出",value:"fadeOutRightBig"},{label:"向上长距退出",value:"fadeOutUpBig"},{label:"向下长距退出",value:"fadeOutDownBig"},{label:"旋转退出",value:"rotateOut"},{label:"左顺时针旋转",value:"rotateOutDownLeft"},{label:"右逆时针旋转",value:"rotateOutDownRight"},{label:"左逆时针旋转",value:"rotateOutUpLeft"},{label:"右逆时针旋转",value:"rotateOutUpRight"},{label:"弹出",value:"bounceOut"},{label:"向左弹出",value:"bounceOutLeft"},{label:"向右弹出",value:"bounceOutRight"},{label:"向上弹出",value:"bounceOutUp"},{label:"向下弹出",value:"bounceOutDown"},{label:"中心X轴旋转",value:"flipOutX"},{label:"中心Y轴旋转",value:"flipOutY"},{label:"左长半径旋转",value:"rollOut"},{label:"由小变大退出",value:"zoomOut"},{label:"左变大退出",value:"zoomOutLeft"},{label:"右变大退出",value:"zoomOutRight"},{label:"向上变大退出",value:"zoomOutUp"},{label:"向下变大退出",value:"zoomOutDown"},{label:"向左滑动收起",value:"slideOutLeft"},{label:"向右滑动收起",value:"slideOutRight"},{label:"向上滑动收起",value:"slideOutUp"},{label:"向下滑动收起",value:"slideOutDown"}]}],ht=O({__name:"Modal",props:{show:{type:Boolean}},emits:["update:show"],setup(n,{emit:e}){const o=()=>{e("update:show")},f=i=>{i.stopPropagation()};return(i,u)=>i.show?(m(),b("div",{key:0,class:"modal-bg",onClick:o},[S("div",{class:"fadeInLeft animated modal",onClick:f},[ue(i.$slots,"default",{},void 0,!0)])])):W("",!0)}});const he=E(ht,[["__scopeId","data-v-b4747281"]]),mt={class:"animation-list"},ft={key:0,class:"div-animation"},_t={class:"el-scrollbar-view"},vt=["onMouseover","onClick"],yt=O({__name:"AnimationList",setup(n){const e=Y.editorStore,o=T({isShowAnimation:!1,animationClassData:ie,animationActiveName:"进入",showAnimatePanel:!1,hoverPreviewAnimate:""}),f=d=>{e.addAnimation(d),o.isShowAnimation=!1},i=()=>{j.emit("runAnimation")},u=d=>{e.removeAnimation(d)};return(d,p)=>{const c=D("el-button"),r=D("el-tag"),l=D("el-scrollbar"),v=D("el-tab-pane"),s=D("el-tabs");return m(),b("div",mt,[x(e).editorState.curComponent?(m(),b("div",ft,[w(c,{onClick:p[0]||(p[0]=t=>{o.isShowAnimation=!0})},{default:C(()=>[A("添加动画")]),_:1}),w(c,{onClick:i},{default:C(()=>[A("预览动画")]),_:1}),S("div",null,[(m(!0),b($,null,U(x(e).editorState.curComponent.animations,(t,a)=>(m(),k(r,{key:a,closable:"",onClose:h=>u(a)},{default:C(()=>[A(J(t.label),1)]),_:2},1032,["onClose"]))),128))])])):W("",!0),w(he,{show:o.isShowAnimation,"onUpdate:show":p[2]||(p[2]=t=>o.isShowAnimation=t)},{default:C(()=>[w(s,{type:"card",modelValue:o.animationActiveName,"onUpdate:modelValue":p[1]||(p[1]=t=>o.animationActiveName=t)},{default:C(()=>[(m(!0),b($,null,U(x(ie),t=>(m(),k(v,{key:t.label,label:t.label,name:t.label},{default:C(()=>[w(l,{class:"animate-container"},{default:C(()=>[S("div",_t,[(m(!0),b($,null,U(t.children,(a,h)=>(m(),b("div",{class:"animate",key:h,onMouseover:g=>o.hoverPreviewAnimate=a.value,onClick:g=>f(a)},[S("div",{class:ee([o.hoverPreviewAnimate===a.value&&"animate__animated animate__"+a.value])},J(a.label),3)],40,vt))),128))])]),_:2},1024)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["show"])])}}});const gt=E(yt,[["__scopeId","data-v-41b1b119"]]),bt={class:"event-list"},St={key:0,class:"div-events"},xt=O({__name:"EventList",setup(n){const e=Y.editorStore,o=T({isShowEvent:!1,eventURL:"",eventActiveName:"redirect",eventList:Je}),f=(u,d)=>{o.isShowEvent=!1,e.addEvent({event:u,param:d})},i=u=>{e.removeEvent(u)};return(u,d)=>{const p=D("el-button"),c=D("el-tag"),r=D("el-input"),l=D("el-tab-pane"),v=D("el-tabs");return m(),b("div",bt,[x(e).editorState.curComponent?(m(),b("div",St,[w(p,{onClick:d[0]||(d[0]=s=>o.isShowEvent=!0)},{default:C(()=>[A("添加事件")]),_:1}),S("div",null,[(m(!0),b($,null,U(Object.keys(x(e).editorState.curComponent.events),s=>(m(),k(c,{key:s,closable:"",onClose:t=>i(s)},{default:C(()=>[A(J(s),1)]),_:2},1032,["onClose"]))),128))])])):W("",!0),w(he,{show:o.isShowEvent,"onUpdate:show":d[2]||(d[2]=s=>o.isShowEvent=s)},{default:C(()=>[w(v,{type:"card",modelValue:o.eventActiveName,"onUpdate:modelValue":d[1]||(d[1]=s=>o.eventActiveName=s)},{default:C(()=>[(m(!0),b($,null,U(o.eventList,s=>(m(),k(l,{key:s.key,label:s.label,name:s.key,style:{padding:"0 20px"}},{default:C(()=>[s.key=="redirect"?(m(),k(r,{key:0,modelValue:s.param,"onUpdate:modelValue":t=>s.param=t,type:"textarea",placeholder:"请输入完整的 URL"},null,8,["modelValue","onUpdate:modelValue"])):W("",!0),s.key=="alert"?(m(),k(r,{key:1,modelValue:s.param,"onUpdate:modelValue":t=>s.param=t,type:"textarea",placeholder:"请输入要 alert 的内容"},null,8,["modelValue","onUpdate:modelValue"])):W("",!0),w(p,{style:{"margin-top":"20px"},onClick:t=>f(s.key,s.param)},{default:C(()=>[A("确定")]),_:2},1032,["onClick"])]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["show"])])}}});const wt=E(xt,[["__scopeId","data-v-03af1cf7"]]),Ct={class:"home"},Mt={class:"left"},Lt={class:"center"},kt={class:"right"},Dt={key:1,class:"placeholder"},Pt={key:1,class:"placeholder"},It={key:1,class:"placeholder"},Vt=O({__name:"Home",setup(n){const e=Y.editorStore,o=T({activeName:"attr",reSelectAnimateIndex:void 0}),f=()=>{localStorage.getItem("canvasData")&&e.setComponentData(u(JSON.parse(localStorage.getItem("canvasData")))),localStorage.getItem("canvasStyle")&&e.setCanvasStyle(JSON.parse(localStorage.getItem("canvasStyle")))},i=()=>{let t=!1;window.onkeydown=a=>{a.keyCode==17?t=!0:t&&a.keyCode==67?e.copy():t&&a.keyCode==86?(e.paste(!1),e.recordSnapshot()):t&&a.keyCode==88&&e.cut()},window.onkeyup=a=>{a.keyCode==17&&(t=!1)}},u=r=>(r.forEach(l=>{l.id=ae()}),r),d=r=>{r.preventDefault(),r.stopPropagation();const l=Se.cloneDeep(re[r.dataTransfer.getData("index")]);l.style.top=r.offsetY,l.style.left=r.offsetX,l.id=ae(),e.addComponent({component:l,index:void 0}),e.recordSnapshot()},p=r=>{r.preventDefault(),r.dataTransfer.dropEffect="copy"},c=()=>{e.setCurComponent({component:null,index:null}),e.hideContextMenu()};return f(),i(),(r,l)=>{const v=D("el-tab-pane"),s=D("el-tabs");return m(),b("div",Ct,[w(pt),S("main",null,[S("section",Mt,[w(Me)]),S("section",Lt,[S("div",{class:"content",onDrop:d,onDragover:p,onClick:c},[w(Ge)],32)]),S("section",kt,[w(s,{modelValue:o.activeName,"onUpdate:modelValue":l[0]||(l[0]=t=>o.activeName=t),type:"card"},{default:C(()=>[w(v,{label:"属性",name:"attr"},{default:C(()=>[x(e).editorState.curComponent?(m(),k(De,{key:0})):(m(),b("p",Dt,"请选择组件"))]),_:1}),w(v,{label:"动画",name:"animation"},{default:C(()=>[x(e).editorState.curComponent?(m(),k(gt,{key:0})):(m(),b("p",Pt,"请选择组件"))]),_:1}),w(v,{label:"事件",name:"events"},{default:C(()=>[x(e).editorState.curComponent?(m(),k(wt,{key:0})):(m(),b("p",It,"请选择组件"))]),_:1})]),_:1},8,["modelValue"])])])])}}});const Nt=E(Vt,[["__scopeId","data-v-4abad892"]]);export{Nt as default};
