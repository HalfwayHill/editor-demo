import{d as R,o as p,c as v,F as U,r as $,a as k,b as J,e as M,t as ee,u as g,_ as N,f as z,g as se,h as L,i as y,w as x,j as A,k as B,l as j,v as ne,n as H,m as ae,p as G,q as pe,s as me,x as _e,y as E,z as re,A as ve,B as te,E as ge,C as be,D as ye,G as Se}from"./index-582d4fa7.js";const xe="/editor-demo/assets/title-9b4c7ab1.jpg",we={rotate:"",opacity:1},le=[{id:0,component:"v-text",label:"文字",propValue:"文字",icon:"Edit",animations:[],events:{},style:{top:0,left:0,width:200,height:33,fontSize:14,fontWeight:500,lineHeight:"",letterSpacing:0,textAlign:"",color:""}},{id:0,component:"v-button",label:"按钮",propValue:"按钮",icon:"Crop",animations:[],events:{},style:{top:0,left:0,width:100,height:34,borderWidth:"",borderColor:"",borderRadius:"",fontSize:14,fontWeight:500,lineHeight:"",letterSpacing:0,textAlign:"",color:"",backgroundColor:""}},{id:0,component:"v-picture",label:"图片",icon:"PictureRounded",propValue:Ce(xe),animations:[],events:{},style:{top:0,left:0,width:300,height:200,borderRadius:""}}];le.forEach(e=>{e.style={...e.style,...we}});function Ce(e){return new URL(e,import.meta.url).href}const Me={class:"component-list"},ke=["data-index"],Le=R({__name:"ComponentList",setup(e){const t=a=>{a.dataTransfer.setData("index",a.target.dataset.index)};return(a,l)=>(p(),v("div",Me,[(p(!0),v(U,null,$(g(le),(o,h)=>(p(),v("div",{key:h,class:"item",draggable:"true",onDragstart:l[0]||(l[0]=c=>t(c)),"data-index":h},[(p(),k(J(o.icon),{class:"icon"})),M("span",null,ee(o.label),1)],40,ke))),128))]))}});const De=N(Le,[["__scopeId","data-v-c47933ae"]]),Pe={class:"attr-list"},Ie=R({__name:"AttrList",setup(e){const t=B.editorStore,a=z({excludes:["Picture"],options:[{label:"左对齐",value:"left"},{label:"居中",value:"center"},{label:"右对齐",value:"right"}],map:{left:"x 坐标",top:"y 坐标",height:"高",width:"宽",color:"颜色",backgroundColor:"背景色",borderWidth:"边框宽度",borderColor:"边框颜色",borderRadius:"边框半径",fontSize:"字体大小",fontWeight:"字体粗细",lineHeight:"行高",letterSpacing:"字间距",textAlign:"对齐方式",opacity:"透明度",rotate:"旋转角度"}}),l=se(()=>t.editorState.curComponent?Object.keys(t.editorState.curComponent.style):[]),o=se(()=>t.editorState.curComponent);return(h,c)=>{const r=L("el-color-picker"),u=L("el-option"),m=L("el-select"),_=L("el-input"),n=L("el-form-item"),d=L("el-form");return p(),v("div",Pe,[y(d,null,{default:x(()=>[(p(!0),v(U,null,$(l.value,(s,i)=>(p(),k(n,{key:i,label:a.map[s]},{default:x(()=>[s=="borderColor"?(p(),k(r,{key:0,modelValue:o.value.style[s],"onUpdate:modelValue":f=>o.value.style[s]=f},null,8,["modelValue","onUpdate:modelValue"])):s=="color"?(p(),k(r,{key:1,modelValue:o.value.style[s],"onUpdate:modelValue":f=>o.value.style[s]=f},null,8,["modelValue","onUpdate:modelValue"])):s=="backgroundColor"?(p(),k(r,{key:2,modelValue:o.value.style[s],"onUpdate:modelValue":f=>o.value.style[s]=f},null,8,["modelValue","onUpdate:modelValue"])):s=="textAlign"?(p(),k(m,{key:3,modelValue:o.value.style[s],"onUpdate:modelValue":f=>o.value.style[s]=f},{default:x(()=>[(p(!0),v(U,null,$(a.options,f=>(p(),k(u,{key:f.value,label:f.label,value:f.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):(p(),k(_,{key:4,type:"number",modelValue:o.value.style[s],"onUpdate:modelValue":f=>o.value.style[s]=f},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["label"]))),128)),o.value&&o.value.propValue&&!a.excludes.includes(o.value.component)?(p(),k(n,{key:0,label:"内容"},{default:x(()=>[y(_,{type:"textarea",modelValue:o.value.propValue,"onUpdate:modelValue":c[0]||(c[0]=s=>o.value.propValue=s)},null,8,["modelValue"])]),_:1})):A("",!0)]),_:1})])}}});const Ve=N(Ie,[["__scopeId","data-v-b2c12231"]]),Oe=R({__name:"ContextMenu",setup(e){const t=B.editorStore;z({copyData:null});const a=()=>{t.copy()},l=()=>{t.paste(!0)},o=()=>{t.cut()},h=()=>{t.deleteComponent(),t.recordSnapshot()},c=()=>{t.upComponent(),t.recordSnapshot()},r=()=>{t.downComponent(),t.recordSnapshot()},u=()=>{t.topComponent(),t.recordSnapshot()},m=()=>{t.bottomComponent(),t.recordSnapshot()};return(_,n)=>j((p(),v("div",{class:"contextmenu",style:H({top:g(t).editorState.menuTop+"px",left:g(t).editorState.menuLeft+"px"})},[M("ul",null,[g(t).editorState.curComponent?(p(),v("li",{key:0,onClick:a},"复制")):A("",!0),M("li",{onClick:l},"粘贴"),g(t).editorState.curComponent?(p(),v("li",{key:1,onClick:o},"剪切")):A("",!0),g(t).editorState.curComponent?(p(),v("li",{key:2,onClick:h},"删除")):A("",!0),g(t).editorState.curComponent?(p(),v("li",{key:3,onClick:u},"置顶")):A("",!0),g(t).editorState.curComponent?(p(),v("li",{key:4,onClick:m},"置底")):A("",!0),g(t).editorState.curComponent?(p(),v("li",{key:5,onClick:c},"上移")):A("",!0),g(t).editorState.curComponent?(p(),v("li",{key:6,onClick:r},"下移")):A("",!0)])],4)),[[ne,g(t).editorState.menuShow]])}});const Re=N(Oe,[["__scopeId","data-v-ab3b3a2f"]]);function Ne(e){return{all:e=e||new Map,on:function(t,a){var l=e.get(t);l?l.push(a):e.set(t,[a])},off:function(t,a){var l=e.get(t);l&&(a?l.splice(l.indexOf(a)>>>0,1):e.set(t,[]))},emit:function(t,a){var l=e.get(t);l&&l.slice().map(function(o){o(a)}),(l=e.get("*"))&&l.slice().map(function(o){o(t,a)})}}}const X=Ne();function W(e){return e*Math.PI/180}function P(e,t,a){return{x:(e.x-t.x)*Math.cos(W(a))-(e.y-t.y)*Math.sin(W(a))+t.x,y:(e.x-t.x)*Math.sin(W(a))+(e.y-t.y)*Math.cos(W(a))+t.y}}function Ae(e,t,a){let l;switch(a){case"t":l={x:e.left+e.width/2,y:e.top};break;case"b":l={x:e.left+e.width/2,y:e.top+e.height};break;case"l":l={x:e.left,y:e.top+e.height/2};break;case"r":l={x:e.left+e.width,y:e.top+e.height/2};break;case"lt":l={x:e.left,y:e.top};break;case"rt":l={x:e.left+e.width,y:e.top};break;case"lb":l={x:e.left,y:e.top+e.height};break;default:l={x:e.left+e.width,y:e.top+e.height};break}return P(l,t,e.rotate)}function Q(e,t){return{x:e.x+(t.x-e.x)/2,y:e.y+(t.y-e.y)/2}}function ce(e){return Math.abs(Math.sin(W(e)))}function ue(e){return Math.abs(Math.cos(W(e)))}const Ue={class:"mark-line"},$e=R({__name:"MarkLine",setup(e){const t=B.editorStore,a=new Map,l=(n,d)=>{n&&a.set(d,n)},o=z({lines:["xt","xc","xb","yl","yc","yr"],diff:3,lineStatus:{xt:!1,xc:!1,xb:!1,yl:!1,yc:!1,yr:!1}});ae(()=>{X.on("move",n=>{r(n.isDownward,n.isRightward)}),X.on("unMove",()=>{c()})});const h=n=>{if(n={...n},n.rotate!=0){const d=n.width*ue(n.rotate)+n.height*ce(n.rotate),s=(n.width-d)/2;n.left+=s,n.right=n.left+d;const i=n.height*ue(n.rotate)+n.width*ce(n.rotate),f=(i-n.height)/2;n.top-=f,n.bottom=n.top+i,n.width=d,n.height=i}else n.bottom=n.top+n.height,n.right=n.left+n.width;return n},c=()=>{Object.keys(o.lineStatus).forEach(n=>{o.lineStatus[n]=!1})},r=(n,d)=>{const s=t.editorState.componentData,i=h(t.editorState.curComponent.style),f=i.width/2,b=i.height/2;c(),s.forEach(w=>{if(w==t.editorState.curComponent)return;const V=h(w.style),{top:C,left:S,bottom:I,right:D}=V,O=V.width/2,Y=V.height/2,q={top:[{isNearly:_(i.top,C),lineNode:a.get("xt"),line:"xt",dragShift:C,lineShift:C},{isNearly:_(i.bottom,C),lineNode:a.get("xt"),line:"xt",dragShift:C-i.height,lineShift:C},{isNearly:_(i.top+b,C+Y),lineNode:a.get("xc"),line:"xc",dragShift:C+Y-b,lineShift:C+Y},{isNearly:_(i.top,I),lineNode:a.get("xb"),line:"xb",dragShift:I,lineShift:I},{isNearly:_(i.bottom,I),lineNode:a.get("xb"),line:"xb",dragShift:I-i.height,lineShift:I}],left:[{isNearly:_(i.left,S),lineNode:a.get("yl"),line:"yl",dragShift:S,lineShift:S},{isNearly:_(i.right,S),lineNode:a.get("yl"),line:"yl",dragShift:S-i.width,lineShift:S},{isNearly:_(i.left+f,S+O),lineNode:a.get("yc"),line:"yc",dragShift:S+O-f,lineShift:S+O},{isNearly:_(i.left,D),lineNode:a.get("yr"),line:"yr",dragShift:D,lineShift:D},{isNearly:_(i.right,D),lineNode:a.get("yr"),line:"yr",dragShift:D-i.width,lineShift:D}]},K=[],{rotate:Z}=t.editorState.curComponent.style;Object.keys(q).forEach(F=>{q[F].forEach(T=>{T.isNearly&&(t.setShapePosStyle({key:F,value:Z!=0?u(F,T,i):T.dragShift}),T.lineNode.style[F]=`${T.lineShift}px`,K.push(T.line))})}),K.length&&m(K,n,d)})},u=(n,d,s)=>{const{width:i,height:f}=t.editorState.curComponent.style;return n=="top"?Math.round(d.dragShift-(f-s.height)/2):Math.round(d.dragShift-(i-s.width)/2)},m=(n,d,s)=>{s?n.includes("yr")?o.lineStatus.yr=!0:n.includes("yc")?o.lineStatus.yc=!0:n.includes("yl")&&(o.lineStatus.yl=!0):n.includes("yl")?o.lineStatus.yl=!0:n.includes("yc")?o.lineStatus.yc=!0:n.includes("yr")&&(o.lineStatus.yr=!0),d?n.includes("xb")?o.lineStatus.xb=!0:n.includes("xc")?o.lineStatus.xc=!0:n.includes("xt")&&(o.lineStatus.xt=!0):n.includes("xt")?o.lineStatus.xt=!0:n.includes("xc")?o.lineStatus.xc=!0:n.includes("xb")&&(o.lineStatus.xb=!0)},_=(n,d)=>Math.abs(n-d)<=o.diff;return(n,d)=>(p(),v("div",Ue,[(p(!0),v(U,null,$(o.lines,s=>j((p(),v("div",{key:s,class:G(["line",s.includes("x")?"xline":"yline"]),ref_for:!0,ref:i=>l(i,s)},null,2)),[[ne,o.lineStatus[s]||!1]])),128))]))}});const Ee=N($e,[["__scopeId","data-v-736c7152"]]);async function he(e,t=[]){if(e){const a=l=>new Promise(o=>{e.classList.add("animate__animated","animate__"+l.value);const h=()=>{e.removeEventListener("animationend",h),e.removeEventListener("animationcancel",h),e.classList.remove("animate__animated","animate__"+l.value),o()};e.addEventListener("animationend",h),e.addEventListener("animationcancel",h)});for(let l=0,o=t.length;l<o;l++)await a(t[l])}else console.log("runAnimation el为空")}const Be={lt:He,t:ze,rt:Xe,r:Ye,rb:Ke,b:Te,lb:je,l:We};function He(e,t,a){const{symmetricPoint:l}=a,o=Q(t,l),h=P(t,o,-e.rotate),c=P(l,o,-e.rotate),r=c.x-h.x,u=c.y-h.y;r>0&&u>0&&(e.width=Math.round(r),e.height=Math.round(u),e.left=Math.round(h.x),e.top=Math.round(h.y))}function ze(e,t,a){const{symmetricPoint:l,clickPoint:o}=a,h=P(t,o,-e.rotate),c=P({x:o.x,y:h.y},o,e.rotate),r=Math.sqrt((c.x-l.x)**2+(c.y-l.y)**2);if(r>0){const u={x:c.x-(c.x-l.x)/2,y:c.y+(l.y-c.y)/2};e.height=Math.round(r),e.top=Math.round(u.y-r/2),e.left=Math.round(u.x-e.width/2)}}function Ye(e,t,a){const{symmetricPoint:l,clickPoint:o}=a,h=P(t,o,-e.rotate),c=P({x:h.x,y:o.y},o,e.rotate),r=Math.sqrt((c.x-l.x)**2+(c.y-l.y)**2);if(r>0){const u={x:c.x-(c.x-l.x)/2,y:c.y+(l.y-c.y)/2};e.width=Math.round(r),e.top=Math.round(u.y-e.height/2),e.left=Math.round(u.x-r/2)}}function Te(e,t,a){const{symmetricPoint:l,clickPoint:o}=a,h=P(t,o,-e.rotate),c=P({x:o.x,y:h.y},o,e.rotate),r=Math.sqrt((c.x-l.x)**2+(c.y-l.y)**2);if(r>0){const u={x:c.x-(c.x-l.x)/2,y:c.y+(l.y-c.y)/2};e.height=Math.round(r),e.top=Math.round(u.y-r/2),e.left=Math.round(u.x-e.width/2)}}function We(e,t,a){const{symmetricPoint:l,clickPoint:o}=a,h=P(t,o,-e.rotate),c=P({x:h.x,y:o.y},o,e.rotate),r=Math.sqrt((c.x-l.x)**2+(c.y-l.y)**2);if(r>0){const u={x:c.x-(c.x-l.x)/2,y:c.y+(l.y-c.y)/2};e.width=Math.round(r),e.top=Math.round(u.y-e.height/2),e.left=Math.round(u.x-r/2)}}function Xe(e,t,a){const{symmetricPoint:l}=a,o=Q(t,l),h=P(t,o,-e.rotate),c=P(l,o,-e.rotate),r=h.x-c.x,u=c.y-h.y;r>0&&u>0&&(e.width=Math.round(r),e.height=Math.round(u),e.left=Math.round(c.x),e.top=Math.round(h.y))}function Ke(e,t,a){const{symmetricPoint:l}=a,o=Q(t,l),h=P(l,o,-e.rotate),c=P(t,o,-e.rotate),r=c.x-h.x,u=c.y-h.y;r>0&&u>0&&(e.width=Math.round(r),e.height=Math.round(u),e.left=Math.round(h.x),e.top=Math.round(h.y))}function je(e,t,a){const{symmetricPoint:l}=a,o=Q(t,l),h=P(l,o,-e.rotate),c=P(t,o,-e.rotate),r=h.x-c.x,u=c.y-h.y;r>0&&u>0&&(e.width=Math.round(r),e.height=Math.round(u),e.left=Math.round(c.x),e.top=Math.round(h.y))}function qe(e,t,a,l){Be[e](t,a,l)}const Fe=["onMousedown"],Je=R({__name:"ShapeComponent",props:{active:{type:Boolean,default:!1},element:{require:!0,type:Object},defaultStyle:{require:!0,type:Object},index:{require:!0,type:[Number,String]}},setup(e){const t=e,a=B.editorStore,l=pe(),o=z({pointList:["lt","t","rt","r","lb","b","rb","l"],directions:["nw","n","ne","e","sw","s","se","w"],cursors:[]});ae(()=>{X.on("runAnimation",()=>{t.element===a.getCurComponent&&l.value!==void 0&&he(l.value,a.getCurComponent.animations)})});const h=n=>{var O;n.stopPropagation();const d={...t.defaultStyle},s=n.clientY,i=n.clientX,f=d.rotate,b=(O=l.value)==null?void 0:O.getBoundingClientRect(),w=(b==null?void 0:b.left)+(b==null?void 0:b.width)/2,V=(b==null?void 0:b.top)+(b==null?void 0:b.height)/2,C=Math.atan2(s-V,i-w)/(Math.PI/180);let S=!1;const I=Y=>{S=!0;const q=Y.clientX,K=Y.clientY,Z=Math.atan2(K-V,q-w)/(Math.PI/180);d.rotate=f+Z-C,a.setShapeStyle(d)},D=()=>{S&&a.recordSnapshot(),document.removeEventListener("mousemove",I),document.removeEventListener("mouseup",D),o.cursors=r()};document.addEventListener("mousemove",I),document.addEventListener("mouseup",D)},c=(n,d)=>{var D,O;const s=(D=t.defaultStyle)==null?void 0:D.height,i=(O=t.defaultStyle)==null?void 0:O.width,f=/t/.test(n),b=/b/.test(n),w=/l/.test(n),V=/r/.test(n);let C=0,S=0;return n.length===2?(C=w?0:i,S=f?0:s):((f||b)&&(C=i/2,S=f?0:s),(w||V)&&(C=w?0:i,S=Math.floor(s/2))),{marginLeft:"-4px",marginTop:"-4px",left:`${C}px`,top:`${S}px`,cursor:o.cursors[d]}},r=()=>{const n=Math.floor((a.editorState.curComponent.style.rotate+360)%360/45)%8,d=o.directions;return[...d.slice(n),...d.slice(0,n)].map(i=>i+"-resize")},u=n=>{var S;((S=t.element)==null?void 0:S.component)!="v-text"&&n.preventDefault(),n.stopPropagation(),a.setCurComponent({component:t.element,index:t.index}),o.cursors=r();const d={...t.defaultStyle},s=n.clientY,i=n.clientX,f=Number(d.top),b=Number(d.left);let w=!1;const V=I=>{w=!0;const D=I.clientX,O=I.clientY;d.top=O-s+f,d.left=D-i+b,a.setShapeStyle(d),_e(()=>{X.emit("move",{isDownward:O-s>0,isRightward:D-i>0})})},C=()=>{w&&a.recordSnapshot(),X.emit("unMove"),document.removeEventListener("mousemove",V),document.removeEventListener("mouseup",C)};document.addEventListener("mousemove",V),document.addEventListener("mouseup",C)},m=n=>{n.stopPropagation(),n.preventDefault(),a.hideContextMenu()},_=n=>{var I;const d=window.event;d==null||d.stopPropagation(),d==null||d.preventDefault();const s={...t.defaultStyle},i={x:s.left+s.width/2,y:s.top+s.height/2},f=Ae(s,i,n),b={x:i.x-(f.x-i.x),y:i.y-(f.y-i.y)},w=(I=document==null?void 0:document.querySelector("#editor"))==null?void 0:I.getBoundingClientRect();let V=!1;const C=D=>{V=!0;const O={x:D.clientX-(w==null?void 0:w.left),y:D.clientY-(w==null?void 0:w.top)};qe(n,s,O,{center:i,clickPoint:f,symmetricPoint:b}),a.setShapeStyle(s)},S=()=>{document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",S),V&&a.recordSnapshot()};document.addEventListener("mousemove",C),document.addEventListener("mouseup",S)};return(n,d)=>{const s=L("RefreshRight"),i=L("el-icon");return p(),v("div",{ref_key:"thisRef",ref:l,class:G(["shape",{active:e.active}]),onClick:m,onMousedown:u},[j(y(i,{class:"el-icon-refresh-right",onMousedown:h},{default:x(()=>[y(s)]),_:1},512),[[ne,e.active]]),(p(!0),v(U,null,$(e.active?o.pointList:[],(f,b)=>(p(),v("div",{class:"shape-point",onMousedown:w=>_(f),key:b,style:H(c(f,b))},null,44,Fe))),128)),me(n.$slots,"default",{},void 0,!0)],34)}}});const Ge=N(Je,[["__scopeId","data-v-6408118b"]]);function fe(e,t=[]){const a=["fontSize","width","height","top","left"],l={};return Object.keys(e).forEach(o=>{t.includes(o)||(o!="rotate"?(l[o]=e[o],a.includes(o)&&(l[o]+="px")):l.transform=o+"("+e[o]+"deg)")}),l}const Qe=R({__name:"EditorComponent",props:{isEdit:{type:Boolean,default:!0}},setup(e){const t=B.editorStore,a=r=>{r.stopPropagation(),r.preventDefault();let u=r.target,m=r.offsetY,_=r.offsetX;for(;!u.className.includes("editor");)_+=u.offsetLeft,m+=u.offsetTop,u=u.parentNode;t.showContextMenu({top:m,left:_})},l=r=>{const u={...r};return u.width&&(u.width+="px"),u.height&&(u.height+="px"),u.top&&(u.top+="px"),u.left&&(u.left+="px"),u.rotate&&(u.transform="rotate("+u.rotate+"deg)"),u},o=r=>fe(r,["top","left","width","height","rotate"]),h=(r,u)=>{r.propValue=u,t.setShapeStyle({height:c(r,u)})},c=(r,u)=>{let{lineHeight:m,fontSize:_,height:n}=r.style;m===""&&(m=1.5);const d=u.split(`
`).length*m*_;return n>d?n:d};return(r,u)=>(p(),v("div",{class:G(["editor",{edit:e.isEdit}]),id:"editor",style:H({width:g(t).editorState.canvasStyleData.width+"px",height:g(t).editorState.canvasStyleData.height+"px"}),onContextmenu:a},[(p(!0),v(U,null,$(g(t).editorState.componentData,(m,_)=>(p(),k(Ge,{defaultStyle:m.style,style:H(l(m.style)),key:m.id,active:m===g(t).editorState.curComponent,element:m,index:_},{default:x(()=>[m.component!="v-text"?(p(),k(J(m.component),{key:0,class:"component",style:H(o(m.style)),propValue:m.propValue},null,8,["style","propValue"])):(p(),k(J(m.component),{key:1,class:"component",style:H(o(m.style)),propValue:m.propValue,onInput:h,element:m},null,40,["style","propValue","element"]))]),_:2},1032,["defaultStyle","style","active","element","index"]))),128)),y(Re),y(Ee)],38))}});const Ze=N(Qe,[["__scopeId","data-v-e5128159"]]),oe={redirect(e){e&&(window.location.href=e)},alert(e){e&&alert(e)}};oe.redirect,oe.alert;const et=R({__name:"ComponentWrapper",props:{config:{}},setup(e){const t=e,a=pe();ae(()=>{a.value!==void 0&&he(a.value,t.config.animations)});const l=()=>{const o=t.config.events;Object.keys(o).forEach(h=>{oe[h](o[h])})};return(o,h)=>(p(),v("div",{onClick:l,ref_key:"wrapperDom",ref:a},[(p(),k(J(o.config.component),{class:"component",style:H(g(fe)(o.config.style)),propValue:o.config.propValue},null,8,["style","propValue"]))],512))}});const tt=N(et,[["__scopeId","data-v-f6fda919"]]),ot={key:0,class:"bg"},nt={class:"canvas-container"},at=R({__name:"Preview",props:{show:{type:Boolean}},emits:["update:show"],setup(e,{emit:t}){const a=B.editorStore.editorState,l=()=>{t("update:show",!1)};return(o,h)=>{const c=L("el-button");return o.show?(p(),v("div",ot,[y(c,{onClick:l,class:"close"},{default:x(()=>[E("关闭")]),_:1}),M("div",nt,[M("div",{class:"canvas",style:H({width:g(a).canvasStyleData.width+"px",height:g(a).canvasStyleData.height+"px"})},[(p(!0),v(U,null,$(g(a).componentData,(r,u)=>(p(),k(tt,{key:u,config:r},null,8,["config"]))),128))],4)])])):A("",!0)}}});const lt=N(at,[["__scopeId","data-v-405e2576"]]),ie=e=>(be("data-v-89261d27"),e=e(),ye(),e),it={class:"toolbar"},st=ie(()=>M("label",{for:"input",class:"insert"},"插入图片",-1)),rt={class:"canvas-config"},ct=ie(()=>M("span",null,"画布大小",-1)),ut=ie(()=>M("span",null,"*",-1)),dt=R({__name:"Toolbar",setup(e){const t=B.editorStore,a=z({isShowPreview:!1}),l=()=>{t.undo()},o=()=>{t.redo()},h=_=>{const n=_.target.files[0];if(!n.type.includes("image")){ve("只能插入图片");return}const d=new FileReader;d.onload=s=>{const i=s.target.result,f=new Image;f.onload=()=>{t.addComponent({component:{id:te(),component:"v-picture",label:"图片",icon:"",propValue:i,animations:[],events:[],style:{top:0,left:0,width:f.width,height:f.height,rotate:""}},index:void 0})},f.src=i},d.readAsDataURL(n)},c=()=>{a.isShowPreview=!0,t.setEditMode("read")},r=()=>{t.setEditMode("edit")},u=()=>{localStorage.setItem("canvasData",JSON.stringify(t.editorState.componentData)),localStorage.setItem("canvasStyle",JSON.stringify(t.editorState.canvasStyleData)),ge.success("保存成功")},m=()=>{t.setComponentData([])};return(_,n)=>{const d=L("el-button");return p(),v("div",it,[y(d,{onClick:l},{default:x(()=>[E("撤消")]),_:1}),y(d,{onClick:o},{default:x(()=>[E("重做")]),_:1}),st,M("input",{type:"file",onChange:h,id:"input",hidden:""},null,32),y(d,{onClick:c,style:{"margin-left":"10px"}},{default:x(()=>[E("预览")]),_:1}),y(d,{onClick:u},{default:x(()=>[E("保存")]),_:1}),y(d,{onClick:m},{default:x(()=>[E("清空画布")]),_:1}),M("div",rt,[ct,j(M("input",{"onUpdate:modelValue":n[0]||(n[0]=s=>g(t).editorState.canvasStyleData.width=s)},null,512),[[re,g(t).editorState.canvasStyleData.width]]),ut,j(M("input",{"onUpdate:modelValue":n[1]||(n[1]=s=>g(t).editorState.canvasStyleData.height=s)},null,512),[[re,g(t).editorState.canvasStyleData.height]])]),y(lt,{show:a.isShowPreview,"onUpdate:show":n[2]||(n[2]=s=>a.isShowPreview=s),onChange:r},null,8,["show"])])}}});const pt=N(dt,[["__scopeId","data-v-89261d27"]]),de=[{label:"进入",children:[{label:"渐显",value:"fadeIn"},{label:"向右进入",value:"fadeInLeft"},{label:"向左进入",value:"fadeInRight"},{label:"向上进入",value:"fadeInUp"},{label:"向下进入",value:"fadeInDown"},{label:"向右长距进入",value:"fadeInLeftBig"},{label:"向左长距进入",value:"fadeInRightBig"},{label:"向上长距进入",value:"fadeInUpBig"},{label:"向下长距进入",value:"fadeInDownBig"},{label:"旋转进入",value:"rotateIn"},{label:"左顺时针旋转",value:"rotateInDownLeft"},{label:"右逆时针旋转",value:"rotateInDownRight"},{label:"左逆时针旋转",value:"rotateInUpLeft"},{label:"右逆时针旋转",value:"rotateInUpRight"},{label:"弹入",value:"bounceIn"},{label:"向右弹入",value:"bounceInLeft"},{label:"向左弹入",value:"bounceInRight"},{label:"向上弹入",value:"bounceInUp"},{label:"向下弹入",value:"bounceInDown"},{label:"光速从右进入",value:"lightSpeedInRight"},{label:"光速从左进入",value:"lightSpeedInLeft"},{label:"光速从右退出",value:"lightSpeedOutRight"},{label:"光速从左退出",value:"lightSpeedOutLeft"},{label:"Y轴旋转",value:"flip"},{label:"中心X轴旋转",value:"flipInX"},{label:"中心Y轴旋转",value:"flipInY"},{label:"左长半径旋转",value:"rollIn"},{label:"由小变大进入",value:"zoomIn"},{label:"左变大进入",value:"zoomInLeft"},{label:"右变大进入",value:"zoomInRight"},{label:"向上变大进入",value:"zoomInUp"},{label:"向下变大进入",value:"zoomInDown"},{label:"向右滑动展开",value:"slideInLeft"},{label:"向左滑动展开",value:"slideInRight"},{label:"向上滑动展开",value:"slideInUp"},{label:"向下滑动展开",value:"slideInDown"}]},{label:"强调",children:[{label:"弹跳",value:"bounce"},{label:"闪烁",value:"flash"},{label:"放大缩小",value:"pulse"},{label:"放大缩小弹簧",value:"rubberBand"},{label:"左右晃动",value:"headShake"},{label:"左右扇形摇摆",value:"swing"},{label:"放大晃动缩小",value:"tada"},{label:"扇形摇摆",value:"wobble"},{label:"左右上下晃动",value:"jello"},{label:"Y轴旋转",value:"flip"}]},{label:"退出",children:[{label:"渐隐",value:"fadeOut"},{label:"向左退出",value:"fadeOutLeft"},{label:"向右退出",value:"fadeOutRight"},{label:"向上退出",value:"fadeOutUp"},{label:"向下退出",value:"fadeOutDown"},{label:"向左长距退出",value:"fadeOutLeftBig"},{label:"向右长距退出",value:"fadeOutRightBig"},{label:"向上长距退出",value:"fadeOutUpBig"},{label:"向下长距退出",value:"fadeOutDownBig"},{label:"旋转退出",value:"rotateOut"},{label:"左顺时针旋转",value:"rotateOutDownLeft"},{label:"右逆时针旋转",value:"rotateOutDownRight"},{label:"左逆时针旋转",value:"rotateOutUpLeft"},{label:"右逆时针旋转",value:"rotateOutUpRight"},{label:"弹出",value:"bounceOut"},{label:"向左弹出",value:"bounceOutLeft"},{label:"向右弹出",value:"bounceOutRight"},{label:"向上弹出",value:"bounceOutUp"},{label:"向下弹出",value:"bounceOutDown"},{label:"中心X轴旋转",value:"flipOutX"},{label:"中心Y轴旋转",value:"flipOutY"},{label:"左长半径旋转",value:"rollOut"},{label:"由小变大退出",value:"zoomOut"},{label:"左变大退出",value:"zoomOutLeft"},{label:"右变大退出",value:"zoomOutRight"},{label:"向上变大退出",value:"zoomOutUp"},{label:"向下变大退出",value:"zoomOutDown"},{label:"向左滑动收起",value:"slideOutLeft"},{label:"向右滑动收起",value:"slideOutRight"},{label:"向上滑动收起",value:"slideOutUp"},{label:"向下滑动收起",value:"slideOutDown"}]}],ht={class:"animation-list"},ft={key:0,class:"div-animation"},mt={class:"el-scrollbar-view"},_t=["onMouseover","onClick"],vt=R({__name:"AnimationList",setup(e){const t=B.editorStore,a=z({isShowAnimation:!1,animationClassData:de,animationActiveName:"进入",showAnimatePanel:!1,hoverPreviewAnimate:""}),l=c=>{t.addAnimation(c),a.isShowAnimation=!1},o=()=>{X.emit("runAnimation")},h=c=>{t.removeAnimation(c)};return(c,r)=>{const u=L("el-button"),m=L("el-tag"),_=L("el-scrollbar"),n=L("el-tab-pane"),d=L("el-tabs"),s=L("Modal");return p(),v("div",ht,[g(t).editorState.curComponent?(p(),v("div",ft,[y(u,{onClick:r[0]||(r[0]=i=>{a.isShowAnimation=!0})},{default:x(()=>[E("添加动画")]),_:1}),y(u,{onClick:o},{default:x(()=>[E("预览动画")]),_:1}),M("div",null,[(p(!0),v(U,null,$(g(t).editorState.curComponent.animations,(i,f)=>(p(),k(m,{key:f,closable:"",onClose:b=>h(f)},{default:x(()=>[E(ee(i.label),1)]),_:2},1032,["onClose"]))),128))])])):A("",!0),y(s,{show:a.isShowAnimation,"onUpdate:show":r[2]||(r[2]=i=>a.isShowAnimation=i)},{default:x(()=>[y(d,{type:"card",modelValue:a.animationActiveName,"onUpdate:modelValue":r[1]||(r[1]=i=>a.animationActiveName=i)},{default:x(()=>[(p(!0),v(U,null,$(g(de),i=>(p(),k(n,{key:i.label,label:i.label,name:i.label},{default:x(()=>[y(_,{class:"animate-container"},{default:x(()=>[M("div",mt,[(p(!0),v(U,null,$(i.children,(f,b)=>(p(),v("div",{class:"animate",key:b,onMouseover:w=>a.hoverPreviewAnimate=f.value,onClick:w=>l(f)},[M("div",{class:G([a.hoverPreviewAnimate===f.value&&"animate__animated animate__"+f.value])},ee(f.label),3)],40,_t))),128))])]),_:2},1024)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["show"])])}}});const gt=N(vt,[["__scopeId","data-v-c2f72d3f"]]),bt={class:"home"},yt={class:"left"},St={class:"center"},xt={class:"right"},wt={key:1,class:"placeholder"},Ct={key:1,class:"placeholder"},Mt={key:1,class:"placeholder"},kt=R({__name:"Home",setup(e){const t=B.editorStore,a=z({activeName:"attr",reSelectAnimateIndex:void 0}),l=()=>{localStorage.getItem("canvasData")&&t.setComponentData(h(JSON.parse(localStorage.getItem("canvasData")))),localStorage.getItem("canvasStyle")&&t.setCanvasStyle(JSON.parse(localStorage.getItem("canvasStyle")))},o=()=>{let s=!1;window.onkeydown=i=>{i.keyCode==17?s=!0:s&&i.keyCode==67?t.copy():s&&i.keyCode==86?t.paste(!1):s&&i.keyCode==88&&t.cut()},window.onkeyup=i=>{i.keyCode==17&&(s=!1)}},h=m=>(m.forEach(_=>{_.id=te()}),m),c=m=>{m.preventDefault(),m.stopPropagation();const _=Se.cloneDeep(le[m.dataTransfer.getData("index")]);_.style.top=m.offsetY,_.style.left=m.offsetX,_.id=te(),t.addComponent({component:_,index:void 0}),t.recordSnapshot()},r=m=>{m.preventDefault(),m.dataTransfer.dropEffect="copy"},u=()=>{t.setCurComponent({component:null,index:null}),t.hideContextMenu()};return l(),o(),(m,_)=>{const n=L("el-tab-pane"),d=L("EventList"),s=L("el-tabs");return p(),v("div",bt,[y(pt),M("main",null,[M("section",yt,[y(De)]),M("section",St,[M("div",{class:"content",onDrop:c,onDragover:r,onClick:u},[y(Ze)],32)]),M("section",xt,[y(s,{modelValue:a.activeName,"onUpdate:modelValue":_[0]||(_[0]=i=>a.activeName=i),type:"card"},{default:x(()=>[y(n,{label:"属性",name:"attr"},{default:x(()=>[g(t).editorState.curComponent?(p(),k(Ve,{key:0})):(p(),v("p",wt,"请选择组件"))]),_:1}),y(n,{label:"动画",name:"animation"},{default:x(()=>[g(t).editorState.curComponent?(p(),k(gt,{key:0})):(p(),v("p",Ct,"请选择组件"))]),_:1}),y(n,{label:"事件",name:"events"},{default:x(()=>[g(t).editorState.curComponent?(p(),k(d,{key:0})):(p(),v("p",Mt,"请选择组件"))]),_:1})]),_:1},8,["modelValue"])])])])}}});const Dt=N(kt,[["__scopeId","data-v-af42b5d0"]]);export{Dt as default};
