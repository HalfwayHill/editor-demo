import{d as O,o as f,c as S,F as R,r as B,a as D,b as K,e as C,t as Q,u as b,l as ce,_ as E,f as W,g as ie,h as I,i as w,w as k,j as G,k as H,m as F,v as Z,n as z,p as ee,q as T,s as ae,x as J,y as q,z as M,A as ue,B as oe,C as de,D as _e,E as pe,$ as ve,G as V,H as ne,I as ge,J as ye,K as le,L as be,M as Se,N as xe,O as we,P as Ce,Q as ke}from"./index-409639b0.js";const Me={class:"component-list"},Le=["data-index"],De=O({__name:"ComponentList",setup(n){const e=o=>{o.dataTransfer.setData("index",o.target.dataset.index)};return(o,_)=>(f(),S("div",Me,[(f(!0),S(R,null,B(b(ce),(l,d)=>(f(),S("div",{key:d,class:"item",draggable:"true",onDragstart:_[0]||(_[0]=p=>e(p)),"data-index":d},[(f(),D(K(l.icon),{class:"icon"})),C("span",null,Q(l.label),1)],40,Le))),128))]))}});const Ie=E(De,[["__scopeId","data-v-c47933ae"]]),Pe={class:"attr-list"},Ve=O({__name:"AttrList",setup(n){const e=H.editorStore,o=W({excludes:["VPicture","VGroup"],options:[{label:"左对齐",value:"left"},{label:"居中",value:"center"},{label:"右对齐",value:"right"}],map:{left:"x 坐标",top:"y 坐标",height:"高",width:"宽",color:"颜色",backgroundColor:"背景色",borderWidth:"边框宽度",borderColor:"边框颜色",borderRadius:"边框半径",fontSize:"字体大小",fontWeight:"字体粗细",lineHeight:"行高",letterSpacing:"字间距",textAlign:"对齐方式",opacity:"透明度"}}),_=ie(()=>e.editorState.curComponent?Object.keys(e.editorState.curComponent.style):[]),l=ie(()=>e.editorState.curComponent);return(d,p)=>{const m=I("el-color-picker"),r=I("el-option"),s=I("el-select"),a=I("el-input"),v=I("el-form-item"),h=I("el-form");return f(),S("div",Pe,[w(h,null,{default:k(()=>[(f(!0),S(R,null,B(_.value.filter(t=>t!="rotate"),(t,i)=>(f(),D(v,{key:i,label:o.map[t]},{default:k(()=>[t=="borderColor"?(f(),D(m,{key:0,modelValue:l.value.style[t],"onUpdate:modelValue":u=>l.value.style[t]=u},null,8,["modelValue","onUpdate:modelValue"])):t=="color"?(f(),D(m,{key:1,modelValue:l.value.style[t],"onUpdate:modelValue":u=>l.value.style[t]=u},null,8,["modelValue","onUpdate:modelValue"])):t=="backgroundColor"?(f(),D(m,{key:2,modelValue:l.value.style[t],"onUpdate:modelValue":u=>l.value.style[t]=u},null,8,["modelValue","onUpdate:modelValue"])):t=="textAlign"?(f(),D(s,{key:3,modelValue:l.value.style[t],"onUpdate:modelValue":u=>l.value.style[t]=u},{default:k(()=>[(f(!0),S(R,null,B(o.options,u=>(f(),D(r,{key:u.value,label:u.label,value:u.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):(f(),D(a,{key:4,type:"number",modelValue:l.value.style[t],"onUpdate:modelValue":u=>l.value.style[t]=u},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["label"]))),128)),l.value&&!o.excludes.includes(l.value.component)?(f(),D(v,{key:0,label:"内容"},{default:k(()=>[w(a,{type:"textarea",modelValue:l.value.propValue,"onUpdate:modelValue":p[0]||(p[0]=t=>l.value.propValue=t)},null,8,["modelValue"])]),_:1})):G("",!0)]),_:1})])}}});const Ae=E(Ve,[["__scopeId","data-v-8c0b3edf"]]),Ne=O({__name:"ContextMenu",setup(n){const e=H.editorStore;W({copyData:null});const o=()=>{e.setClickComponentStatus(!0)},_=()=>{e.copy()},l=()=>{e.paste(!0),e.recordSnapshot()},d=()=>{e.cut()},p=()=>{e.deleteComponent(),e.recordSnapshot()},m=()=>{e.upComponent(),e.recordSnapshot()},r=()=>{e.downComponent(),e.recordSnapshot()},s=()=>{e.topComponent(),e.recordSnapshot()},a=()=>{e.bottomComponent(),e.recordSnapshot()};return(v,h)=>F((f(),S("div",{class:"contextmenu",style:z({top:b(e).editorState.menuTop+"px",left:b(e).editorState.menuLeft+"px"})},[C("ul",{onMouseup:o},[b(e).editorState.curComponent?(f(),S(R,{key:0},[C("li",{onClick:_},"复制"),C("li",{onClick:l},"粘贴"),C("li",{onClick:d},"剪切"),C("li",{onClick:p},"删除"),C("li",{onClick:s},"置顶"),C("li",{onClick:a},"置底"),C("li",{onClick:m},"上移"),C("li",{onClick:r},"下移")],64)):(f(),S("li",{key:1,onClick:l},"粘贴"))],32)],4)),[[Z,b(e).editorState.menuShow]])}});const Oe=E(Ne,[["__scopeId","data-v-13e169ce"]]),Ee={class:"mark-line"},$e=O({__name:"MarkLine",setup(n){const e=H.editorStore,o=new Map,_=(a,v)=>{a&&o.set(v,a)},l=W({lines:["xt","xc","xb","yl","yc","yr"],diff:3,lineStatus:{xt:!1,xc:!1,xb:!1,yl:!1,yc:!1,yr:!1}});ee(()=>{T.on("move",a=>{p(a.isDownward,a.isRightward)}),T.on("unMove",()=>{d()})});const d=()=>{Object.keys(l.lineStatus).forEach(a=>{l.lineStatus[a]=!1})},p=(a,v)=>{const h=e.editorState.componentData,t=ae(e.editorState.curComponent.style),i=t.width/2,u=t.height/2;d(),h.forEach(g=>{if(g==e.editorState.curComponent)return;const y=ae(g.style),{top:c,left:x,bottom:L,right:P}=y,$=y.width/2,A=y.height/2,N={top:[{isNearly:s(t.top,c),lineNode:o.get("xt"),line:"xt",dragShift:c,lineShift:c},{isNearly:s(t.bottom,c),lineNode:o.get("xt"),line:"xt",dragShift:c-t.height,lineShift:c},{isNearly:s(t.top+u,c+A),lineNode:o.get("xc"),line:"xc",dragShift:c+A-u,lineShift:c+A},{isNearly:s(t.top,L),lineNode:o.get("xb"),line:"xb",dragShift:L,lineShift:L},{isNearly:s(t.bottom,L),lineNode:o.get("xb"),line:"xb",dragShift:L-t.height,lineShift:L}],left:[{isNearly:s(t.left,x),lineNode:o.get("yl"),line:"yl",dragShift:x,lineShift:x},{isNearly:s(t.right,x),lineNode:o.get("yl"),line:"yl",dragShift:x-t.width,lineShift:x},{isNearly:s(t.left+i,x+$),lineNode:o.get("yc"),line:"yc",dragShift:x+$-i,lineShift:x+$},{isNearly:s(t.left,P),lineNode:o.get("yr"),line:"yr",dragShift:P,lineShift:P},{isNearly:s(t.right,P),lineNode:o.get("yr"),line:"yr",dragShift:P-t.width,lineShift:P}]},U=[],{rotate:X}=e.editorState.curComponent.style;Object.keys(N).forEach(Y=>{N[Y].forEach(j=>{j.isNearly&&(e.setShapeSingleStyle({key:Y,value:X!=0?m(Y,j,t):j.dragShift}),j.lineNode.style[Y]=`${j.lineShift}px`,U.push(j.line))})}),U.length&&r(U,a,v)})},m=(a,v,h)=>{const{width:t,height:i}=e.editorState.curComponent.style;return a=="top"?Math.round(v.dragShift-(i-h.height)/2):Math.round(v.dragShift-(t-h.width)/2)},r=(a,v,h)=>{h?a.includes("yr")?l.lineStatus.yr=!0:a.includes("yc")?l.lineStatus.yc=!0:a.includes("yl")&&(l.lineStatus.yl=!0):a.includes("yl")?l.lineStatus.yl=!0:a.includes("yc")?l.lineStatus.yc=!0:a.includes("yr")&&(l.lineStatus.yr=!0),v?a.includes("xb")?l.lineStatus.xb=!0:a.includes("xc")?l.lineStatus.xc=!0:a.includes("xt")&&(l.lineStatus.xt=!0):a.includes("xt")?l.lineStatus.xt=!0:a.includes("xc")?l.lineStatus.xc=!0:a.includes("xb")&&(l.lineStatus.xb=!0)},s=(a,v)=>Math.abs(a-v)<=l.diff;return(a,v)=>(f(),S("div",Ee,[(f(!0),S(R,null,B(l.lines,h=>F((f(),S("div",{key:h,class:J(["line",h.includes("x")?"xline":"yline"]),ref_for:!0,ref:t=>_(t,h)},null,2)),[[Z,l.lineStatus[h]||!1]])),128))]))}});const Re=E($e,[["__scopeId","data-v-ffbd92d2"]]);async function he(n,e=[]){if(n){const o=_=>new Promise(l=>{n.classList.add("animate__animated","animate__"+_.value);const d=()=>{n.removeEventListener("animationend",d),n.removeEventListener("animationcancel",d),n.classList.remove("animate__animated","animate__"+_.value),l()};n.addEventListener("animationend",d),n.addEventListener("animationcancel",d)});for(let _=0,l=e.length;_<l;_++)await o(e[_])}else console.log("runAnimation el为空")}const Ue={lt:Be,t:He,rt:Ye,r:ze,rb:Xe,b:We,lb:Te,l:je};function Be(n,e,o,_,l){const{symmetricPoint:d}=l;let p=q(e,d),m=M(e,p,-n.rotate),r=M(d,p,-n.rotate),s=r.x-m.x,a=r.y-m.y;if(_){s/a>o?(m.x+=Math.abs(s-a*o),s=a*o):(m.y+=Math.abs(a-s/o),a=s/o);const v=M(m,p,n.rotate);p=q(v,d),m=M(v,p,-n.rotate),r=M(d,p,-n.rotate),s=r.x-m.x,a=r.y-m.y}s>0&&a>0&&(n.width=Math.round(s),n.height=Math.round(a),n.left=Math.round(m.x),n.top=Math.round(m.y))}function Ye(n,e,o,_,l){const{symmetricPoint:d}=l;let p=q(e,d),m=M(e,p,-n.rotate),r=M(d,p,-n.rotate),s=m.x-r.x,a=r.y-m.y;if(_){s/a>o?(m.x-=Math.abs(s-a*o),s=a*o):(m.y+=Math.abs(a-s/o),a=s/o);const v=M(m,p,n.rotate);p=q(v,d),m=M(v,p,-n.rotate),r=M(d,p,-n.rotate),s=m.x-r.x,a=r.y-m.y}s>0&&a>0&&(n.width=Math.round(s),n.height=Math.round(a),n.left=Math.round(r.x),n.top=Math.round(m.y))}function Xe(n,e,o,_,l){const{symmetricPoint:d}=l;let p=q(e,d),m=M(d,p,-n.rotate),r=M(e,p,-n.rotate),s=r.x-m.x,a=r.y-m.y;if(_){s/a>o?(r.x-=Math.abs(s-a*o),s=a*o):(r.y-=Math.abs(a-s/o),a=s/o);const v=M(r,p,n.rotate);p=q(v,d),m=M(d,p,-n.rotate),r=M(v,p,-n.rotate),s=r.x-m.x,a=r.y-m.y}s>0&&a>0&&(n.width=Math.round(s),n.height=Math.round(a),n.left=Math.round(m.x),n.top=Math.round(m.y))}function Te(n,e,o,_,l){const{symmetricPoint:d}=l;let p=q(e,d),m=M(d,p,-n.rotate),r=M(e,p,-n.rotate),s=m.x-r.x,a=r.y-m.y;if(_){s/a>o?(r.x+=Math.abs(s-a*o),s=a*o):(r.y-=Math.abs(a-s/o),a=s/o);const v=M(r,p,n.rotate);p=q(v,d),m=M(d,p,-n.rotate),r=M(v,p,-n.rotate),s=m.x-r.x,a=r.y-m.y}s>0&&a>0&&(n.width=Math.round(s),n.height=Math.round(a),n.left=Math.round(r.x),n.top=Math.round(m.y))}function He(n,e,o,_,l){const{symmetricPoint:d,curPoint:p}=l,m=M(e,p,-n.rotate),r=M({x:p.x,y:m.y},p,n.rotate),s=Math.sqrt((r.x-d.x)**2+(r.y-d.y)**2);if(s>0){const a={x:r.x-(r.x-d.x)/2,y:r.y+(d.y-r.y)/2};let v=n.width;_&&(v=s*o),n.width=v,n.height=Math.round(s),n.top=Math.round(a.y-s/2),n.left=Math.round(a.x-n.width/2)}}function ze(n,e,o,_,l){const{symmetricPoint:d,curPoint:p}=l,m=M(e,p,-n.rotate),r=M({x:m.x,y:p.y},p,n.rotate),s=Math.sqrt((r.x-d.x)**2+(r.y-d.y)**2);if(s>0){const a={x:r.x-(r.x-d.x)/2,y:r.y+(d.y-r.y)/2};let v=n.height;_&&(v=s/o),n.height=v,n.width=Math.round(s),n.top=Math.round(a.y-n.height/2),n.left=Math.round(a.x-s/2)}}function We(n,e,o,_,l){const{symmetricPoint:d,curPoint:p}=l,m=M(e,p,-n.rotate),r=M({x:p.x,y:m.y},p,n.rotate),s=Math.sqrt((r.x-d.x)**2+(r.y-d.y)**2);if(s>0){const a={x:r.x-(r.x-d.x)/2,y:r.y+(d.y-r.y)/2};let v=n.width;_&&(v=s*o),n.width=v,n.height=Math.round(s),n.top=Math.round(a.y-s/2),n.left=Math.round(a.x-n.width/2)}}function je(n,e,o,_,l){const{symmetricPoint:d,curPoint:p}=l,m=M(e,p,-n.rotate),r=M({x:m.x,y:p.y},p,n.rotate),s=Math.sqrt((r.x-d.x)**2+(r.y-d.y)**2);if(s>0){const a={x:r.x-(r.x-d.x)/2,y:r.y+(d.y-r.y)/2};let v=n.height;_&&(v=s/o),n.height=v,n.width=Math.round(s),n.top=Math.round(a.y-n.height/2),n.left=Math.round(a.x-s/2)}}function qe(n,e,o,_,l,d){Ue[n](e,o,_,l,d)}const Ge=["onMousedown"],Fe=O({__name:"ShapeComponent",props:{active:{type:Boolean,default:!1},element:{require:!0,type:Object},defaultStyle:{require:!0,type:Object},index:{require:!0,type:[Number,String]}},setup(n){const e=n,o=H.editorStore,_=ue(),l=W({pointList:["lt","t","rt","r","rb","b","lb","l"],initialAngle:{lt:0,t:45,rt:90,r:135,rb:180,b:225,lb:270,l:315},angleToCursor:[{start:338,end:23,cursor:"nw"},{start:23,end:68,cursor:"n"},{start:68,end:113,cursor:"ne"},{start:113,end:158,cursor:"e"},{start:158,end:203,cursor:"se"},{start:203,end:248,cursor:"s"},{start:248,end:293,cursor:"sw"},{start:293,end:338,cursor:"w"}],cursors:{}});ee(()=>{o.editorState.curComponent&&(l.cursors=r()),T.on("runAnimation",()=>{e.element===o.getCurComponent&&_.value!==void 0&&he(_.value,o.getCurComponent.animations)})});const d=()=>{var t;return e.active&&!((t=e.element)!=null&&t.isLock)},p=t=>{var U;o.setClickComponentStatus(!0),t.preventDefault(),t.stopPropagation();const i={...e.defaultStyle},u=t.clientY,g=t.clientX,y=i.rotate,c=(U=_.value)==null?void 0:U.getBoundingClientRect(),x=(c==null?void 0:c.left)+(c==null?void 0:c.width)/2,L=(c==null?void 0:c.top)+(c==null?void 0:c.height)/2,P=Math.atan2(u-L,g-x)/(Math.PI/180);let $=!1;const A=X=>{$=!0;const Y=X.clientX,j=X.clientY,fe=Math.atan2(j-L,Y-x)/(Math.PI/180);i.rotate=y+fe-P,o.setShapeStyle(i)},N=()=>{$&&o.recordSnapshot(),document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",N),l.cursors=r()};document.addEventListener("mousemove",A),document.addEventListener("mouseup",N)},m=t=>{var A,N;const i=(A=e.defaultStyle)==null?void 0:A.height,u=(N=e.defaultStyle)==null?void 0:N.width,g=/t/.test(t),y=/b/.test(t),c=/l/.test(t),x=/r/.test(t);let L=0,P=0;return t.length===2?(L=c?0:u,P=g?0:i):((g||y)&&(L=u/2,P=g?0:i),(c||x)&&(L=c?0:u,P=Math.floor(i/2))),{marginLeft:"-4px",marginTop:"-4px",left:`${L}px`,top:`${P}px`,cursor:l.cursors[t]}},r=()=>{const t=oe(o.editorState.curComponent.style.rotate),i={};let u=-1;return l.pointList.forEach(g=>{const y=oe(l.initialAngle[g]+t),c=l.angleToCursor.length;for(;;){u=(u+1)%c;const x=l.angleToCursor[u];if(y<23||y>=338){i[g]="nw-resize";return}if(x.start<=y&&y<x.end){i[g]=x.cursor+"-resize";return}}}),i},s=t=>{var $,A,N;if(o.setClickComponentStatus(!0),(($=e.element)==null?void 0:$.component)!="v-text"&&((A=e.element)==null?void 0:A.component)!="rect-shape"&&t.preventDefault(),t.stopPropagation(),o.setCurComponent({component:e.element,index:e.index}),(N=e.element)!=null&&N.isLock)return;l.cursors=r();const i={...e.defaultStyle},u=t.clientY,g=t.clientX,y=Number(i.top),c=Number(i.left);let x=!1;const L=U=>{x=!0;const X=U.clientX,Y=U.clientY;i.top=Y-u+y,i.left=X-g+c,o.setShapeStyle(i),_e(()=>{T.emit("move",{isDownward:Y-u>0,isRightward:X-g>0})})},P=()=>{x&&o.recordSnapshot(),T.emit("unMove"),document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",P)};document.addEventListener("mousemove",L),document.addEventListener("mouseup",P)},a=t=>{t.stopPropagation(),t.preventDefault(),o.hideContextMenu()},v=(t,i)=>{o.setClickComponentStatus(!0),i.stopPropagation(),i.preventDefault();const u={...e.defaultStyle},g=u.width/u.height,y={x:u.left+u.width/2,y:u.top+u.height/2},c=o.editorState.editor.getBoundingClientRect(),x={x:i.clientX-(c==null?void 0:c.left),y:i.clientY-(c==null?void 0:c.top)},L={x:y.x-(x.x-y.x),y:y.y-(x.y-y.y)};let P=!1,$=!0;const A=h(),N=X=>{if($){$=!1;return}P=!0;const Y={x:X.clientX-(c==null?void 0:c.left),y:X.clientY-(c==null?void 0:c.top)};qe(t,u,Y,g,A,{center:y,curPoint:x,symmetricPoint:L}),o.setShapeStyle(u)},U=()=>{document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",U),P&&o.recordSnapshot()};document.addEventListener("mousemove",N),document.addEventListener("mouseup",U)},h=()=>{var i;if(((i=e.element)==null?void 0:i.component)!="Group")return!1;const t=[0,90,180,360];for(const u of e.element.propValue)if(!t.includes(oe(parseInt(u.style.rotate))))return!0;return!1};return(t,i)=>{const u=I("RefreshRight"),g=I("el-icon");return f(),S("div",{ref_key:"thisRef",ref:_,class:J(["shape",{active:n.active}]),onClick:a,onMousedown:s},[F(w(g,{class:"el-icon-refresh-right",onMousedown:p},{default:k(()=>[w(u)]),_:1},512),[[Z,d()]]),(f(!0),S(R,null,B(d()?l.pointList:[],y=>(f(),S("div",{class:"shape-point",onMousedown:c=>v(y,c),key:y,style:z(m(y))},null,44,Ge))),128)),de(t.$slots,"default",{},void 0,!0)],34)}}});const Je=E(Fe,[["__scopeId","data-v-a349e65a"]]),Ke=O({__name:"AreaComponent",props:{start:{type:Object},width:{type:Number},height:{type:Number}},setup(n){return(e,o)=>(f(),S("div",{style:z({left:n.start.x+"px",top:n.start.y+"px",width:n.width+"px",height:n.height+"px"}),class:"area"},null,4))}});const Qe=E(Ke,[["__scopeId","data-v-b92f54dd"]]),Ze=O({__name:"EditorComponent",props:{isEdit:{type:Boolean,default:!0}},setup(n){const e=W({editorX:0,editorY:0,start:{x:0,y:0},width:0,height:0,isShowArea:!1}),o=H.editorStore;ee(()=>{o.getEditor();const h=o.editorState.editor.getBoundingClientRect();e.editorX=h.x,e.editorY=h.y,T.on("hideArea",()=>{l()})});const _=h=>{const t=o.editorState.curComponent;(!t||t.component!="v-text"&&t.component!="rect-shape")&&h.preventDefault(),l();const i=h.clientX,u=h.clientY;e.start.x=i-e.editorX,e.start.y=u-e.editorY,e.isShowArea=!0;const g=c=>{e.width=Math.abs(c.clientX-i),e.height=Math.abs(c.clientY-u),c.clientX<i&&(e.start.x=c.clientX-e.editorX),c.clientY<u&&(e.start.y=c.clientY-e.editorY)},y=c=>{if(document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",y),c.clientX==i&&c.clientY==u){l();return}d()};document.addEventListener("mousemove",g),document.addEventListener("mouseup",y)},l=()=>{e.isShowArea=!1,e.width=0,e.height=0},d=()=>{const h=p();if(h.length<=1){l();return}let t=1/0,i=1/0,u=-1/0,g=-1/0;h.forEach(y=>{let c={};y.component=="VGroup"?y.propValue.forEach(x=>{const L=ve(`#component${x.id}`).getBoundingClientRect();c.left=L.left-e.editorX,c.top=L.top-e.editorY,c.right=L.right-e.editorX,c.bottom=L.bottom-e.editorY,c.left<i&&(i=c.left),c.top<t&&(t=c.top),c.right>u&&(u=c.right),c.bottom>g&&(g=c.bottom)}):c=ae(y.style),c.left<i&&(i=c.left),c.top<t&&(t=c.top),c.right>u&&(u=c.right),c.bottom>g&&(g=c.bottom)}),e.start.x=i,e.start.y=t,e.width=u-i,e.height=g-t,o.setAreaData({style:{left:i,top:t,width:e.width,height:e.height},components:h})},p=()=>{const h=[],{x:t,y:i}=e.start;return o.editorState.componentData.forEach(u=>{if(u.isLock)return;const{left:g,top:y,width:c,height:x}=u.style;t<=g&&i<=y&&g+c<=t+e.width&&y+x<=i+e.height&&h.push(u)}),h},m=h=>{h.stopPropagation(),h.preventDefault();let t=h.target,i=h.offsetY,u=h.offsetX;for(;!t.className.includes("editor");)u+=t.offsetLeft,i+=t.offsetTop,t=t.parentNode;o.showContextMenu({top:i,left:u})},r=h=>{const t={};return["width","height","top","left","rotate"].forEach(i=>{i!="rotate"?t[i]=h[i]+"px":t.transform="rotate("+h[i]+"deg)"}),t},s=h=>pe(h,["top","left","width","height","rotate"]),a=(h,t)=>{o.setShapeStyle({height:v(h,t)})},v=(h,t)=>{let{lineHeight:i,fontSize:u,height:g}=h.style;i===""&&(i=1.5);const y=(t.split("<br>").length-1)*i*u;return g>y?g:y};return(h,t)=>(f(),S("div",{class:J(["editor",{edit:n.isEdit}]),id:"editor",style:z({width:b(o).editorState.canvasStyleData.width+"px",height:b(o).editorState.canvasStyleData.height+"px",transform:"scale("+b(o).editorState.canvasStyleData.scale/100+")"}),onContextmenu:m,onMousedown:_},[(f(!0),S(R,null,B(b(o).editorState.componentData,(i,u)=>(f(),D(Je,{defaultStyle:i.style,style:z(r(i.style)),key:i.id,active:i===b(o).editorState.curComponent,element:i,index:u,class:J({lock:i.isLock})},{default:k(()=>[i.component!="v-text"?(f(),D(K(i.component),{key:0,class:"component",style:z(s(i.style)),propValue:i.propValue,element:i,id:"component"+i.id},null,8,["style","propValue","element","id"])):(f(),D(K(i.component),{key:1,class:"component",style:z(s(i.style)),propValue:i.propValue,onInput:a,element:i,id:"component"+i.id},null,40,["style","propValue","element","id"]))]),_:2},1032,["defaultStyle","style","active","element","index","class"]))),128)),w(Oe),w(Re),F(w(Qe,{start:e.start,width:e.width,height:e.height},null,8,["start","width","height"]),[[Z,e.isShowArea]])],38))}});const et=E(Ze,[["__scopeId","data-v-45d1d1a4"]]),se={redirect(n){n&&(window.location.href=n)},alert(n){n&&alert(n)}},tt=[{key:"redirect",label:"跳转事件",event:se.redirect,param:""},{key:"alert",label:"alert 事件",event:se.alert,param:""}],ot=O({__name:"ComponentWrapper",props:{config:{}},setup(n){const e=n,o=ue();ee(()=>{o.value!==void 0&&he(o.value,e.config.animations)});const _=()=>{const l=e.config.events;Object.keys(l).forEach(d=>{se[d](l[d])})};return(l,d)=>(f(),S("div",{onClick:_,ref_key:"wrapperDom",ref:o},[(f(),D(K(l.config.component),{class:"component",style:z(b(pe)(l.config.style)),propValue:l.config.propValue,element:l.config},null,8,["style","propValue","element"]))],512))}});const nt=E(ot,[["__scopeId","data-v-f9a224a7"]]),at={key:0,class:"bg"},lt={class:"canvas-container"},st=O({__name:"Preview",props:{show:{type:Boolean}},emits:["update:show"],setup(n,{emit:e}){const o=H.editorStore.editorState,_=()=>{e("update:show",!1)};return(l,d)=>{const p=I("el-button");return l.show?(f(),S("div",at,[w(p,{onClick:_,class:"close"},{default:k(()=>[V("关闭")]),_:1}),C("div",lt,[C("div",{class:"canvas",style:z({width:b(o).canvasStyleData.width+"px",height:b(o).canvasStyleData.height+"px",transform:"scale("+b(o).canvasStyleData.scale/100+")"})},[(f(!0),S(R,null,B(b(o).componentData,(m,r)=>(f(),D(nt,{key:r,config:m},null,8,["config"]))),128))],4)])])):G("",!0)}}});const it=E(st,[["__scopeId","data-v-5b8d6646"]]),te=n=>(xe("data-v-e76b9dfa"),n=n(),we(),n),rt={class:"toolbar"},ct=te(()=>C("label",{for:"input",class:"insert"},"插入图片",-1)),ut={class:"canvas-config"},dt=te(()=>C("span",null,"画布大小",-1)),pt=te(()=>C("span",null,"*",-1)),ht={class:"canvas-config"},mt=te(()=>C("span",null,"画布比例",-1)),ft=O({__name:"Toolbar",setup(n){const e=H.editorStore,o=W({isShowPreview:!1}),_=()=>{e.lock()},l=()=>{e.unlock()},d=()=>{e.compose(),e.recordSnapshot()},p=()=>{e.decompose(),e.recordSnapshot()},m=()=>{e.undo()},r=()=>{e.redo()},s=i=>{const u=i.target.files[0];if(!u.type.includes("image")){ge("只能插入图片");return}const g=new FileReader;g.onload=y=>{const c=y.target.result,x=new Image;x.onload=()=>{e.addComponent({component:{...ye,id:le(),component:"v-picture",label:"图片",icon:"",propValue:c,style:{...be,top:0,left:0,width:x.width,height:x.height}},index:void 0})},x.src=c},g.readAsDataURL(u)},a=()=>{o.isShowPreview=!0,e.setEditMode("preview")},v=()=>{e.setEditMode("edit")},h=()=>{localStorage.setItem("canvasData",JSON.stringify(e.editorState.componentData)),localStorage.setItem("canvasStyle",JSON.stringify(e.editorState.canvasStyleData)),Se.success("保存成功")},t=()=>{e.setComponentData([]),e.recordSnapshot()};return T.on("preview",a),T.on("save",h),T.on("clearCanvas",t),(i,u)=>{const g=I("el-button");return f(),S("div",null,[C("div",rt,[w(g,{onClick:m},{default:k(()=>[V("撤消")]),_:1}),w(g,{onClick:r},{default:k(()=>[V("重做")]),_:1}),ct,C("input",{type:"file",onChange:s,id:"input",hidden:""},null,32),w(g,{onClick:a,style:{"margin-left":"10px"}},{default:k(()=>[V("预览")]),_:1}),w(g,{onClick:h},{default:k(()=>[V("保存")]),_:1}),w(g,{onClick:t},{default:k(()=>[V("清空画布")]),_:1}),w(g,{onClick:d,disabled:!b(e).editorState.areaData.components.length},{default:k(()=>[V("组合")]),_:1},8,["disabled"]),w(g,{onClick:p,disabled:!b(e).editorState.curComponent||b(e).editorState.curComponent.isLock||b(e).editorState.curComponent.component!="VGroup"},{default:k(()=>[V("拆分")]),_:1},8,["disabled"]),w(g,{onClick:_,disabled:!b(e).editorState.curComponent||b(e).editorState.curComponent.isLock},{default:k(()=>[V("锁定")]),_:1},8,["disabled"]),w(g,{onClick:l,disabled:!b(e).editorState.curComponent||!b(e).editorState.curComponent.isLock},{default:k(()=>[V("解锁")]),_:1},8,["disabled"]),C("div",ut,[dt,F(C("input",{"onUpdate:modelValue":u[0]||(u[0]=y=>b(e).editorState.canvasStyleData.width=y)},null,512),[[ne,b(e).editorState.canvasStyleData.width]]),pt,F(C("input",{"onUpdate:modelValue":u[1]||(u[1]=y=>b(e).editorState.canvasStyleData.height=y)},null,512),[[ne,b(e).editorState.canvasStyleData.height]])]),C("div",ht,[mt,F(C("input",{"onUpdate:modelValue":u[2]||(u[2]=y=>b(e).editorState.canvasStyleData.scale=y)},null,512),[[ne,b(e).editorState.canvasStyleData.scale]]),V(" % ")])]),w(it,{show:o.isShowPreview,"onUpdate:show":u[3]||(u[3]=y=>o.isShowPreview=y),onChange:v},null,8,["show"])])}}});const _t=E(ft,[["__scopeId","data-v-e76b9dfa"]]),re=[{label:"进入",children:[{label:"渐显",value:"fadeIn"},{label:"向右进入",value:"fadeInLeft"},{label:"向左进入",value:"fadeInRight"},{label:"向上进入",value:"fadeInUp"},{label:"向下进入",value:"fadeInDown"},{label:"向右长距进入",value:"fadeInLeftBig"},{label:"向左长距进入",value:"fadeInRightBig"},{label:"向上长距进入",value:"fadeInUpBig"},{label:"向下长距进入",value:"fadeInDownBig"},{label:"旋转进入",value:"rotateIn"},{label:"左顺时针旋转",value:"rotateInDownLeft"},{label:"右逆时针旋转",value:"rotateInDownRight"},{label:"左逆时针旋转",value:"rotateInUpLeft"},{label:"右逆时针旋转",value:"rotateInUpRight"},{label:"弹入",value:"bounceIn"},{label:"向右弹入",value:"bounceInLeft"},{label:"向左弹入",value:"bounceInRight"},{label:"向上弹入",value:"bounceInUp"},{label:"向下弹入",value:"bounceInDown"},{label:"光速从右进入",value:"lightSpeedInRight"},{label:"光速从左进入",value:"lightSpeedInLeft"},{label:"光速从右退出",value:"lightSpeedOutRight"},{label:"光速从左退出",value:"lightSpeedOutLeft"},{label:"Y轴旋转",value:"flip"},{label:"中心X轴旋转",value:"flipInX"},{label:"中心Y轴旋转",value:"flipInY"},{label:"左长半径旋转",value:"rollIn"},{label:"由小变大进入",value:"zoomIn"},{label:"左变大进入",value:"zoomInLeft"},{label:"右变大进入",value:"zoomInRight"},{label:"向上变大进入",value:"zoomInUp"},{label:"向下变大进入",value:"zoomInDown"},{label:"向右滑动展开",value:"slideInLeft"},{label:"向左滑动展开",value:"slideInRight"},{label:"向上滑动展开",value:"slideInUp"},{label:"向下滑动展开",value:"slideInDown"}]},{label:"强调",children:[{label:"弹跳",value:"bounce"},{label:"闪烁",value:"flash"},{label:"放大缩小",value:"pulse"},{label:"放大缩小弹簧",value:"rubberBand"},{label:"左右晃动",value:"headShake"},{label:"左右扇形摇摆",value:"swing"},{label:"放大晃动缩小",value:"tada"},{label:"扇形摇摆",value:"wobble"},{label:"左右上下晃动",value:"jello"},{label:"Y轴旋转",value:"flip"}]},{label:"退出",children:[{label:"渐隐",value:"fadeOut"},{label:"向左退出",value:"fadeOutLeft"},{label:"向右退出",value:"fadeOutRight"},{label:"向上退出",value:"fadeOutUp"},{label:"向下退出",value:"fadeOutDown"},{label:"向左长距退出",value:"fadeOutLeftBig"},{label:"向右长距退出",value:"fadeOutRightBig"},{label:"向上长距退出",value:"fadeOutUpBig"},{label:"向下长距退出",value:"fadeOutDownBig"},{label:"旋转退出",value:"rotateOut"},{label:"左顺时针旋转",value:"rotateOutDownLeft"},{label:"右逆时针旋转",value:"rotateOutDownRight"},{label:"左逆时针旋转",value:"rotateOutUpLeft"},{label:"右逆时针旋转",value:"rotateOutUpRight"},{label:"弹出",value:"bounceOut"},{label:"向左弹出",value:"bounceOutLeft"},{label:"向右弹出",value:"bounceOutRight"},{label:"向上弹出",value:"bounceOutUp"},{label:"向下弹出",value:"bounceOutDown"},{label:"中心X轴旋转",value:"flipOutX"},{label:"中心Y轴旋转",value:"flipOutY"},{label:"左长半径旋转",value:"rollOut"},{label:"由小变大退出",value:"zoomOut"},{label:"左变大退出",value:"zoomOutLeft"},{label:"右变大退出",value:"zoomOutRight"},{label:"向上变大退出",value:"zoomOutUp"},{label:"向下变大退出",value:"zoomOutDown"},{label:"向左滑动收起",value:"slideOutLeft"},{label:"向右滑动收起",value:"slideOutRight"},{label:"向上滑动收起",value:"slideOutUp"},{label:"向下滑动收起",value:"slideOutDown"}]}],vt=O({__name:"Modal",props:{show:{type:Boolean}},emits:["update:show"],setup(n,{emit:e}){const o=()=>{e("update:show")},_=l=>{l.stopPropagation()};return(l,d)=>l.show?(f(),S("div",{key:0,class:"modal-bg",onClick:o},[C("div",{class:"fadeInLeft animated modal",onClick:_},[de(l.$slots,"default",{},void 0,!0)])])):G("",!0)}});const me=E(vt,[["__scopeId","data-v-b4747281"]]),gt={class:"animation-list"},yt={key:0,class:"div-animation"},bt={class:"el-scrollbar-view"},St=["onMouseover","onClick"],xt=O({__name:"AnimationList",setup(n){const e=H.editorStore,o=W({isShowAnimation:!1,animationClassData:re,animationActiveName:"进入",showAnimatePanel:!1,hoverPreviewAnimate:""}),_=p=>{e.addAnimation(p),o.isShowAnimation=!1},l=()=>{T.emit("runAnimation")},d=p=>{e.removeAnimation(p)};return(p,m)=>{const r=I("el-button"),s=I("el-tag"),a=I("el-scrollbar"),v=I("el-tab-pane"),h=I("el-tabs");return f(),S("div",gt,[b(e).editorState.curComponent?(f(),S("div",yt,[w(r,{onClick:m[0]||(m[0]=t=>{o.isShowAnimation=!0})},{default:k(()=>[V("添加动画")]),_:1}),w(r,{onClick:l},{default:k(()=>[V("预览动画")]),_:1}),C("div",null,[(f(!0),S(R,null,B(b(e).editorState.curComponent.animations,(t,i)=>(f(),D(s,{key:i,closable:"",onClose:u=>d(i)},{default:k(()=>[V(Q(t.label),1)]),_:2},1032,["onClose"]))),128))])])):G("",!0),w(me,{show:o.isShowAnimation,"onUpdate:show":m[2]||(m[2]=t=>o.isShowAnimation=t)},{default:k(()=>[w(h,{type:"card",modelValue:o.animationActiveName,"onUpdate:modelValue":m[1]||(m[1]=t=>o.animationActiveName=t)},{default:k(()=>[(f(!0),S(R,null,B(b(re),t=>(f(),D(v,{key:t.label,label:t.label,name:t.label},{default:k(()=>[w(a,{class:"animate-container"},{default:k(()=>[C("div",bt,[(f(!0),S(R,null,B(t.children,(i,u)=>(f(),S("div",{class:"animate",key:u,onMouseover:g=>o.hoverPreviewAnimate=i.value,onClick:g=>_(i)},[C("div",{class:J([o.hoverPreviewAnimate===i.value&&"animate__animated animate__"+i.value])},Q(i.label),3)],40,St))),128))])]),_:2},1024)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["show"])])}}});const wt=E(xt,[["__scopeId","data-v-41b1b119"]]),Ct={class:"event-list"},kt={key:0,class:"div-events"},Mt=O({__name:"EventList",setup(n){const e=H.editorStore,o=W({isShowEvent:!1,eventURL:"",eventActiveName:"redirect",eventList:tt}),_=(d,p)=>{o.isShowEvent=!1,e.addEvent({event:d,param:p})},l=d=>{e.removeEvent(d)};return(d,p)=>{const m=I("el-button"),r=I("el-tag"),s=I("el-input"),a=I("el-tab-pane"),v=I("el-tabs");return f(),S("div",Ct,[b(e).editorState.curComponent?(f(),S("div",kt,[w(m,{onClick:p[0]||(p[0]=h=>o.isShowEvent=!0)},{default:k(()=>[V("添加事件")]),_:1}),C("div",null,[(f(!0),S(R,null,B(Object.keys(b(e).editorState.curComponent.events),h=>(f(),D(r,{key:h,closable:"",onClose:t=>l(h)},{default:k(()=>[V(Q(h),1)]),_:2},1032,["onClose"]))),128))])])):G("",!0),w(me,{show:o.isShowEvent,"onUpdate:show":p[2]||(p[2]=h=>o.isShowEvent=h)},{default:k(()=>[w(v,{type:"card",modelValue:o.eventActiveName,"onUpdate:modelValue":p[1]||(p[1]=h=>o.eventActiveName=h)},{default:k(()=>[(f(!0),S(R,null,B(o.eventList,h=>(f(),D(a,{key:h.key,label:h.label,name:h.key,style:{padding:"0 20px"}},{default:k(()=>[h.key=="redirect"?(f(),D(s,{key:0,modelValue:h.param,"onUpdate:modelValue":t=>h.param=t,type:"textarea",placeholder:"请输入完整的 URL"},null,8,["modelValue","onUpdate:modelValue"])):G("",!0),h.key=="alert"?(f(),D(s,{key:1,modelValue:h.param,"onUpdate:modelValue":t=>h.param=t,type:"textarea",placeholder:"请输入要 alert 的内容"},null,8,["modelValue","onUpdate:modelValue"])):G("",!0),w(m,{style:{"margin-top":"20px"},onClick:t=>_(h.key,h.param)},{default:k(()=>[V("确定")]),_:2},1032,["onClick"])]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["show"])])}}});const Lt=E(Mt,[["__scopeId","data-v-03af1cf7"]]),Dt={class:"home"},It={class:"left"},Pt={class:"center"},Vt={class:"right"},At={key:1,class:"placeholder"},Nt={key:1,class:"placeholder"},Ot={key:1,class:"placeholder"},Et=O({__name:"Home",setup(n){const e=H.editorStore,o=W({activeName:"attr",reSelectAnimateIndex:void 0}),_=()=>{localStorage.getItem("canvasData")&&e.setComponentData(l(JSON.parse(localStorage.getItem("canvasData")))),localStorage.getItem("canvasStyle")&&e.setCanvasStyle(JSON.parse(localStorage.getItem("canvasStyle")))},l=s=>(s.forEach(a=>{a.id=le()}),s),d=s=>{s.preventDefault(),s.stopPropagation();const a=ke.cloneDeep(ce[s.dataTransfer.getData("index")]);a.style.top=s.offsetY,a.style.left=s.offsetX,a.id=le(),e.addComponent({component:a,index:void 0}),e.recordSnapshot()},p=s=>{s.preventDefault(),s.dataTransfer.dropEffect="copy"},m=()=>{e.setClickComponentStatus(!1)},r=s=>{e.editorState.isClickComponent||e.setCurComponent({component:null,index:null}),s.button!=2&&e.hideContextMenu()};return _(),Ce(),(s,a)=>{const v=I("el-tab-pane"),h=I("el-tabs");return f(),S("div",Dt,[w(_t),C("main",null,[C("section",It,[w(Ie)]),C("section",Pt,[C("div",{class:"content",onDrop:d,onDragover:p,onMousedown:m,onMouseup:r},[w(et)],32)]),C("section",Vt,[w(h,{modelValue:o.activeName,"onUpdate:modelValue":a[0]||(a[0]=t=>o.activeName=t),type:"card"},{default:k(()=>[w(v,{label:"属性",name:"attr"},{default:k(()=>[b(e).editorState.curComponent?(f(),D(Ae,{key:0})):(f(),S("p",At,"请选择组件"))]),_:1}),w(v,{label:"动画",name:"animation"},{default:k(()=>[b(e).editorState.curComponent?(f(),D(wt,{key:0})):(f(),S("p",Nt,"请选择组件"))]),_:1}),w(v,{label:"事件",name:"events"},{default:k(()=>[b(e).editorState.curComponent?(f(),D(Lt,{key:0})):(f(),S("p",Ot,"请选择组件"))]),_:1})]),_:1},8,["modelValue"])])])])}}});const Rt=E(Et,[["__scopeId","data-v-7076e16c"]]);export{Rt as default};
