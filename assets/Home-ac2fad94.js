import{d as N,o as h,c as g,F as O,r as U,a as w,b as J,e as y,t as G,u as x,_ as A,f as z,g as ie,h as M,i as b,w as S,j as T,k as $,l as K,v as ae,n as H,m as Q,p as Z,q as pe,s as he,x as ve,y as R,z as re,A as ge,B as oe,E as ye,C as be,D as Se,G as xe}from"./index-ba9f2412.js";const we="/editor-demo/assets/title-9b4c7ab1.jpg",Ce={rotate:"",opacity:1},le=[{id:0,component:"v-text",label:"文字",propValue:"文字",icon:"Edit",animations:[],events:{},style:{top:0,left:0,width:200,height:33,fontSize:14,fontWeight:500,lineHeight:"",letterSpacing:0,textAlign:"",color:""}},{id:0,component:"v-button",label:"按钮",propValue:"按钮",icon:"Crop",animations:[],events:{},style:{top:0,left:0,width:100,height:34,borderWidth:"",borderColor:"",borderRadius:"",fontSize:14,fontWeight:500,lineHeight:"",letterSpacing:0,textAlign:"",color:"",backgroundColor:""}},{id:0,component:"v-picture",label:"图片",icon:"PictureRounded",propValue:Me(we),animations:[],events:{},style:{top:0,left:0,width:300,height:200,borderRadius:""}}];le.forEach(t=>{t.style={...t.style,...Ce}});function Me(t){return new URL(t,import.meta.url).href}const ke={class:"component-list"},Le=["data-index"],De=N({__name:"ComponentList",setup(t){const e=a=>{a.dataTransfer.setData("index",a.target.dataset.index)};return(a,s)=>(h(),g("div",ke,[(h(!0),g(O,null,U(x(le),(o,p)=>(h(),g("div",{key:p,class:"item",draggable:"true",onDragstart:s[0]||(s[0]=r=>e(r)),"data-index":p},[(h(),w(J(o.icon),{class:"icon"})),y("span",null,G(o.label),1)],40,Le))),128))]))}});const Pe=A(De,[["__scopeId","data-v-c47933ae"]]),Ve={class:"attr-list"},Ie=N({__name:"AttrList",setup(t){const e=$.editorStore,a=z({excludes:["Picture"],options:[{label:"左对齐",value:"left"},{label:"居中",value:"center"},{label:"右对齐",value:"right"}],map:{left:"x 坐标",top:"y 坐标",height:"高",width:"宽",color:"颜色",backgroundColor:"背景色",borderWidth:"边框宽度",borderColor:"边框颜色",borderRadius:"边框半径",fontSize:"字体大小",fontWeight:"字体粗细",lineHeight:"行高",letterSpacing:"字间距",textAlign:"对齐方式",opacity:"透明度"}}),s=ie(()=>e.editorState.curComponent?Object.keys(e.editorState.curComponent.style):[]),o=ie(()=>e.editorState.curComponent);return(p,r)=>{const c=M("el-color-picker"),d=M("el-option"),f=M("el-select"),_=M("el-input"),n=M("el-form-item"),i=M("el-form");return h(),g("div",Ve,[b(i,null,{default:S(()=>[(h(!0),g(O,null,U(s.value.filter(l=>l!="rotate"),(l,u)=>(h(),w(n,{key:u,label:a.map[l]},{default:S(()=>[l=="borderColor"?(h(),w(c,{key:0,modelValue:o.value.style[l],"onUpdate:modelValue":m=>o.value.style[l]=m},null,8,["modelValue","onUpdate:modelValue"])):l=="color"?(h(),w(c,{key:1,modelValue:o.value.style[l],"onUpdate:modelValue":m=>o.value.style[l]=m},null,8,["modelValue","onUpdate:modelValue"])):l=="backgroundColor"?(h(),w(c,{key:2,modelValue:o.value.style[l],"onUpdate:modelValue":m=>o.value.style[l]=m},null,8,["modelValue","onUpdate:modelValue"])):l=="textAlign"?(h(),w(f,{key:3,modelValue:o.value.style[l],"onUpdate:modelValue":m=>o.value.style[l]=m},{default:S(()=>[(h(!0),g(O,null,U(a.options,m=>(h(),w(d,{key:m.value,label:m.label,value:m.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):(h(),w(_,{key:4,type:"number",modelValue:o.value.style[l],"onUpdate:modelValue":m=>o.value.style[l]=m},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["label"]))),128)),o.value&&o.value.propValue&&!a.excludes.includes(o.value.component)?(h(),w(n,{key:0,label:"内容"},{default:S(()=>[b(_,{type:"textarea",modelValue:o.value.propValue,"onUpdate:modelValue":r[0]||(r[0]=l=>o.value.propValue=l)},null,8,["modelValue"])]),_:1})):T("",!0)]),_:1})])}}});const Oe=A(Ie,[["__scopeId","data-v-fb23c8da"]]),Ne=N({__name:"ContextMenu",setup(t){const e=$.editorStore;z({copyData:null});const a=()=>{e.copy()},s=()=>{e.paste(!0)},o=()=>{e.cut()},p=()=>{e.deleteComponent(),e.recordSnapshot()},r=()=>{e.upComponent(),e.recordSnapshot()},c=()=>{e.downComponent(),e.recordSnapshot()},d=()=>{e.topComponent(),e.recordSnapshot()},f=()=>{e.bottomComponent(),e.recordSnapshot()};return(_,n)=>K((h(),g("div",{class:"contextmenu",style:H({top:x(e).editorState.menuTop+"px",left:x(e).editorState.menuLeft+"px"})},[y("ul",null,[x(e).editorState.curComponent?(h(),g(O,{key:0},[y("li",{onClick:a},"复制"),y("li",{onClick:s},"粘贴"),y("li",{onClick:o},"剪切"),y("li",{onClick:p},"删除"),y("li",{onClick:d},"置顶"),y("li",{onClick:f},"置底"),y("li",{onClick:r},"上移"),y("li",{onClick:c},"下移")],64)):(h(),g("li",{key:1,onClick:s},"粘贴"))])],4)),[[ae,x(e).editorState.menuShow]])}});const Ae=A(Ne,[["__scopeId","data-v-f5a7b493"]]);function Ee(t){return{all:t=t||new Map,on:function(e,a){var s=t.get(e);s?s.push(a):t.set(e,[a])},off:function(e,a){var s=t.get(e);s&&(a?s.splice(s.indexOf(a)>>>0,1):t.set(e,[]))},emit:function(e,a){var s=t.get(e);s&&s.slice().map(function(o){o(a)}),(s=t.get("*"))&&s.slice().map(function(o){o(e,a)})}}}const W=Ee();function X(t){return t*Math.PI/180}function I(t,e,a){return{x:(t.x-e.x)*Math.cos(X(a))-(t.y-e.y)*Math.sin(X(a))+e.x,y:(t.x-e.x)*Math.sin(X(a))+(t.y-e.y)*Math.cos(X(a))+e.y}}function ee(t,e){return{x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}}function ce(t){return Math.abs(Math.sin(X(t)))}function ue(t){return Math.abs(Math.cos(X(t)))}const Re={class:"mark-line"},Ue=N({__name:"MarkLine",setup(t){const e=$.editorStore,a=new Map,s=(n,i)=>{n&&a.set(i,n)},o=z({lines:["xt","xc","xb","yl","yc","yr"],diff:3,lineStatus:{xt:!1,xc:!1,xb:!1,yl:!1,yc:!1,yr:!1}});Q(()=>{W.on("move",n=>{c(n.isDownward,n.isRightward)}),W.on("unMove",()=>{r()})});const p=n=>{if(n={...n},n.rotate!=0){const i=n.width*ue(n.rotate)+n.height*ce(n.rotate),l=(n.width-i)/2;n.left+=l,n.right=n.left+i;const u=n.height*ue(n.rotate)+n.width*ce(n.rotate),m=(u-n.height)/2;n.top-=m,n.bottom=n.top+u,n.width=i,n.height=u}else n.bottom=n.top+n.height,n.right=n.left+n.width;return n},r=()=>{Object.keys(o.lineStatus).forEach(n=>{o.lineStatus[n]=!1})},c=(n,i)=>{const l=e.editorState.componentData,u=p(e.editorState.curComponent.style),m=u.width/2,v=u.height/2;r(),l.forEach(L=>{if(L==e.editorState.curComponent)return;const k=p(L.style),{top:C,left:D,bottom:P,right:V}=k,E=k.width/2,B=k.height/2,q={top:[{isNearly:_(u.top,C),lineNode:a.get("xt"),line:"xt",dragShift:C,lineShift:C},{isNearly:_(u.bottom,C),lineNode:a.get("xt"),line:"xt",dragShift:C-u.height,lineShift:C},{isNearly:_(u.top+v,C+B),lineNode:a.get("xc"),line:"xc",dragShift:C+B-v,lineShift:C+B},{isNearly:_(u.top,P),lineNode:a.get("xb"),line:"xb",dragShift:P,lineShift:P},{isNearly:_(u.bottom,P),lineNode:a.get("xb"),line:"xb",dragShift:P-u.height,lineShift:P}],left:[{isNearly:_(u.left,D),lineNode:a.get("yl"),line:"yl",dragShift:D,lineShift:D},{isNearly:_(u.right,D),lineNode:a.get("yl"),line:"yl",dragShift:D-u.width,lineShift:D},{isNearly:_(u.left+m,D+E),lineNode:a.get("yc"),line:"yc",dragShift:D+E-m,lineShift:D+E},{isNearly:_(u.left,V),lineNode:a.get("yr"),line:"yr",dragShift:V,lineShift:V},{isNearly:_(u.right,V),lineNode:a.get("yr"),line:"yr",dragShift:V-u.width,lineShift:V}]},j=[],{rotate:te}=e.editorState.curComponent.style;Object.keys(q).forEach(F=>{q[F].forEach(Y=>{Y.isNearly&&(e.setShapePosStyle({key:F,value:te!=0?d(F,Y,u):Y.dragShift}),Y.lineNode.style[F]=`${Y.lineShift}px`,j.push(Y.line))})}),j.length&&f(j,n,i)})},d=(n,i,l)=>{const{width:u,height:m}=e.editorState.curComponent.style;return n=="top"?Math.round(i.dragShift-(m-l.height)/2):Math.round(i.dragShift-(u-l.width)/2)},f=(n,i,l)=>{l?n.includes("yr")?o.lineStatus.yr=!0:n.includes("yc")?o.lineStatus.yc=!0:n.includes("yl")&&(o.lineStatus.yl=!0):n.includes("yl")?o.lineStatus.yl=!0:n.includes("yc")?o.lineStatus.yc=!0:n.includes("yr")&&(o.lineStatus.yr=!0),i?n.includes("xb")?o.lineStatus.xb=!0:n.includes("xc")?o.lineStatus.xc=!0:n.includes("xt")&&(o.lineStatus.xt=!0):n.includes("xt")?o.lineStatus.xt=!0:n.includes("xc")?o.lineStatus.xc=!0:n.includes("xb")&&(o.lineStatus.xb=!0)},_=(n,i)=>Math.abs(n-i)<=o.diff;return(n,i)=>(h(),g("div",Re,[(h(!0),g(O,null,U(o.lines,l=>K((h(),g("div",{key:l,class:Z(["line",l.includes("x")?"xline":"yline"]),ref_for:!0,ref:u=>s(u,l)},null,2)),[[ae,o.lineStatus[l]||!1]])),128))]))}});const $e=A(Ue,[["__scopeId","data-v-fc77015a"]]);async function fe(t,e=[]){if(t){const a=s=>new Promise(o=>{t.classList.add("animate__animated","animate__"+s.value);const p=()=>{t.removeEventListener("animationend",p),t.removeEventListener("animationcancel",p),t.classList.remove("animate__animated","animate__"+s.value),o()};t.addEventListener("animationend",p),t.addEventListener("animationcancel",p)});for(let s=0,o=e.length;s<o;s++)await a(e[s])}else console.log("runAnimation el为空")}const Be={lt:He,t:ze,rt:We,r:Te,rb:je,b:Ye,lb:Ke,l:Xe};function He(t,e,a){const{symmetricPoint:s}=a,o=ee(e,s),p=I(e,o,-t.rotate),r=I(s,o,-t.rotate),c=r.x-p.x,d=r.y-p.y;c>0&&d>0&&(t.width=Math.round(c),t.height=Math.round(d),t.left=Math.round(p.x),t.top=Math.round(p.y))}function ze(t,e,a){const{symmetricPoint:s,curPoint:o}=a,p=I(e,o,-t.rotate),r=I({x:o.x,y:p.y},o,t.rotate),c=Math.sqrt((r.x-s.x)**2+(r.y-s.y)**2);if(c>0){const d={x:r.x-(r.x-s.x)/2,y:r.y+(s.y-r.y)/2};t.height=Math.round(c),t.top=Math.round(d.y-c/2),t.left=Math.round(d.x-t.width/2)}}function Te(t,e,a){const{symmetricPoint:s,curPoint:o}=a,p=I(e,o,-t.rotate),r=I({x:p.x,y:o.y},o,t.rotate),c=Math.sqrt((r.x-s.x)**2+(r.y-s.y)**2);if(c>0){const d={x:r.x-(r.x-s.x)/2,y:r.y+(s.y-r.y)/2};t.width=Math.round(c),t.top=Math.round(d.y-t.height/2),t.left=Math.round(d.x-c/2)}}function Ye(t,e,a){const{symmetricPoint:s,curPoint:o}=a,p=I(e,o,-t.rotate),r=I({x:o.x,y:p.y},o,t.rotate),c=Math.sqrt((r.x-s.x)**2+(r.y-s.y)**2);if(c>0){const d={x:r.x-(r.x-s.x)/2,y:r.y+(s.y-r.y)/2};t.height=Math.round(c),t.top=Math.round(d.y-c/2),t.left=Math.round(d.x-t.width/2)}}function Xe(t,e,a){const{symmetricPoint:s,curPoint:o}=a,p=I(e,o,-t.rotate),r=I({x:p.x,y:o.y},o,t.rotate),c=Math.sqrt((r.x-s.x)**2+(r.y-s.y)**2);if(c>0){const d={x:r.x-(r.x-s.x)/2,y:r.y+(s.y-r.y)/2};t.width=Math.round(c),t.top=Math.round(d.y-t.height/2),t.left=Math.round(d.x-c/2)}}function We(t,e,a){const{symmetricPoint:s}=a,o=ee(e,s),p=I(e,o,-t.rotate),r=I(s,o,-t.rotate),c=p.x-r.x,d=r.y-p.y;c>0&&d>0&&(t.width=Math.round(c),t.height=Math.round(d),t.left=Math.round(r.x),t.top=Math.round(p.y))}function je(t,e,a){const{symmetricPoint:s}=a,o=ee(e,s),p=I(s,o,-t.rotate),r=I(e,o,-t.rotate),c=r.x-p.x,d=r.y-p.y;c>0&&d>0&&(t.width=Math.round(c),t.height=Math.round(d),t.left=Math.round(p.x),t.top=Math.round(p.y))}function Ke(t,e,a){const{symmetricPoint:s}=a,o=ee(e,s),p=I(s,o,-t.rotate),r=I(e,o,-t.rotate),c=p.x-r.x,d=r.y-p.y;c>0&&d>0&&(t.width=Math.round(c),t.height=Math.round(d),t.left=Math.round(r.x),t.top=Math.round(p.y))}function qe(t,e,a,s){Be[t](e,a,s)}const Fe=["onMousedown"],Je=N({__name:"ShapeComponent",props:{active:{type:Boolean,default:!1},element:{require:!0,type:Object},defaultStyle:{require:!0,type:Object},index:{require:!0,type:[Number,String]}},setup(t){const e=t,a=$.editorStore,s=pe(),o=z({pointList:["lt","t","rt","r","rb","b","lb","l"],initialAngle:{lt:0,t:45,rt:90,r:135,rb:180,b:225,lb:270,l:315},angleToCursor:[{start:338,end:23,cursor:"nw"},{start:23,end:68,cursor:"n"},{start:68,end:113,cursor:"ne"},{start:113,end:158,cursor:"e"},{start:158,end:203,cursor:"se"},{start:203,end:248,cursor:"s"},{start:248,end:293,cursor:"sw"},{start:293,end:338,cursor:"w"}],cursors:{}});Q(()=>{W.on("runAnimation",()=>{e.element===a.getCurComponent&&s.value!==void 0&&fe(s.value,a.getCurComponent.animations)})});const p=n=>{var E;n.stopPropagation();const i={...e.defaultStyle},l=n.clientY,u=n.clientX,m=i.rotate,v=(E=s.value)==null?void 0:E.getBoundingClientRect(),L=(v==null?void 0:v.left)+(v==null?void 0:v.width)/2,k=(v==null?void 0:v.top)+(v==null?void 0:v.height)/2,C=Math.atan2(l-k,u-L)/(Math.PI/180);let D=!1;const P=B=>{D=!0;const q=B.clientX,j=B.clientY,te=Math.atan2(j-k,q-L)/(Math.PI/180);i.rotate=m+te-C,a.setShapeStyle(i)},V=()=>{D&&a.recordSnapshot(),document.removeEventListener("mousemove",P),document.removeEventListener("mouseup",V),o.cursors=c()};document.addEventListener("mousemove",P),document.addEventListener("mouseup",V)},r=n=>{var P,V;const i=(P=e.defaultStyle)==null?void 0:P.height,l=(V=e.defaultStyle)==null?void 0:V.width,u=/t/.test(n),m=/b/.test(n),v=/l/.test(n),L=/r/.test(n);let k=0,C=0;return n.length===2?(k=v?0:l,C=u?0:i):((u||m)&&(k=l/2,C=u?0:i),(v||L)&&(k=v?0:l,C=Math.floor(i/2))),{marginLeft:"-4px",marginTop:"-4px",left:`${k}px`,top:`${C}px`,cursor:o.cursors[n]}},c=()=>{const n=(a.editorState.curComponent.style.rotate+360)%360,i={};let l=-1;return o.pointList.forEach(u=>{const m=(o.initialAngle[u]+n)%360,v=o.angleToCursor.length;let L=0;for(;L<v;){l=(l+1)%v;const k=o.angleToCursor[l];if(m<23||m>=338){i[u]="nw-resize";break}if(k.start<=m&&m<k.end){i[u]=k.cursor+"-resize";break}}}),i},d=n=>{var D;((D=e.element)==null?void 0:D.component)!="v-text"&&n.preventDefault(),n.stopPropagation(),a.setCurComponent({component:e.element,index:e.index}),o.cursors=c();const i={...e.defaultStyle},l=n.clientY,u=n.clientX,m=Number(i.top),v=Number(i.left);let L=!1;const k=P=>{L=!0;const V=P.clientX,E=P.clientY;i.top=E-l+m,i.left=V-u+v,a.setShapeStyle(i),ve(()=>{W.emit("move",{isDownward:E-l>0,isRightward:V-u>0})})},C=()=>{L&&a.recordSnapshot(),W.emit("unMove"),document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",C)};document.addEventListener("mousemove",k),document.addEventListener("mouseup",C)},f=n=>{n.stopPropagation(),n.preventDefault(),a.hideContextMenu()},_=(n,i)=>{var V;const l=window.event;l==null||l.stopPropagation(),l==null||l.preventDefault();const u={...e.defaultStyle},m={x:u.left+u.width/2,y:u.top+u.height/2},v=(V=document==null?void 0:document.querySelector("#editor"))==null?void 0:V.getBoundingClientRect(),L={x:i.clientX-(v==null?void 0:v.left),y:i.clientY-(v==null?void 0:v.top)},k={x:m.x-(L.x-m.x),y:m.y-(L.y-m.y)};let C=!1;const D=E=>{C=!0;const B={x:E.clientX-(v==null?void 0:v.left),y:E.clientY-(v==null?void 0:v.top)};qe(n,u,B,{center:m,curPoint:L,symmetricPoint:k}),a.setShapeStyle(u)},P=()=>{document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",P),C&&a.recordSnapshot()};document.addEventListener("mousemove",D),document.addEventListener("mouseup",P)};return(n,i)=>{const l=M("RefreshRight"),u=M("el-icon");return h(),g("div",{ref_key:"thisRef",ref:s,class:Z(["shape",{active:t.active}]),onClick:f,onMousedown:d},[K(b(u,{class:"el-icon-refresh-right",onMousedown:p},{default:S(()=>[b(l)]),_:1},512),[[ae,t.active]]),(h(!0),g(O,null,U(t.active?o.pointList:[],(m,v)=>(h(),g("div",{class:"shape-point",onMousedown:L=>_(m,L),key:v,style:H(r(m))},null,44,Fe))),128)),he(n.$slots,"default",{},void 0,!0)],34)}}});const Ge=A(Je,[["__scopeId","data-v-51856631"]]);function me(t,e=[]){const a=["fontSize","width","height","top","left"],s={};return Object.keys(t).forEach(o=>{e.includes(o)||(o!="rotate"?(s[o]=t[o],a.includes(o)&&(s[o]+="px")):s.transform=o+"("+t[o]+"deg)")}),s}const Qe=N({__name:"EditorComponent",props:{isEdit:{type:Boolean,default:!0}},setup(t){const e=$.editorStore,a=c=>{c.stopPropagation(),c.preventDefault();let d=c.target,f=c.offsetY,_=c.offsetX;for(;!d.className.includes("editor");)_+=d.offsetLeft,f+=d.offsetTop,d=d.parentNode;e.showContextMenu({top:f,left:_})},s=c=>{const d={...c};return d.width&&(d.width+="px"),d.height&&(d.height+="px"),d.top&&(d.top+="px"),d.left&&(d.left+="px"),d.rotate&&(d.transform="rotate("+d.rotate+"deg)"),d},o=c=>me(c,["top","left","width","height","rotate"]),p=(c,d)=>{c.propValue=d,e.setShapeStyle({height:r(c,d)})},r=(c,d)=>{let{lineHeight:f,fontSize:_,height:n}=c.style;f===""&&(f=1.5);const i=d.split(`
`).length*f*_;return n>i?n:i};return(c,d)=>(h(),g("div",{class:Z(["editor",{edit:t.isEdit}]),id:"editor",style:H({width:x(e).editorState.canvasStyleData.width+"px",height:x(e).editorState.canvasStyleData.height+"px"}),onContextmenu:a},[(h(!0),g(O,null,U(x(e).editorState.componentData,(f,_)=>(h(),w(Ge,{defaultStyle:f.style,style:H(s(f.style)),key:f.id,active:f===x(e).editorState.curComponent,element:f,index:_},{default:S(()=>[f.component!="v-text"?(h(),w(J(f.component),{key:0,class:"component",style:H(o(f.style)),propValue:f.propValue},null,8,["style","propValue"])):(h(),w(J(f.component),{key:1,class:"component",style:H(o(f.style)),propValue:f.propValue,onInput:p,element:f},null,40,["style","propValue","element"]))]),_:2},1032,["defaultStyle","style","active","element","index"]))),128)),b(Ae),b($e)],38))}});const Ze=A(Qe,[["__scopeId","data-v-e5128159"]]),ne={redirect(t){t&&(window.location.href=t)},alert(t){t&&alert(t)}},et=[{key:"redirect",label:"跳转事件",event:ne.redirect,param:""},{key:"alert",label:"alert 事件",event:ne.alert,param:""}],tt=N({__name:"ComponentWrapper",props:{config:{}},setup(t){const e=t,a=pe();Q(()=>{a.value!==void 0&&fe(a.value,e.config.animations)});const s=()=>{const o=e.config.events;Object.keys(o).forEach(p=>{ne[p](o[p])})};return(o,p)=>(h(),g("div",{onClick:s,ref_key:"wrapperDom",ref:a},[(h(),w(J(o.config.component),{class:"component",style:H(x(me)(o.config.style)),propValue:o.config.propValue},null,8,["style","propValue"]))],512))}});const ot=A(tt,[["__scopeId","data-v-f6fda919"]]),nt={key:0,class:"bg"},at={class:"canvas-container"},lt=N({__name:"Preview",props:{show:{type:Boolean}},emits:["update:show"],setup(t,{emit:e}){const a=$.editorStore.editorState,s=()=>{e("update:show",!1)};return(o,p)=>{const r=M("el-button");return o.show?(h(),g("div",nt,[b(r,{onClick:s,class:"close"},{default:S(()=>[R("关闭")]),_:1}),y("div",at,[y("div",{class:"canvas",style:H({width:x(a).canvasStyleData.width+"px",height:x(a).canvasStyleData.height+"px"})},[(h(!0),g(O,null,U(x(a).componentData,(c,d)=>(h(),w(ot,{key:d,config:c},null,8,["config"]))),128))],4)])])):T("",!0)}}});const st=A(lt,[["__scopeId","data-v-405e2576"]]),se=t=>(be("data-v-cb7c59cc"),t=t(),Se(),t),it={class:"toolbar"},rt=se(()=>y("label",{for:"input",class:"insert"},"插入图片",-1)),ct={class:"canvas-config"},ut=se(()=>y("span",null,"画布大小",-1)),dt=se(()=>y("span",null,"*",-1)),pt=N({__name:"Toolbar",setup(t){const e=$.editorStore,a=z({isShowPreview:!1}),s=()=>{e.undo()},o=()=>{e.redo()},p=_=>{const n=_.target.files[0];if(!n.type.includes("image")){ge("只能插入图片");return}const i=new FileReader;i.onload=l=>{const u=l.target.result,m=new Image;m.onload=()=>{e.addComponent({component:{id:oe(),component:"v-picture",label:"图片",icon:"",propValue:u,animations:[],events:[],style:{top:0,left:0,width:m.width,height:m.height,rotate:""}},index:void 0})},m.src=u},i.readAsDataURL(n)},r=()=>{a.isShowPreview=!0,e.setEditMode("read")},c=()=>{e.setEditMode("edit")},d=()=>{localStorage.setItem("canvasData",JSON.stringify(e.editorState.componentData)),localStorage.setItem("canvasStyle",JSON.stringify(e.editorState.canvasStyleData)),ye.success("保存成功")},f=()=>{e.setComponentData([])};return(_,n)=>{const i=M("el-button");return h(),g("div",null,[y("div",it,[b(i,{onClick:s},{default:S(()=>[R("撤消")]),_:1}),b(i,{onClick:o},{default:S(()=>[R("重做")]),_:1}),rt,y("input",{type:"file",onChange:p,id:"input",hidden:""},null,32),b(i,{onClick:r,style:{"margin-left":"10px"}},{default:S(()=>[R("预览")]),_:1}),b(i,{onClick:d},{default:S(()=>[R("保存")]),_:1}),b(i,{onClick:f},{default:S(()=>[R("清空画布")]),_:1}),y("div",ct,[ut,K(y("input",{"onUpdate:modelValue":n[0]||(n[0]=l=>x(e).editorState.canvasStyleData.width=l)},null,512),[[re,x(e).editorState.canvasStyleData.width]]),dt,K(y("input",{"onUpdate:modelValue":n[1]||(n[1]=l=>x(e).editorState.canvasStyleData.height=l)},null,512),[[re,x(e).editorState.canvasStyleData.height]])])]),b(st,{show:a.isShowPreview,"onUpdate:show":n[2]||(n[2]=l=>a.isShowPreview=l),onChange:c},null,8,["show"])])}}});const ht=A(pt,[["__scopeId","data-v-cb7c59cc"]]),de=[{label:"进入",children:[{label:"渐显",value:"fadeIn"},{label:"向右进入",value:"fadeInLeft"},{label:"向左进入",value:"fadeInRight"},{label:"向上进入",value:"fadeInUp"},{label:"向下进入",value:"fadeInDown"},{label:"向右长距进入",value:"fadeInLeftBig"},{label:"向左长距进入",value:"fadeInRightBig"},{label:"向上长距进入",value:"fadeInUpBig"},{label:"向下长距进入",value:"fadeInDownBig"},{label:"旋转进入",value:"rotateIn"},{label:"左顺时针旋转",value:"rotateInDownLeft"},{label:"右逆时针旋转",value:"rotateInDownRight"},{label:"左逆时针旋转",value:"rotateInUpLeft"},{label:"右逆时针旋转",value:"rotateInUpRight"},{label:"弹入",value:"bounceIn"},{label:"向右弹入",value:"bounceInLeft"},{label:"向左弹入",value:"bounceInRight"},{label:"向上弹入",value:"bounceInUp"},{label:"向下弹入",value:"bounceInDown"},{label:"光速从右进入",value:"lightSpeedInRight"},{label:"光速从左进入",value:"lightSpeedInLeft"},{label:"光速从右退出",value:"lightSpeedOutRight"},{label:"光速从左退出",value:"lightSpeedOutLeft"},{label:"Y轴旋转",value:"flip"},{label:"中心X轴旋转",value:"flipInX"},{label:"中心Y轴旋转",value:"flipInY"},{label:"左长半径旋转",value:"rollIn"},{label:"由小变大进入",value:"zoomIn"},{label:"左变大进入",value:"zoomInLeft"},{label:"右变大进入",value:"zoomInRight"},{label:"向上变大进入",value:"zoomInUp"},{label:"向下变大进入",value:"zoomInDown"},{label:"向右滑动展开",value:"slideInLeft"},{label:"向左滑动展开",value:"slideInRight"},{label:"向上滑动展开",value:"slideInUp"},{label:"向下滑动展开",value:"slideInDown"}]},{label:"强调",children:[{label:"弹跳",value:"bounce"},{label:"闪烁",value:"flash"},{label:"放大缩小",value:"pulse"},{label:"放大缩小弹簧",value:"rubberBand"},{label:"左右晃动",value:"headShake"},{label:"左右扇形摇摆",value:"swing"},{label:"放大晃动缩小",value:"tada"},{label:"扇形摇摆",value:"wobble"},{label:"左右上下晃动",value:"jello"},{label:"Y轴旋转",value:"flip"}]},{label:"退出",children:[{label:"渐隐",value:"fadeOut"},{label:"向左退出",value:"fadeOutLeft"},{label:"向右退出",value:"fadeOutRight"},{label:"向上退出",value:"fadeOutUp"},{label:"向下退出",value:"fadeOutDown"},{label:"向左长距退出",value:"fadeOutLeftBig"},{label:"向右长距退出",value:"fadeOutRightBig"},{label:"向上长距退出",value:"fadeOutUpBig"},{label:"向下长距退出",value:"fadeOutDownBig"},{label:"旋转退出",value:"rotateOut"},{label:"左顺时针旋转",value:"rotateOutDownLeft"},{label:"右逆时针旋转",value:"rotateOutDownRight"},{label:"左逆时针旋转",value:"rotateOutUpLeft"},{label:"右逆时针旋转",value:"rotateOutUpRight"},{label:"弹出",value:"bounceOut"},{label:"向左弹出",value:"bounceOutLeft"},{label:"向右弹出",value:"bounceOutRight"},{label:"向上弹出",value:"bounceOutUp"},{label:"向下弹出",value:"bounceOutDown"},{label:"中心X轴旋转",value:"flipOutX"},{label:"中心Y轴旋转",value:"flipOutY"},{label:"左长半径旋转",value:"rollOut"},{label:"由小变大退出",value:"zoomOut"},{label:"左变大退出",value:"zoomOutLeft"},{label:"右变大退出",value:"zoomOutRight"},{label:"向上变大退出",value:"zoomOutUp"},{label:"向下变大退出",value:"zoomOutDown"},{label:"向左滑动收起",value:"slideOutLeft"},{label:"向右滑动收起",value:"slideOutRight"},{label:"向上滑动收起",value:"slideOutUp"},{label:"向下滑动收起",value:"slideOutDown"}]}],ft=N({__name:"Modal",props:{show:{type:Boolean}},emits:["update:show"],setup(t,{emit:e}){const a=()=>{e("update:show")},s=o=>{o.stopPropagation()};return(o,p)=>o.show?(h(),g("div",{key:0,class:"modal-bg",onClick:a},[y("div",{class:"fadeInLeft animated modal",onClick:s},[he(o.$slots,"default",{},void 0,!0)])])):T("",!0)}});const _e=A(ft,[["__scopeId","data-v-b4747281"]]),mt={class:"animation-list"},_t={key:0,class:"div-animation"},vt={class:"el-scrollbar-view"},gt=["onMouseover","onClick"],yt=N({__name:"AnimationList",setup(t){const e=$.editorStore,a=z({isShowAnimation:!1,animationClassData:de,animationActiveName:"进入",showAnimatePanel:!1,hoverPreviewAnimate:""});Q(()=>{a.isShowAnimation=!1});const s=r=>{e.addAnimation(r),a.isShowAnimation=!1},o=()=>{W.emit("runAnimation")},p=r=>{e.removeAnimation(r)};return(r,c)=>{const d=M("el-button"),f=M("el-tag"),_=M("el-scrollbar"),n=M("el-tab-pane"),i=M("el-tabs");return h(),g("div",mt,[x(e).editorState.curComponent?(h(),g("div",_t,[b(d,{onClick:c[0]||(c[0]=l=>{a.isShowAnimation=!0})},{default:S(()=>[R("添加动画")]),_:1}),b(d,{onClick:o},{default:S(()=>[R("预览动画")]),_:1}),y("div",null,[(h(!0),g(O,null,U(x(e).editorState.curComponent.animations,(l,u)=>(h(),w(f,{key:u,closable:"",onClose:m=>p(u)},{default:S(()=>[R(G(l.label),1)]),_:2},1032,["onClose"]))),128))])])):T("",!0),b(_e,{show:a.isShowAnimation,"onUpdate:show":c[2]||(c[2]=l=>a.isShowAnimation=l)},{default:S(()=>[b(i,{type:"card",modelValue:a.animationActiveName,"onUpdate:modelValue":c[1]||(c[1]=l=>a.animationActiveName=l)},{default:S(()=>[(h(!0),g(O,null,U(x(de),l=>(h(),w(n,{key:l.label,label:l.label,name:l.label},{default:S(()=>[b(_,{class:"animate-container"},{default:S(()=>[y("div",vt,[(h(!0),g(O,null,U(l.children,(u,m)=>(h(),g("div",{class:"animate",key:m,onMouseover:v=>a.hoverPreviewAnimate=u.value,onClick:v=>s(u)},[y("div",{class:Z([a.hoverPreviewAnimate===u.value&&"animate__animated animate__"+u.value])},G(u.label),3)],40,gt))),128))])]),_:2},1024)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["show"])])}}});const bt=A(yt,[["__scopeId","data-v-a7e9386e"]]),St={class:"event-list"},xt={key:0,class:"div-events"},wt=N({__name:"EventList",setup(t){const e=$.editorStore,a=z({isShowEvent:!1,eventURL:"",eventActiveName:"redirect",eventList:et}),s=(p,r)=>{a.isShowEvent=!1,e.addEvent({event:p,param:r})},o=p=>{e.removeEvent(p)};return(p,r)=>{const c=M("el-button"),d=M("el-tag"),f=M("el-input"),_=M("el-tab-pane"),n=M("el-tabs");return h(),g("div",St,[x(e).editorState.curComponent?(h(),g("div",xt,[b(c,{onClick:r[0]||(r[0]=i=>a.isShowEvent=!0)},{default:S(()=>[R("添加事件")]),_:1}),y("div",null,[(h(!0),g(O,null,U(Object.keys(x(e).editorState.curComponent.events),i=>(h(),w(d,{key:i,closable:"",onClose:l=>o(i)},{default:S(()=>[R(G(i),1)]),_:2},1032,["onClose"]))),128))])])):T("",!0),b(_e,{show:a.isShowEvent,"onUpdate:show":r[2]||(r[2]=i=>a.isShowEvent=i)},{default:S(()=>[b(n,{type:"card",modelValue:a.eventActiveName,"onUpdate:modelValue":r[1]||(r[1]=i=>a.eventActiveName=i)},{default:S(()=>[(h(!0),g(O,null,U(a.eventList,i=>(h(),w(_,{key:i.key,label:i.label,name:i.key,style:{padding:"0 20px"}},{default:S(()=>[i.key=="redirect"?(h(),w(f,{key:0,modelValue:i.param,"onUpdate:modelValue":l=>i.param=l,type:"textarea",placeholder:"请输入完整的 URL"},null,8,["modelValue","onUpdate:modelValue"])):T("",!0),i.key=="alert"?(h(),w(f,{key:1,modelValue:i.param,"onUpdate:modelValue":l=>i.param=l,type:"textarea",placeholder:"请输入要 alert 的内容"},null,8,["modelValue","onUpdate:modelValue"])):T("",!0),b(c,{style:{"margin-top":"20px"},onClick:l=>s(i.key,i.param)},{default:S(()=>[R("确定")]),_:2},1032,["onClick"])]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["show"])])}}});const Ct=A(wt,[["__scopeId","data-v-03af1cf7"]]),Mt={class:"home"},kt={class:"left"},Lt={class:"center"},Dt={class:"right"},Pt={key:1,class:"placeholder"},Vt={key:1,class:"placeholder"},It={key:1,class:"placeholder"},Ot=N({__name:"Home",setup(t){const e=$.editorStore,a=z({activeName:"attr",reSelectAnimateIndex:void 0}),s=()=>{localStorage.getItem("canvasData")&&e.setComponentData(p(JSON.parse(localStorage.getItem("canvasData")))),localStorage.getItem("canvasStyle")&&e.setCanvasStyle(JSON.parse(localStorage.getItem("canvasStyle")))},o=()=>{let l=!1;window.onkeydown=u=>{u.keyCode==17?l=!0:l&&u.keyCode==67?e.copy():l&&u.keyCode==86?e.paste(!1):l&&u.keyCode==88&&e.cut()},window.onkeyup=u=>{u.keyCode==17&&(l=!1)}},p=f=>(f.forEach(_=>{_.id=oe()}),f),r=f=>{f.preventDefault(),f.stopPropagation();const _=xe.cloneDeep(le[f.dataTransfer.getData("index")]);_.style.top=f.offsetY,_.style.left=f.offsetX,_.id=oe(),e.addComponent({component:_,index:void 0}),e.recordSnapshot()},c=f=>{f.preventDefault(),f.dataTransfer.dropEffect="copy"},d=()=>{e.setCurComponent({component:null,index:null}),e.hideContextMenu()};return s(),o(),(f,_)=>{const n=M("el-tab-pane"),i=M("el-tabs");return h(),g("div",Mt,[b(ht),y("main",null,[y("section",kt,[b(Pe)]),y("section",Lt,[y("div",{class:"content",onDrop:r,onDragover:c,onClick:d},[b(Ze)],32)]),y("section",Dt,[b(i,{modelValue:a.activeName,"onUpdate:modelValue":_[0]||(_[0]=l=>a.activeName=l),type:"card"},{default:S(()=>[b(n,{label:"属性",name:"attr"},{default:S(()=>[x(e).editorState.curComponent?(h(),w(Oe,{key:0})):(h(),g("p",Pt,"请选择组件"))]),_:1}),b(n,{label:"动画",name:"animation"},{default:S(()=>[x(e).editorState.curComponent?(h(),w(bt,{key:0})):(h(),g("p",Vt,"请选择组件"))]),_:1}),b(n,{label:"事件",name:"events"},{default:S(()=>[x(e).editorState.curComponent?(h(),w(Ct,{key:0})):(h(),g("p",It,"请选择组件"))]),_:1})]),_:1},8,["modelValue"])])])])}}});const At=A(Ot,[["__scopeId","data-v-10944f98"]]);export{At as default};
