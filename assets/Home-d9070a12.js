import{d as Y,r as me,o as ae,a as r,c as _,b as I,n as X,u as S,e as Z,_ as W,f as j,g as E,h as w,w as y,i as D,F as H,j as z,k as $,l as B,m as ve,t as Q,p as G,q as ce,s as J,v as le,x as ee,y as ye,z as ue,A as oe,B as Se,C as xe,E as we,D as Ce,G as ke}from"./index-550abdab.js";async function _e(e,t=[]){if(e){const n=a=>new Promise(o=>{e.classList.add("animate__animated","animate__"+a.value);const p=()=>{e.removeEventListener("animationend",p),e.removeEventListener("animationcancel",p),e.classList.remove("animate__animated","animate__"+a.value),o()};e.addEventListener("animationend",p),e.addEventListener("animationcancel",p)});for(let a=0,o=t.length;a<o;a++)await n(t[a])}else console.log("runAnimation el为空")}function ge(e,t=[]){const n=["fontSize","width","height","top","left"],a={};return Object.keys(e).forEach(o=>{t.includes(o)||(o!="rotate"?(a[o]=e[o],n.includes(o)&&(a[o]+="px")):a.transform=o+"("+e[o]+"deg)")}),a}const ne={redirect(e){e&&(window.location.href=e)},alert(e){e&&alert(e)}},Me=[{key:"redirect",label:"跳转事件",event:ne.redirect,param:""},{key:"alert",label:"alert 事件",event:ne.alert,param:""}],Le=Y({__name:"ComponentWrapper",props:{config:{}},setup(e){const t=e,n=me();ae(()=>{n.value!==void 0&&_e(n.value,t.config.animations)});const a=()=>{const o=t.config.events;Object.keys(o).forEach(p=>{ne[p](o[p])})};return(o,p)=>(r(),_("div",{onClick:a,ref_key:"wrapperDom",ref:n},[(r(),I(Z(o.config.component),{class:"component",style:X(S(ge)(o.config.style)),propValue:o.config.propValue},null,8,["style","propValue"]))],512))}});const De=W(Le,[["__scopeId","data-v-f6fda919"]]),Pe={key:0,class:"bg"},Ve={class:"canvas-container"},Ie=Y({__name:"Preview",props:{show:{type:Boolean}},emits:["update:show"],setup(e,{emit:t}){const n=j.editorStore.editorState,a=()=>{t("update:show",!1)};return(o,p)=>{const s=E("el-button");return o.show?(r(),_("div",Pe,[w(s,{onClick:a,class:"close"},{default:y(()=>[B("关闭")]),_:1}),D("div",Ve,[D("div",{class:"canvas",style:X({width:S(n).canvasStyleData.width+"px",height:S(n).canvasStyleData.height+"px"})},[(r(!0),_(H,null,z(S(n).componentData,(c,i)=>(r(),I(De,{key:i,config:c},null,8,["config"]))),128))],4)])])):$("",!0)}}});const Oe=W(Ie,[["__scopeId","data-v-405e2576"]]),Re=Y({__name:"Modal",props:{show:{type:Boolean}},emits:["update:show"],setup(e,{emit:t}){const n=()=>{t("update:show")},a=o=>{o.stopPropagation()};return(o,p)=>o.show?(r(),_("div",{key:0,class:"modal-bg",onClick:n},[D("div",{class:"fadeInLeft animated modal",onClick:a},[ve(o.$slots,"default",{},void 0,!0)])])):$("",!0)}});const de=W(Re,[["__scopeId","data-v-30ac208d"]]),Ne="/editor-demo/assets/title-9b4c7ab1.jpg",Ue={rotate:"",opacity:1},ie=[{id:0,component:"v-text",label:"文字",propValue:"文字",icon:"Edit",animations:[],events:{},style:{top:0,left:0,width:200,height:33,fontSize:14,fontWeight:500,lineHeight:"",letterSpacing:0,textAlign:"",color:""}},{id:0,component:"v-button",label:"按钮",propValue:"按钮",icon:"Crop",animations:[],events:{},style:{top:0,left:0,width:100,height:34,borderWidth:"",borderColor:"",borderRadius:"",fontSize:14,fontWeight:500,lineHeight:"",letterSpacing:0,textAlign:"",color:"",backgroundColor:""}},{id:0,component:"v-picture",label:"图片",icon:"PictureRounded",propValue:Ee(Ne),animations:[],events:{},style:{top:0,left:0,width:300,height:200,borderRadius:""}}];ie.forEach(e=>{e.style={...e.style,...Ue}});function Ee(e){return new URL(e,import.meta.url).href}const Ae={class:"component-list"},Be=["data-index"],$e=Y({__name:"ComponentList",setup(e){const t=n=>{n.dataTransfer.setData("index",n.target.dataset.index)};return(n,a)=>(r(),_("div",Ae,[(r(!0),_(H,null,z(S(ie),(o,p)=>(r(),_("div",{key:p,class:"item",draggable:"true",onDragstart:a[0]||(a[0]=s=>t(s)),"data-index":p},[(r(),I(Z(o.icon),{class:"icon"})),D("span",null,Q(o.label),1)],40,Be))),128))]))}});const He=W($e,[["__scopeId","data-v-c47933ae"]]),ze={class:"attr-list"},Ye=Y({__name:"AttrList",setup(e){const t=j.editorStore,n=G({excludes:["Picture"],options:[{label:"左对齐",value:"left"},{label:"居中",value:"center"},{label:"右对齐",value:"right"}],map:{left:"x 坐标",top:"y 坐标",height:"高",width:"宽",color:"颜色",backgroundColor:"背景色",borderWidth:"边框宽度",borderColor:"边框颜色",borderRadius:"边框半径",fontSize:"字体大小",fontWeight:"字体粗细",lineHeight:"行高",letterSpacing:"字间距",textAlign:"对齐方式",opacity:"透明度",rotate:"旋转角度"}}),a=ce(()=>t.editorState.curComponent?Object.keys(t.editorState.curComponent.style):[]),o=ce(()=>t.editorState.curComponent);return(p,s)=>{const c=E("el-color-picker"),i=E("el-option"),b=E("el-select"),k=E("el-input"),l=E("el-form-item"),m=E("el-form");return r(),_("div",ze,[w(m,null,{default:y(()=>[(r(!0),_(H,null,z(a.value,(u,h)=>(r(),I(l,{key:h,label:n.map[u]},{default:y(()=>[u=="borderColor"?(r(),I(c,{key:0,modelValue:o.value.style[u],"onUpdate:modelValue":g=>o.value.style[u]=g},null,8,["modelValue","onUpdate:modelValue"])):u=="color"?(r(),I(c,{key:1,modelValue:o.value.style[u],"onUpdate:modelValue":g=>o.value.style[u]=g},null,8,["modelValue","onUpdate:modelValue"])):u=="backgroundColor"?(r(),I(c,{key:2,modelValue:o.value.style[u],"onUpdate:modelValue":g=>o.value.style[u]=g},null,8,["modelValue","onUpdate:modelValue"])):u=="textAlign"?(r(),I(b,{key:3,modelValue:o.value.style[u],"onUpdate:modelValue":g=>o.value.style[u]=g},{default:y(()=>[(r(!0),_(H,null,z(n.options,g=>(r(),I(i,{key:g.value,label:g.label,value:g.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):(r(),I(k,{key:4,type:"number",modelValue:o.value.style[u],"onUpdate:modelValue":g=>o.value.style[u]=g},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["label"]))),128)),o.value&&o.value.propValue&&!n.excludes.includes(o.value.component)?(r(),I(l,{key:0,label:"内容"},{default:y(()=>[w(k,{type:"textarea",modelValue:o.value.propValue,"onUpdate:modelValue":s[0]||(s[0]=u=>o.value.propValue=u)},null,8,["modelValue"])]),_:1})):$("",!0)]),_:1})])}}});const We=W(Ye,[["__scopeId","data-v-b2c12231"]]),Xe=Y({__name:"ContextMenu",setup(e){const t=j.editorStore;G({copyData:null});const n=()=>{t.copy()},a=()=>{t.paste(!0)},o=()=>{t.cut()},p=()=>{t.deleteComponent(),t.recordSnapshot()},s=()=>{t.upComponent(),t.recordSnapshot()},c=()=>{t.downComponent(),t.recordSnapshot()},i=()=>{t.topComponent(),t.recordSnapshot()},b=()=>{t.bottomComponent(),t.recordSnapshot()};return(k,l)=>J((r(),_("div",{class:"contextmenu",style:X({top:S(t).editorState.menuTop+"px",left:S(t).editorState.menuLeft+"px"})},[D("ul",null,[S(t).editorState.curComponent?(r(),_("li",{key:0,onClick:n},"复制")):$("",!0),D("li",{onClick:a},"粘贴"),S(t).editorState.curComponent?(r(),_("li",{key:1,onClick:o},"剪切")):$("",!0),S(t).editorState.curComponent?(r(),_("li",{key:2,onClick:p},"删除")):$("",!0),S(t).editorState.curComponent?(r(),_("li",{key:3,onClick:i},"置顶")):$("",!0),S(t).editorState.curComponent?(r(),_("li",{key:4,onClick:b},"置底")):$("",!0),S(t).editorState.curComponent?(r(),_("li",{key:5,onClick:s},"上移")):$("",!0),S(t).editorState.curComponent?(r(),_("li",{key:6,onClick:c},"下移")):$("",!0)])],4)),[[le,S(t).editorState.menuShow]])}});const Te=W(Xe,[["__scopeId","data-v-ab3b3a2f"]]);function je(e){return{all:e=e||new Map,on:function(t,n){var a=e.get(t);a?a.push(n):e.set(t,[n])},off:function(t,n){var a=e.get(t);a&&(n?a.splice(a.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var a=e.get(t);a&&a.slice().map(function(o){o(n)}),(a=e.get("*"))&&a.slice().map(function(o){o(t,n)})}}}const q=je();function K(e){return e*Math.PI/180}function R(e,t,n){return{x:(e.x-t.x)*Math.cos(K(n))-(e.y-t.y)*Math.sin(K(n))+t.x,y:(e.x-t.x)*Math.sin(K(n))+(e.y-t.y)*Math.cos(K(n))+t.y}}function Ke(e,t,n){let a;switch(n){case"t":a={x:e.left+e.width/2,y:e.top};break;case"b":a={x:e.left+e.width/2,y:e.top+e.height};break;case"l":a={x:e.left,y:e.top+e.height/2};break;case"r":a={x:e.left+e.width,y:e.top+e.height/2};break;case"lt":a={x:e.left,y:e.top};break;case"rt":a={x:e.left+e.width,y:e.top};break;case"lb":a={x:e.left,y:e.top+e.height};break;default:a={x:e.left+e.width,y:e.top+e.height};break}return R(a,t,e.rotate)}function te(e,t){return{x:e.x+(t.x-e.x)/2,y:e.y+(t.y-e.y)/2}}function pe(e){return Math.abs(Math.sin(K(e)))}function he(e){return Math.abs(Math.cos(K(e)))}const qe={class:"mark-line"},Fe=Y({__name:"MarkLine",setup(e){const t=j.editorStore,n=new Map,a=(l,m)=>{l&&n.set(m,l)},o=G({lines:["xt","xc","xb","yl","yc","yr"],diff:3,lineStatus:{xt:!1,xc:!1,xb:!1,yl:!1,yc:!1,yr:!1}});ae(()=>{q.on("move",l=>{c(l.isDownward,l.isRightward)}),q.on("unMove",()=>{s()})});const p=l=>{if(l={...l},l.rotate!=0){const m=l.width*he(l.rotate)+l.height*pe(l.rotate),u=(l.width-m)/2;l.left+=u,l.right=l.left+m;const h=l.height*he(l.rotate)+l.width*pe(l.rotate),g=(h-l.height)/2;l.top-=g,l.bottom=l.top+h,l.width=m,l.height=h}else l.bottom=l.top+l.height,l.right=l.left+l.width;return l},s=()=>{Object.keys(o.lineStatus).forEach(l=>{o.lineStatus[l]=!1})},c=(l,m)=>{const u=t.editorState.componentData,h=p(t.editorState.curComponent.style),g=h.width/2,C=h.height/2;s(),u.forEach(P=>{if(P==t.editorState.curComponent)return;const O=p(P.style),{top:L,left:M,bottom:v,right:d}=O,x=O.width/2,U=O.height/2,N={top:[{isNearly:k(h.top,L),lineNode:n.get("xt"),line:"xt",dragShift:L,lineShift:L},{isNearly:k(h.bottom,L),lineNode:n.get("xt"),line:"xt",dragShift:L-h.height,lineShift:L},{isNearly:k(h.top+C,L+U),lineNode:n.get("xc"),line:"xc",dragShift:L+U-C,lineShift:L+U},{isNearly:k(h.top,v),lineNode:n.get("xb"),line:"xb",dragShift:v,lineShift:v},{isNearly:k(h.bottom,v),lineNode:n.get("xb"),line:"xb",dragShift:v-h.height,lineShift:v}],left:[{isNearly:k(h.left,M),lineNode:n.get("yl"),line:"yl",dragShift:M,lineShift:M},{isNearly:k(h.right,M),lineNode:n.get("yl"),line:"yl",dragShift:M-h.width,lineShift:M},{isNearly:k(h.left+g,M+x),lineNode:n.get("yc"),line:"yc",dragShift:M+x-g,lineShift:M+x},{isNearly:k(h.left,d),lineNode:n.get("yr"),line:"yr",dragShift:d,lineShift:d},{isNearly:k(h.right,d),lineNode:n.get("yr"),line:"yr",dragShift:d-h.width,lineShift:d}]},V=[],{rotate:F}=t.editorState.curComponent.style;Object.keys(N).forEach(T=>{N[T].forEach(f=>{f.isNearly&&(t.setShapePosStyle({key:T,value:F!=0?i(T,f,h):f.dragShift}),f.lineNode.style[T]=`${f.lineShift}px`,V.push(f.line))})}),V.length&&b(V,l,m)})},i=(l,m,u)=>{const{width:h,height:g}=t.editorState.curComponent.style;return l=="top"?Math.round(m.dragShift-(g-u.height)/2):Math.round(m.dragShift-(h-u.width)/2)},b=(l,m,u)=>{u?l.includes("yr")?o.lineStatus.yr=!0:l.includes("yc")?o.lineStatus.yc=!0:l.includes("yl")&&(o.lineStatus.yl=!0):l.includes("yl")?o.lineStatus.yl=!0:l.includes("yc")?o.lineStatus.yc=!0:l.includes("yr")&&(o.lineStatus.yr=!0),m?l.includes("xb")?o.lineStatus.xb=!0:l.includes("xc")?o.lineStatus.xc=!0:l.includes("xt")&&(o.lineStatus.xt=!0):l.includes("xt")?o.lineStatus.xt=!0:l.includes("xc")?o.lineStatus.xc=!0:l.includes("xb")&&(o.lineStatus.xb=!0)},k=(l,m)=>Math.abs(l-m)<=o.diff;return(l,m)=>(r(),_("div",qe,[(r(!0),_(H,null,z(o.lines,u=>J((r(),_("div",{key:u,class:ee(["line",u.includes("x")?"xline":"yline"]),ref_for:!0,ref:h=>a(h,u)},null,2)),[[le,o.lineStatus[u]||!1]])),128))]))}});const Je=W(Fe,[["__scopeId","data-v-736c7152"]]),Ge={lt:Qe,t:Ze,rt:nt,r:et,rb:at,b:tt,lb:lt,l:ot};function Qe(e,t,n){const{symmetricPoint:a}=n,o=te(t,a),p=R(t,o,-e.rotate),s=R(a,o,-e.rotate),c=s.x-p.x,i=s.y-p.y;c>0&&i>0&&(e.width=Math.round(c),e.height=Math.round(i),e.left=Math.round(p.x),e.top=Math.round(p.y))}function Ze(e,t,n){const{symmetricPoint:a,clickPoint:o}=n,p=R(t,o,-e.rotate),s=R({x:o.x,y:p.y},o,e.rotate),c=Math.sqrt((s.x-a.x)**2+(s.y-a.y)**2);if(c>0){const i={x:s.x-(s.x-a.x)/2,y:s.y+(a.y-s.y)/2};e.height=Math.round(c),e.top=Math.round(i.y-c/2),e.left=Math.round(i.x-e.width/2)}}function et(e,t,n){const{symmetricPoint:a,clickPoint:o}=n,p=R(t,o,-e.rotate),s=R({x:p.x,y:o.y},o,e.rotate),c=Math.sqrt((s.x-a.x)**2+(s.y-a.y)**2);if(c>0){const i={x:s.x-(s.x-a.x)/2,y:s.y+(a.y-s.y)/2};e.width=Math.round(c),e.top=Math.round(i.y-e.height/2),e.left=Math.round(i.x-c/2)}}function tt(e,t,n){const{symmetricPoint:a,clickPoint:o}=n,p=R(t,o,-e.rotate),s=R({x:o.x,y:p.y},o,e.rotate),c=Math.sqrt((s.x-a.x)**2+(s.y-a.y)**2);if(c>0){const i={x:s.x-(s.x-a.x)/2,y:s.y+(a.y-s.y)/2};e.height=Math.round(c),e.top=Math.round(i.y-c/2),e.left=Math.round(i.x-e.width/2)}}function ot(e,t,n){const{symmetricPoint:a,clickPoint:o}=n,p=R(t,o,-e.rotate),s=R({x:p.x,y:o.y},o,e.rotate),c=Math.sqrt((s.x-a.x)**2+(s.y-a.y)**2);if(c>0){const i={x:s.x-(s.x-a.x)/2,y:s.y+(a.y-s.y)/2};e.width=Math.round(c),e.top=Math.round(i.y-e.height/2),e.left=Math.round(i.x-c/2)}}function nt(e,t,n){const{symmetricPoint:a}=n,o=te(t,a),p=R(t,o,-e.rotate),s=R(a,o,-e.rotate),c=p.x-s.x,i=s.y-p.y;c>0&&i>0&&(e.width=Math.round(c),e.height=Math.round(i),e.left=Math.round(s.x),e.top=Math.round(p.y))}function at(e,t,n){const{symmetricPoint:a}=n,o=te(t,a),p=R(a,o,-e.rotate),s=R(t,o,-e.rotate),c=s.x-p.x,i=s.y-p.y;c>0&&i>0&&(e.width=Math.round(c),e.height=Math.round(i),e.left=Math.round(p.x),e.top=Math.round(p.y))}function lt(e,t,n){const{symmetricPoint:a}=n,o=te(t,a),p=R(a,o,-e.rotate),s=R(t,o,-e.rotate),c=p.x-s.x,i=s.y-p.y;c>0&&i>0&&(e.width=Math.round(c),e.height=Math.round(i),e.left=Math.round(s.x),e.top=Math.round(p.y))}function it(e,t,n,a){Ge[e](t,n,a)}const st=["onMousedown"],rt=Y({__name:"ShapeComponent",props:{active:{type:Boolean,default:!1},element:{require:!0,type:Object},defaultStyle:{require:!0,type:Object},index:{require:!0,type:[Number,String]}},setup(e){const t=e,n=j.editorStore,a=me(),o=G({pointList:["lt","t","rt","r","lb","b","rb","l"],directions:["nw","n","ne","e","sw","s","se","w"],cursors:[]});ae(()=>{q.on("runAnimation",()=>{t.element===n.getCurComponent&&a.value!==void 0&&_e(a.value,n.getCurComponent.animations)})});const p=l=>{var x;l.stopPropagation();const m={...t.defaultStyle},u=l.clientY,h=l.clientX,g=m.rotate,C=(x=a.value)==null?void 0:x.getBoundingClientRect(),P=(C==null?void 0:C.left)+(C==null?void 0:C.width)/2,O=(C==null?void 0:C.top)+(C==null?void 0:C.height)/2,L=Math.atan2(u-O,h-P)/(Math.PI/180);let M=!1;const v=U=>{M=!0;const N=U.clientX,V=U.clientY,F=Math.atan2(V-O,N-P)/(Math.PI/180);m.rotate=g+F-L,n.setShapeStyle(m)},d=()=>{M&&n.recordSnapshot(),document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",d),o.cursors=c()};document.addEventListener("mousemove",v),document.addEventListener("mouseup",d)},s=(l,m)=>{var d,x;const u=(d=t.defaultStyle)==null?void 0:d.height,h=(x=t.defaultStyle)==null?void 0:x.width,g=/t/.test(l),C=/b/.test(l),P=/l/.test(l),O=/r/.test(l);let L=0,M=0;return l.length===2?(L=P?0:h,M=g?0:u):((g||C)&&(L=h/2,M=g?0:u),(P||O)&&(L=P?0:h,M=Math.floor(u/2))),{marginLeft:"-4px",marginTop:"-4px",left:`${L}px`,top:`${M}px`,cursor:o.cursors[m]}},c=()=>{const l=Math.floor((n.editorState.curComponent.style.rotate+360)%360/45)%8,m=o.directions;return[...m.slice(l),...m.slice(0,l)].map(h=>h+"-resize")},i=l=>{var M;((M=t.element)==null?void 0:M.component)!="v-text"&&l.preventDefault(),l.stopPropagation(),n.setCurComponent({component:t.element,index:t.index}),o.cursors=c();const m={...t.defaultStyle},u=l.clientY,h=l.clientX,g=Number(m.top),C=Number(m.left);let P=!1;const O=v=>{P=!0;const d=v.clientX,x=v.clientY;m.top=x-u+g,m.left=d-h+C,n.setShapeStyle(m),ye(()=>{q.emit("move",{isDownward:x-u>0,isRightward:d-h>0})})},L=()=>{P&&n.recordSnapshot(),q.emit("unMove"),document.removeEventListener("mousemove",O),document.removeEventListener("mouseup",L)};document.addEventListener("mousemove",O),document.addEventListener("mouseup",L)},b=l=>{l.stopPropagation(),l.preventDefault(),n.hideContextMenu()},k=l=>{var v;const m=window.event;m==null||m.stopPropagation(),m==null||m.preventDefault();const u={...t.defaultStyle},h={x:u.left+u.width/2,y:u.top+u.height/2},g=Ke(u,h,l),C={x:h.x-(g.x-h.x),y:h.y-(g.y-h.y)},P=(v=document==null?void 0:document.querySelector("#editor"))==null?void 0:v.getBoundingClientRect();let O=!1;const L=d=>{O=!0;const x={x:d.clientX-(P==null?void 0:P.left),y:d.clientY-(P==null?void 0:P.top)};it(l,u,x,{center:h,clickPoint:g,symmetricPoint:C}),n.setShapeStyle(u)},M=()=>{document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",M),O&&n.recordSnapshot()};document.addEventListener("mousemove",L),document.addEventListener("mouseup",M)};return(l,m)=>{const u=E("RefreshRight"),h=E("el-icon");return r(),_("div",{ref_key:"thisRef",ref:a,class:ee(["shape",{active:e.active}]),onClick:b,onMousedown:i},[J(w(h,{class:"el-icon-refresh-right",onMousedown:p},{default:y(()=>[w(u)]),_:1},512),[[le,e.active]]),(r(!0),_(H,null,z(e.active?o.pointList:[],(g,C)=>(r(),_("div",{class:"shape-point",onMousedown:P=>k(g),key:C,style:X(s(g,C))},null,44,st))),128)),ve(l.$slots,"default",{},void 0,!0)],34)}}});const ct=W(rt,[["__scopeId","data-v-6408118b"]]),ut=Y({__name:"EditorComponent",props:{isEdit:{type:Boolean,default:!0}},setup(e){const t=j.editorStore,n=c=>{c.stopPropagation(),c.preventDefault();let i=c.target,b=c.offsetY,k=c.offsetX;for(;!i.className.includes("editor");)k+=i.offsetLeft,b+=i.offsetTop,i=i.parentNode;t.showContextMenu({top:b,left:k})},a=c=>{const i={...c};return i.width&&(i.width+="px"),i.height&&(i.height+="px"),i.top&&(i.top+="px"),i.left&&(i.left+="px"),i.rotate&&(i.transform="rotate("+i.rotate+"deg)"),i},o=c=>ge(c,["top","left","width","height","rotate"]),p=(c,i)=>{c.propValue=i,t.setShapeStyle({height:s(c,i)})},s=(c,i)=>{let{lineHeight:b,fontSize:k,height:l}=c.style;b===""&&(b=1.5);const m=i.split(`
`).length*b*k;return l>m?l:m};return(c,i)=>(r(),_("div",{class:ee(["editor",{edit:e.isEdit}]),id:"editor",style:X({width:S(t).editorState.canvasStyleData.width+"px",height:S(t).editorState.canvasStyleData.height+"px"}),onContextmenu:n},[(r(!0),_(H,null,z(S(t).editorState.componentData,(b,k)=>(r(),I(ct,{defaultStyle:b.style,style:X(a(b.style)),key:b.id,active:b===S(t).editorState.curComponent,element:b,index:k},{default:y(()=>[b.component!="v-text"?(r(),I(Z(b.component),{key:0,class:"component",style:X(o(b.style)),propValue:b.propValue},null,8,["style","propValue"])):(r(),I(Z(b.component),{key:1,class:"component",style:X(o(b.style)),propValue:b.propValue,onInput:p,element:b},null,40,["style","propValue","element"]))]),_:2},1032,["defaultStyle","style","active","element","index"]))),128)),w(Te),w(Je)],38))}});const dt=W(ut,[["__scopeId","data-v-e5128159"]]),fe=[{label:"进入",children:[{label:"渐显",value:"fadeIn"},{label:"向右进入",value:"fadeInLeft"},{label:"向左进入",value:"fadeInRight"},{label:"向上进入",value:"fadeInUp"},{label:"向下进入",value:"fadeInDown"},{label:"向右长距进入",value:"fadeInLeftBig"},{label:"向左长距进入",value:"fadeInRightBig"},{label:"向上长距进入",value:"fadeInUpBig"},{label:"向下长距进入",value:"fadeInDownBig"},{label:"旋转进入",value:"rotateIn"},{label:"左顺时针旋转",value:"rotateInDownLeft"},{label:"右逆时针旋转",value:"rotateInDownRight"},{label:"左逆时针旋转",value:"rotateInUpLeft"},{label:"右逆时针旋转",value:"rotateInUpRight"},{label:"弹入",value:"bounceIn"},{label:"向右弹入",value:"bounceInLeft"},{label:"向左弹入",value:"bounceInRight"},{label:"向上弹入",value:"bounceInUp"},{label:"向下弹入",value:"bounceInDown"},{label:"光速从右进入",value:"lightSpeedInRight"},{label:"光速从左进入",value:"lightSpeedInLeft"},{label:"光速从右退出",value:"lightSpeedOutRight"},{label:"光速从左退出",value:"lightSpeedOutLeft"},{label:"Y轴旋转",value:"flip"},{label:"中心X轴旋转",value:"flipInX"},{label:"中心Y轴旋转",value:"flipInY"},{label:"左长半径旋转",value:"rollIn"},{label:"由小变大进入",value:"zoomIn"},{label:"左变大进入",value:"zoomInLeft"},{label:"右变大进入",value:"zoomInRight"},{label:"向上变大进入",value:"zoomInUp"},{label:"向下变大进入",value:"zoomInDown"},{label:"向右滑动展开",value:"slideInLeft"},{label:"向左滑动展开",value:"slideInRight"},{label:"向上滑动展开",value:"slideInUp"},{label:"向下滑动展开",value:"slideInDown"}]},{label:"强调",children:[{label:"弹跳",value:"bounce"},{label:"闪烁",value:"flash"},{label:"放大缩小",value:"pulse"},{label:"放大缩小弹簧",value:"rubberBand"},{label:"左右晃动",value:"headShake"},{label:"左右扇形摇摆",value:"swing"},{label:"放大晃动缩小",value:"tada"},{label:"扇形摇摆",value:"wobble"},{label:"左右上下晃动",value:"jello"},{label:"Y轴旋转",value:"flip"}]},{label:"退出",children:[{label:"渐隐",value:"fadeOut"},{label:"向左退出",value:"fadeOutLeft"},{label:"向右退出",value:"fadeOutRight"},{label:"向上退出",value:"fadeOutUp"},{label:"向下退出",value:"fadeOutDown"},{label:"向左长距退出",value:"fadeOutLeftBig"},{label:"向右长距退出",value:"fadeOutRightBig"},{label:"向上长距退出",value:"fadeOutUpBig"},{label:"向下长距退出",value:"fadeOutDownBig"},{label:"旋转退出",value:"rotateOut"},{label:"左顺时针旋转",value:"rotateOutDownLeft"},{label:"右逆时针旋转",value:"rotateOutDownRight"},{label:"左逆时针旋转",value:"rotateOutUpLeft"},{label:"右逆时针旋转",value:"rotateOutUpRight"},{label:"弹出",value:"bounceOut"},{label:"向左弹出",value:"bounceOutLeft"},{label:"向右弹出",value:"bounceOutRight"},{label:"向上弹出",value:"bounceOutUp"},{label:"向下弹出",value:"bounceOutDown"},{label:"中心X轴旋转",value:"flipOutX"},{label:"中心Y轴旋转",value:"flipOutY"},{label:"左长半径旋转",value:"rollOut"},{label:"由小变大退出",value:"zoomOut"},{label:"左变大退出",value:"zoomOutLeft"},{label:"右变大退出",value:"zoomOutRight"},{label:"向上变大退出",value:"zoomOutUp"},{label:"向下变大退出",value:"zoomOutDown"},{label:"向左滑动收起",value:"slideOutLeft"},{label:"向右滑动收起",value:"slideOutRight"},{label:"向上滑动收起",value:"slideOutUp"},{label:"向下滑动收起",value:"slideOutDown"}]}],se=e=>(Ce("data-v-2bbef34f"),e=e(),ke(),e),pt={class:"home"},ht=se(()=>D("label",{for:"input",class:"insert"},"插入图片",-1)),ft={class:"canvas-config"},mt=se(()=>D("span",null,"画布大小",-1)),vt=se(()=>D("span",null,"*",-1)),_t={class:"left"},gt={class:"center"},bt={class:"right"},yt={key:1,class:"placeholder"},St={key:0,class:"div-animation"},xt={key:1,class:"placeholder"},wt={key:0,class:"div-events"},Ct={key:1,class:"placeholder"},kt={class:"el-scrollbar-view"},Mt=["onMouseover","onClick"],Lt=Y({__name:"Home",setup(e){const t=j.editorStore,n=G({isShowPreview:!1,isShowAnimation:!1,isShowEvent:!1,activeName:"attr",animationClassData:fe,animationActiveName:"进入",showAnimatePanel:!1,reSelectAnimateIndex:void 0,hoverPreviewAnimate:"",eventURL:"",eventActiveName:"redirect",eventList:Me}),a=()=>{localStorage.getItem("canvasData")&&t.setComponentData(p(JSON.parse(localStorage.getItem("canvasData")))),localStorage.getItem("canvasStyle")&&t.setCanvasStyle(JSON.parse(localStorage.getItem("canvasStyle")))},o=()=>{let N=!1;window.onkeydown=V=>{V.keyCode==17?N=!0:N&&V.keyCode==67?t.copy():N&&V.keyCode==86?t.paste(!1):N&&V.keyCode==88&&t.cut()},window.onkeyup=V=>{V.keyCode==17&&(N=!1)}},p=v=>(v.forEach(d=>{d.id=oe()}),v),s=v=>{v.preventDefault(),v.stopPropagation();const d=Se.cloneDeep(ie[v.dataTransfer.getData("index")]);d.style.top=v.offsetY,d.style.left=v.offsetX,d.id=oe(),t.addComponent({component:d,index:void 0}),t.recordSnapshot()},c=v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},i=()=>{t.setCurComponent({component:null,index:null}),t.hideContextMenu()},b=()=>{t.undo()},k=()=>{t.redo()},l=v=>{const d=v.target.files[0];if(!d.type.includes("image")){xe("只能插入图片");return}const x=new FileReader;x.onload=U=>{const N=U.target.result,V=new Image;V.onload=()=>{t.addComponent({component:{id:oe(),component:"v-picture",label:"图片",icon:"",propValue:N,animations:[],events:[],style:{top:0,left:0,width:V.width,height:V.height,rotate:""}},index:void 0})},V.src=N},x.readAsDataURL(d)},m=v=>{t.addAnimation(v),n.isShowAnimation=!1},u=()=>{q.emit("runAnimation")},h=v=>{t.removeAnimation(v)},g=()=>{n.isShowPreview=!0,t.setEditMode("read")},C=()=>{t.setEditMode("edit")},P=()=>{localStorage.setItem("canvasData",JSON.stringify(t.editorState.componentData)),localStorage.setItem("canvasStyle",JSON.stringify(t.editorState.canvasStyleData)),we.success("保存成功")},O=()=>{t.setComponentData([])},L=(v,d)=>{n.isShowEvent=!1,t.addEvent({event:v,param:d})},M=v=>{t.removeEvent(v)};return a(),o(),(v,d)=>{const x=E("el-button"),U=E("el-tab-pane"),N=E("el-tag"),V=E("el-tabs"),F=E("el-scrollbar"),T=E("el-input");return r(),_("div",pt,[D("header",null,[w(x,{onClick:b},{default:y(()=>[B("撤消")]),_:1}),w(x,{onClick:k},{default:y(()=>[B("重做")]),_:1}),ht,D("input",{type:"file",onChange:l,id:"input",hidden:""},null,32),w(x,{onClick:g,style:{"margin-left":"10px"}},{default:y(()=>[B("预览")]),_:1}),w(x,{onClick:P},{default:y(()=>[B("保存")]),_:1}),w(x,{onClick:O},{default:y(()=>[B("清空画布")]),_:1}),D("div",ft,[mt,J(D("input",{"onUpdate:modelValue":d[0]||(d[0]=f=>S(t).editorState.canvasStyleData.width=f)},null,512),[[ue,S(t).editorState.canvasStyleData.width]]),vt,J(D("input",{"onUpdate:modelValue":d[1]||(d[1]=f=>S(t).editorState.canvasStyleData.height=f)},null,512),[[ue,S(t).editorState.canvasStyleData.height]])])]),D("main",null,[D("section",_t,[w(He)]),D("section",gt,[D("div",{class:"content",onDrop:s,onDragover:c,onClick:i},[w(dt)],32)]),D("section",bt,[w(V,{modelValue:n.activeName,"onUpdate:modelValue":d[4]||(d[4]=f=>n.activeName=f),type:"card"},{default:y(()=>[w(U,{label:"属性",name:"attr"},{default:y(()=>[S(t).editorState.curComponent?(r(),I(We,{key:0})):(r(),_("p",yt,"请选择组件"))]),_:1}),w(U,{label:"动画",name:"animation"},{default:y(()=>[S(t).editorState.curComponent?(r(),_("div",St,[w(x,{onClick:d[2]||(d[2]=f=>{n.isShowAnimation=!0})},{default:y(()=>[B("添加动画")]),_:1}),w(x,{onClick:u},{default:y(()=>[B("预览动画")]),_:1}),D("div",null,[(r(!0),_(H,null,z(S(t).editorState.curComponent.animations,(f,A)=>(r(),I(N,{key:A,closable:"",onClose:re=>h(A)},{default:y(()=>[B(Q(f.label),1)]),_:2},1032,["onClose"]))),128))])])):(r(),_("p",xt,"请选择组件"))]),_:1}),w(U,{label:"事件",name:"events"},{default:y(()=>[S(t).editorState.curComponent?(r(),_("div",wt,[w(x,{onClick:d[3]||(d[3]=f=>n.isShowEvent=!0)},{default:y(()=>[B("添加事件")]),_:1}),D("div",null,[(r(!0),_(H,null,z(Object.keys(S(t).editorState.curComponent.events),f=>(r(),I(N,{key:f,closable:"",onClose:A=>M(f)},{default:y(()=>[B(Q(f),1)]),_:2},1032,["onClose"]))),128))])])):(r(),_("p",Ct,"请选择组件"))]),_:1})]),_:1},8,["modelValue"])])]),w(de,{show:n.isShowAnimation,"onUpdate:show":d[6]||(d[6]=f=>n.isShowAnimation=f)},{default:y(()=>[w(V,{type:"card",modelValue:n.animationActiveName,"onUpdate:modelValue":d[5]||(d[5]=f=>n.animationActiveName=f)},{default:y(()=>[(r(!0),_(H,null,z(S(fe),f=>(r(),I(U,{key:f.label,label:f.label,name:f.label},{default:y(()=>[w(F,{class:"animate-container"},{default:y(()=>[D("div",kt,[(r(!0),_(H,null,z(f.children,(A,re)=>(r(),_("div",{class:"animate",key:re,onMouseover:be=>n.hoverPreviewAnimate=A.value,onClick:be=>m(A)},[D("div",{class:ee([n.hoverPreviewAnimate===A.value&&"animate__animated animate__"+A.value])},Q(A.label),3)],40,Mt))),128))])]),_:2},1024)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["show"]),w(de,{show:n.isShowEvent,"onUpdate:show":d[8]||(d[8]=f=>n.isShowEvent=f)},{default:y(()=>[w(V,{type:"card",modelValue:n.eventActiveName,"onUpdate:modelValue":d[7]||(d[7]=f=>n.eventActiveName=f)},{default:y(()=>[(r(!0),_(H,null,z(n.eventList,f=>(r(),I(U,{key:f.key,label:f.label,name:f.key,style:{padding:"0 20px"}},{default:y(()=>[f.key=="redirect"?(r(),I(T,{key:0,modelValue:f.param,"onUpdate:modelValue":A=>f.param=A,type:"textarea",placeholder:"请输入完整的 URL"},null,8,["modelValue","onUpdate:modelValue"])):$("",!0),f.key=="alert"?(r(),I(T,{key:1,modelValue:f.param,"onUpdate:modelValue":A=>f.param=A,type:"textarea",placeholder:"请输入要 alert 的内容"},null,8,["modelValue","onUpdate:modelValue"])):$("",!0),w(x,{style:{"margin-top":"20px"},onClick:A=>L(f.key,f.param)},{default:y(()=>[B("确定")]),_:2},1032,["onClick"])]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["show"]),w(Oe,{show:n.isShowPreview,"onUpdate:show":d[9]||(d[9]=f=>n.isShowPreview=f),onChange:C},null,8,["show"])])}}});const Pt=W(Lt,[["__scopeId","data-v-2bbef34f"]]);export{Pt as default};
